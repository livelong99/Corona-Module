{"ast":null,"code":"/**\r\n * DevExtreme (ui/date_box/ui.date_box.strategy.list.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\");\n\nvar window = require(\"../../core/utils/window\").getWindow();\n\nvar List = require(\"../list\");\n\nvar DateBoxStrategy = require(\"./ui.date_box.strategy\");\n\nvar noop = require(\"../../core/utils/common\").noop;\n\nvar ensureDefined = require(\"../../core/utils/common\").ensureDefined;\n\nvar isDate = require(\"../../core/utils/type\").isDate;\n\nvar extend = require(\"../../core/utils/extend\").extend;\n\nvar dateUtils = require(\"./ui.date_utils\");\n\nvar dateLocalization = require(\"../../localization/date\");\n\nvar dateSerialization = require(\"../../core/utils/date_serialization\");\n\nvar DATE_FORMAT = \"date\";\nvar BOUNDARY_VALUES = {\n  min: new Date(0, 0, 0, 0, 0),\n  max: new Date(0, 0, 0, 23, 59)\n};\nvar ListStrategy = DateBoxStrategy.inherit({\n  NAME: \"List\",\n  supportedKeys: function supportedKeys() {\n    return {\n      tab: function tab() {\n        if (this.option(\"opened\")) {\n          this.close();\n        }\n      },\n      space: noop,\n      home: noop,\n      end: noop\n    };\n  },\n  getDefaultOptions: function getDefaultOptions() {\n    return extend(this.callBase(), {\n      applyValueMode: \"instantly\"\n    });\n  },\n  getDisplayFormat: function getDisplayFormat(displayFormat) {\n    return displayFormat || \"shorttime\";\n  },\n  popupConfig: function popupConfig(_popupConfig) {\n    return extend(_popupConfig, {\n      width: this._getPopupWidth()\n    });\n  },\n  useCurrentDateByDefault: function useCurrentDateByDefault() {\n    return true;\n  },\n  getDefaultDate: function getDefaultDate() {\n    return new Date(null);\n  },\n  _getPopupWidth: function _getPopupWidth() {\n    return this.dateBox.$element().outerWidth();\n  },\n  popupShowingHandler: function popupShowingHandler() {\n    this._dimensionChanged();\n  },\n  _renderWidget: function _renderWidget() {\n    this.callBase();\n\n    this._refreshItems();\n  },\n  _getWidgetName: function _getWidgetName() {\n    return List;\n  },\n  _getWidgetOptions: function _getWidgetOptions() {\n    var keyboardProcessor = this.dateBox._keyboardProcessor;\n    return {\n      _keyboardProcessor: keyboardProcessor ? keyboardProcessor.attachChildProcessor() : null,\n      itemTemplate: this._timeListItemTemplate.bind(this),\n      onItemClick: this._listItemClickHandler.bind(this),\n      tabIndex: -1,\n      onFocusedItemChanged: this._refreshActiveDescendant.bind(this),\n      selectionMode: \"single\"\n    };\n  },\n  _refreshActiveDescendant: function _refreshActiveDescendant(e) {\n    this.dateBox.setAria(\"activedescendant\", \"\");\n    this.dateBox.setAria(\"activedescendant\", e.actionValue);\n  },\n  _refreshItems: function _refreshItems() {\n    this._widgetItems = this._getTimeListItems();\n\n    this._widget.option(\"items\", this._widgetItems);\n  },\n  renderOpenedState: function renderOpenedState() {\n    if (!this._widget) {\n      return;\n    }\n\n    this._widget.option(\"focusedElement\", null);\n\n    this._setSelectedItemsByValue();\n\n    if (this._widget.option(\"templatesRenderAsynchronously\")) {\n      this._asyncScrollTimeout = setTimeout(this._scrollToSelectedItem.bind(this));\n    } else {\n      this._scrollToSelectedItem();\n    }\n  },\n  dispose: function dispose() {\n    this.callBase();\n    clearTimeout(this._asyncScrollTimeout);\n  },\n  _updateValue: function _updateValue() {\n    if (!this._widget) {\n      return;\n    }\n\n    this._refreshItems();\n\n    this._setSelectedItemsByValue();\n\n    this._scrollToSelectedItem();\n  },\n  _setSelectedItemsByValue: function _setSelectedItemsByValue() {\n    var value = this.dateBoxValue();\n\n    var dateIndex = this._getDateIndex(value);\n\n    if (dateIndex === -1) {\n      this._widget.option(\"selectedItems\", []);\n    } else {\n      this._widget.option(\"selectedIndex\", dateIndex);\n    }\n  },\n  _scrollToSelectedItem: function _scrollToSelectedItem() {\n    this._widget.scrollToItem(this._widget.option(\"selectedIndex\"));\n  },\n  _getDateIndex: function _getDateIndex(date) {\n    var result = -1;\n\n    for (var i = 0, n = this._widgetItems.length; i < n; i++) {\n      if (this._areDatesEqual(date, this._widgetItems[i])) {\n        result = i;\n        break;\n      }\n    }\n\n    return result;\n  },\n  _areDatesEqual: function _areDatesEqual(first, second) {\n    return isDate(first) && isDate(second) && first.getHours() === second.getHours() && first.getMinutes() === second.getMinutes();\n  },\n  _getTimeListItems: function _getTimeListItems() {\n    var min = this.dateBox.dateOption(\"min\") || this._getBoundaryDate(\"min\");\n\n    var max = this.dateBox.dateOption(\"max\") || this._getBoundaryDate(\"max\");\n\n    var value = this.dateBox.dateOption(\"value\") || null;\n    var delta = max - min;\n    var minutes = min.getMinutes() % this.dateBox.option(\"interval\");\n\n    if (delta < 0) {\n      return [];\n    }\n\n    if (delta > dateUtils.ONE_DAY) {\n      delta = dateUtils.ONE_DAY;\n    }\n\n    if (value - min < dateUtils.ONE_DAY) {\n      return this._getRangeItems(min, new Date(min), delta);\n    }\n\n    min = this._getBoundaryDate(\"min\");\n    min.setMinutes(minutes);\n\n    if (value && Math.abs(value - max) < dateUtils.ONE_DAY) {\n      delta = (60 * max.getHours() + Math.abs(max.getMinutes() - minutes)) * dateUtils.ONE_MINUTE;\n    }\n\n    return this._getRangeItems(min, new Date(min), delta);\n  },\n  _getRangeItems: function _getRangeItems(startValue, currentValue, rangeDuration) {\n    var rangeItems = [];\n    var interval = this.dateBox.option(\"interval\");\n\n    while (currentValue - startValue <= rangeDuration) {\n      rangeItems.push(new Date(currentValue));\n      currentValue.setMinutes(currentValue.getMinutes() + interval);\n    }\n\n    return rangeItems;\n  },\n  _getBoundaryDate: function _getBoundaryDate(boundary) {\n    var boundaryValue = BOUNDARY_VALUES[boundary];\n    var currentValue = new Date(ensureDefined(this.dateBox.dateOption(\"value\"), 0));\n    return new Date(currentValue.getFullYear(), currentValue.getMonth(), currentValue.getDate(), boundaryValue.getHours(), boundaryValue.getMinutes());\n  },\n  _timeListItemTemplate: function _timeListItemTemplate(itemData) {\n    var displayFormat = this.dateBox.option(\"displayFormat\");\n    return dateLocalization.format(itemData, this.getDisplayFormat(displayFormat));\n  },\n  _listItemClickHandler: function _listItemClickHandler(e) {\n    this.dateBox.option(\"opened\", false);\n    var date = this.dateBox.option(\"value\");\n    var itemData = e.itemData;\n    var hours = itemData.getHours();\n    var minutes = itemData.getMinutes();\n    var seconds = itemData.getSeconds();\n    var year = itemData.getFullYear();\n    var month = itemData.getMonth();\n    var day = itemData.getDate();\n\n    if (date) {\n      if (this.dateBox.option(\"dateSerializationFormat\")) {\n        date = dateSerialization.deserializeDate(date);\n      } else {\n        date = new Date(date);\n      }\n\n      date.setHours(hours);\n      date.setMinutes(minutes);\n      date.setSeconds(seconds);\n      date.setFullYear(year);\n      date.setMonth(month);\n      date.setDate(day);\n    } else {\n      date = new Date(year, month, day, hours, minutes, 0, 0);\n    }\n\n    this.dateBoxValue(date, e.event);\n  },\n  attachKeyboardEvents: function attachKeyboardEvents(keyboardProcessor) {\n    var child = keyboardProcessor.attachChildProcessor();\n\n    if (this._widget) {\n      this._widget.option(\"_keyboardProcessor\", child);\n    }\n  },\n  _dimensionChanged: function _dimensionChanged() {\n    this._getPopup() && this._updatePopupDimensions();\n  },\n  _updatePopupDimensions: function _updatePopupDimensions() {\n    this._updatePopupWidth();\n\n    this._updatePopupHeight();\n  },\n  _updatePopupWidth: function _updatePopupWidth() {\n    this.dateBox._setPopupOption(\"width\", this._getPopupWidth());\n  },\n  _updatePopupHeight: function _updatePopupHeight() {\n    this.dateBox._setPopupOption(\"height\", \"auto\");\n\n    var popupHeight = this._widget.$element().outerHeight();\n\n    var maxHeight = .45 * $(window).height();\n\n    this.dateBox._setPopupOption(\"height\", Math.min(popupHeight, maxHeight));\n\n    this.dateBox._timeList && this.dateBox._timeList.updateDimensions();\n  },\n  getParsedText: function getParsedText(text, format) {\n    var value = this.callBase(text, format);\n\n    if (value) {\n      value = dateUtils.mergeDates(value, new Date(null), DATE_FORMAT);\n    }\n\n    return value;\n  }\n});\nmodule.exports = ListStrategy;","map":{"version":3,"sources":["C:/Users/va112/Documents/Webdev/React/Corona/node_modules/devextreme/ui/date_box/ui.date_box.strategy.list.js"],"names":["$","require","window","getWindow","List","DateBoxStrategy","noop","ensureDefined","isDate","extend","dateUtils","dateLocalization","dateSerialization","DATE_FORMAT","BOUNDARY_VALUES","min","Date","max","ListStrategy","inherit","NAME","supportedKeys","tab","option","close","space","home","end","getDefaultOptions","callBase","applyValueMode","getDisplayFormat","displayFormat","popupConfig","_popupConfig","width","_getPopupWidth","useCurrentDateByDefault","getDefaultDate","dateBox","$element","outerWidth","popupShowingHandler","_dimensionChanged","_renderWidget","_refreshItems","_getWidgetName","_getWidgetOptions","keyboardProcessor","_keyboardProcessor","attachChildProcessor","itemTemplate","_timeListItemTemplate","bind","onItemClick","_listItemClickHandler","tabIndex","onFocusedItemChanged","_refreshActiveDescendant","selectionMode","e","setAria","actionValue","_widgetItems","_getTimeListItems","_widget","renderOpenedState","_setSelectedItemsByValue","_asyncScrollTimeout","setTimeout","_scrollToSelectedItem","dispose","clearTimeout","_updateValue","value","dateBoxValue","dateIndex","_getDateIndex","scrollToItem","date","result","i","n","length","_areDatesEqual","first","second","getHours","getMinutes","dateOption","_getBoundaryDate","delta","minutes","ONE_DAY","_getRangeItems","setMinutes","Math","abs","ONE_MINUTE","startValue","currentValue","rangeDuration","rangeItems","interval","push","boundary","boundaryValue","getFullYear","getMonth","getDate","itemData","format","hours","seconds","getSeconds","year","month","day","deserializeDate","setHours","setSeconds","setFullYear","setMonth","setDate","event","attachKeyboardEvents","child","_getPopup","_updatePopupDimensions","_updatePopupWidth","_updatePopupHeight","_setPopupOption","popupHeight","outerHeight","maxHeight","height","_timeList","updateDimensions","getParsedText","text","mergeDates","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/date_box/ui.date_box.strategy.list.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../../core/renderer\");\r\nvar window = require(\"../../core/utils/window\").getWindow();\r\nvar List = require(\"../list\");\r\nvar DateBoxStrategy = require(\"./ui.date_box.strategy\");\r\nvar noop = require(\"../../core/utils/common\").noop;\r\nvar ensureDefined = require(\"../../core/utils/common\").ensureDefined;\r\nvar isDate = require(\"../../core/utils/type\").isDate;\r\nvar extend = require(\"../../core/utils/extend\").extend;\r\nvar dateUtils = require(\"./ui.date_utils\");\r\nvar dateLocalization = require(\"../../localization/date\");\r\nvar dateSerialization = require(\"../../core/utils/date_serialization\");\r\nvar DATE_FORMAT = \"date\";\r\nvar BOUNDARY_VALUES = {\r\n    min: new Date(0, 0, 0, 0, 0),\r\n    max: new Date(0, 0, 0, 23, 59)\r\n};\r\nvar ListStrategy = DateBoxStrategy.inherit({\r\n    NAME: \"List\",\r\n    supportedKeys: function() {\r\n        return {\r\n            tab: function() {\r\n                if (this.option(\"opened\")) {\r\n                    this.close()\r\n                }\r\n            },\r\n            space: noop,\r\n            home: noop,\r\n            end: noop\r\n        }\r\n    },\r\n    getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            applyValueMode: \"instantly\"\r\n        })\r\n    },\r\n    getDisplayFormat: function(displayFormat) {\r\n        return displayFormat || \"shorttime\"\r\n    },\r\n    popupConfig: function(_popupConfig) {\r\n        return extend(_popupConfig, {\r\n            width: this._getPopupWidth()\r\n        })\r\n    },\r\n    useCurrentDateByDefault: function() {\r\n        return true\r\n    },\r\n    getDefaultDate: function() {\r\n        return new Date(null)\r\n    },\r\n    _getPopupWidth: function() {\r\n        return this.dateBox.$element().outerWidth()\r\n    },\r\n    popupShowingHandler: function() {\r\n        this._dimensionChanged()\r\n    },\r\n    _renderWidget: function() {\r\n        this.callBase();\r\n        this._refreshItems()\r\n    },\r\n    _getWidgetName: function() {\r\n        return List\r\n    },\r\n    _getWidgetOptions: function() {\r\n        var keyboardProcessor = this.dateBox._keyboardProcessor;\r\n        return {\r\n            _keyboardProcessor: keyboardProcessor ? keyboardProcessor.attachChildProcessor() : null,\r\n            itemTemplate: this._timeListItemTemplate.bind(this),\r\n            onItemClick: this._listItemClickHandler.bind(this),\r\n            tabIndex: -1,\r\n            onFocusedItemChanged: this._refreshActiveDescendant.bind(this),\r\n            selectionMode: \"single\"\r\n        }\r\n    },\r\n    _refreshActiveDescendant: function(e) {\r\n        this.dateBox.setAria(\"activedescendant\", \"\");\r\n        this.dateBox.setAria(\"activedescendant\", e.actionValue)\r\n    },\r\n    _refreshItems: function() {\r\n        this._widgetItems = this._getTimeListItems();\r\n        this._widget.option(\"items\", this._widgetItems)\r\n    },\r\n    renderOpenedState: function() {\r\n        if (!this._widget) {\r\n            return\r\n        }\r\n        this._widget.option(\"focusedElement\", null);\r\n        this._setSelectedItemsByValue();\r\n        if (this._widget.option(\"templatesRenderAsynchronously\")) {\r\n            this._asyncScrollTimeout = setTimeout(this._scrollToSelectedItem.bind(this))\r\n        } else {\r\n            this._scrollToSelectedItem()\r\n        }\r\n    },\r\n    dispose: function() {\r\n        this.callBase();\r\n        clearTimeout(this._asyncScrollTimeout)\r\n    },\r\n    _updateValue: function() {\r\n        if (!this._widget) {\r\n            return\r\n        }\r\n        this._refreshItems();\r\n        this._setSelectedItemsByValue();\r\n        this._scrollToSelectedItem()\r\n    },\r\n    _setSelectedItemsByValue: function() {\r\n        var value = this.dateBoxValue();\r\n        var dateIndex = this._getDateIndex(value);\r\n        if (dateIndex === -1) {\r\n            this._widget.option(\"selectedItems\", [])\r\n        } else {\r\n            this._widget.option(\"selectedIndex\", dateIndex)\r\n        }\r\n    },\r\n    _scrollToSelectedItem: function() {\r\n        this._widget.scrollToItem(this._widget.option(\"selectedIndex\"))\r\n    },\r\n    _getDateIndex: function(date) {\r\n        var result = -1;\r\n        for (var i = 0, n = this._widgetItems.length; i < n; i++) {\r\n            if (this._areDatesEqual(date, this._widgetItems[i])) {\r\n                result = i;\r\n                break\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    _areDatesEqual: function(first, second) {\r\n        return isDate(first) && isDate(second) && first.getHours() === second.getHours() && first.getMinutes() === second.getMinutes()\r\n    },\r\n    _getTimeListItems: function() {\r\n        var min = this.dateBox.dateOption(\"min\") || this._getBoundaryDate(\"min\");\r\n        var max = this.dateBox.dateOption(\"max\") || this._getBoundaryDate(\"max\");\r\n        var value = this.dateBox.dateOption(\"value\") || null;\r\n        var delta = max - min;\r\n        var minutes = min.getMinutes() % this.dateBox.option(\"interval\");\r\n        if (delta < 0) {\r\n            return []\r\n        }\r\n        if (delta > dateUtils.ONE_DAY) {\r\n            delta = dateUtils.ONE_DAY\r\n        }\r\n        if (value - min < dateUtils.ONE_DAY) {\r\n            return this._getRangeItems(min, new Date(min), delta)\r\n        }\r\n        min = this._getBoundaryDate(\"min\");\r\n        min.setMinutes(minutes);\r\n        if (value && Math.abs(value - max) < dateUtils.ONE_DAY) {\r\n            delta = (60 * max.getHours() + Math.abs(max.getMinutes() - minutes)) * dateUtils.ONE_MINUTE\r\n        }\r\n        return this._getRangeItems(min, new Date(min), delta)\r\n    },\r\n    _getRangeItems: function(startValue, currentValue, rangeDuration) {\r\n        var rangeItems = [];\r\n        var interval = this.dateBox.option(\"interval\");\r\n        while (currentValue - startValue <= rangeDuration) {\r\n            rangeItems.push(new Date(currentValue));\r\n            currentValue.setMinutes(currentValue.getMinutes() + interval)\r\n        }\r\n        return rangeItems\r\n    },\r\n    _getBoundaryDate: function(boundary) {\r\n        var boundaryValue = BOUNDARY_VALUES[boundary];\r\n        var currentValue = new Date(ensureDefined(this.dateBox.dateOption(\"value\"), 0));\r\n        return new Date(currentValue.getFullYear(), currentValue.getMonth(), currentValue.getDate(), boundaryValue.getHours(), boundaryValue.getMinutes())\r\n    },\r\n    _timeListItemTemplate: function(itemData) {\r\n        var displayFormat = this.dateBox.option(\"displayFormat\");\r\n        return dateLocalization.format(itemData, this.getDisplayFormat(displayFormat))\r\n    },\r\n    _listItemClickHandler: function(e) {\r\n        this.dateBox.option(\"opened\", false);\r\n        var date = this.dateBox.option(\"value\");\r\n        var itemData = e.itemData;\r\n        var hours = itemData.getHours();\r\n        var minutes = itemData.getMinutes();\r\n        var seconds = itemData.getSeconds();\r\n        var year = itemData.getFullYear();\r\n        var month = itemData.getMonth();\r\n        var day = itemData.getDate();\r\n        if (date) {\r\n            if (this.dateBox.option(\"dateSerializationFormat\")) {\r\n                date = dateSerialization.deserializeDate(date)\r\n            } else {\r\n                date = new Date(date)\r\n            }\r\n            date.setHours(hours);\r\n            date.setMinutes(minutes);\r\n            date.setSeconds(seconds);\r\n            date.setFullYear(year);\r\n            date.setMonth(month);\r\n            date.setDate(day)\r\n        } else {\r\n            date = new Date(year, month, day, hours, minutes, 0, 0)\r\n        }\r\n        this.dateBoxValue(date, e.event)\r\n    },\r\n    attachKeyboardEvents: function(keyboardProcessor) {\r\n        var child = keyboardProcessor.attachChildProcessor();\r\n        if (this._widget) {\r\n            this._widget.option(\"_keyboardProcessor\", child)\r\n        }\r\n    },\r\n    _dimensionChanged: function() {\r\n        this._getPopup() && this._updatePopupDimensions()\r\n    },\r\n    _updatePopupDimensions: function() {\r\n        this._updatePopupWidth();\r\n        this._updatePopupHeight()\r\n    },\r\n    _updatePopupWidth: function() {\r\n        this.dateBox._setPopupOption(\"width\", this._getPopupWidth())\r\n    },\r\n    _updatePopupHeight: function() {\r\n        this.dateBox._setPopupOption(\"height\", \"auto\");\r\n        var popupHeight = this._widget.$element().outerHeight();\r\n        var maxHeight = .45 * $(window).height();\r\n        this.dateBox._setPopupOption(\"height\", Math.min(popupHeight, maxHeight));\r\n        this.dateBox._timeList && this.dateBox._timeList.updateDimensions()\r\n    },\r\n    getParsedText: function(text, format) {\r\n        var value = this.callBase(text, format);\r\n        if (value) {\r\n            value = dateUtils.mergeDates(value, new Date(null), DATE_FORMAT)\r\n        }\r\n        return value\r\n    }\r\n});\r\nmodule.exports = ListStrategy;\r\n"]},"metadata":{},"sourceType":"script"}