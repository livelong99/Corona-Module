{"ast":null,"code":"/**\r\n * DevExtreme (viz/core/renderers/renderer.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _dom_adapter = require(\"../../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _window = require(\"../../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _call_once = require(\"../../../core/utils/call_once\");\n\nvar _call_once2 = _interopRequireDefault(_call_once);\n\nvar _events_engine = require(\"../../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _browser = require(\"../../../core/utils/browser\");\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _svg = require(\"../../../core/utils/svg\");\n\nvar _animation = require(\"./animation\");\n\nvar _animation2 = _interopRequireDefault(_animation);\n\nvar _utils = require(\"../utils\");\n\nvar _type = require(\"../../../core/utils/type\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) {\n    return;\n  }\n\n  if (\"string\" === typeof o) {\n    return _arrayLikeToArray(o, minLen);\n  }\n\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n\n  if (\"Object\" === n && o.constructor) {\n    n = o.constructor.name;\n  }\n\n  if (\"Map\" === n || \"Set\" === n) {\n    return Array.from(n);\n  }\n\n  if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\n    return _arrayLikeToArray(o, minLen);\n  }\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (null == len || len > arr.length) {\n    len = arr.length;\n  }\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (\"undefined\" === typeof Symbol || !(Symbol.iterator in Object(arr))) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _e = void 0;\n\n  try {\n    for (var _s, _i = arr[Symbol.iterator](); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) {\n        break;\n      }\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && null != _i.return) {\n        _i.return();\n      }\n    } finally {\n      if (_d) {\n        throw _e;\n      }\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) {\n    return arr;\n  }\n}\n\nvar window = _window2.default.getWindow();\n\nvar max = Math.max,\n    min = Math.min,\n    floor = Math.floor,\n    round = Math.round,\n    sin = Math.sin,\n    cos = Math.cos,\n    abs = Math.abs,\n    PI = Math.PI;\nvar PI_DIV_180 = PI / 180;\nvar SHARPING_CORRECTION = .5;\nvar ARC_COORD_PREC = 5;\nvar pxAddingExceptions = {\n  \"column-count\": true,\n  \"fill-opacity\": true,\n  \"flex-grow\": true,\n  \"flex-shrink\": true,\n  \"font-weight\": true,\n  \"line-height\": true,\n  opacity: true,\n  order: true,\n  orphans: true,\n  widows: true,\n  \"z-index\": true,\n  zoom: true\n};\nvar KEY_TEXT = \"text\";\nvar KEY_STROKE = \"stroke\";\nvar KEY_STROKE_WIDTH = \"stroke-width\";\nvar KEY_STROKE_OPACITY = \"stroke-opacity\";\nvar KEY_FONT_SIZE = \"font-size\";\nvar KEY_FONT_STYLE = \"font-style\";\nvar KEY_FONT_WEIGHT = \"font-weight\";\nvar KEY_TEXT_DECORATION = \"text-decoration\";\nvar KEY_TEXTS_ALIGNMENT = \"textsAlignment\";\nvar NONE = \"none\";\nvar DEFAULT_FONT_SIZE = 12;\nvar ELLIPSIS = \"...\";\n\nvar objectCreate = function () {\n  if (!Object.create) {\n    return function (proto) {\n      var F = function F() {};\n\n      F.prototype = proto;\n      return new F();\n    };\n  } else {\n    return function (proto) {\n      return Object.create(proto);\n    };\n  }\n}();\n\nvar DEFAULTS = {\n  scaleX: 1,\n  scaleY: 1,\n  \"pointer-events\": null\n};\nvar getBackup = (0, _call_once2.default)(function () {\n  var backupContainer = _dom_adapter2.default.createElement(\"div\");\n\n  var backupCounter = 0;\n  backupContainer.style.left = \"-9999px\";\n  backupContainer.style.position = \"absolute\";\n  return {\n    backupContainer: backupContainer,\n    backupCounter: backupCounter\n  };\n});\n\nfunction backupRoot(root) {\n  if (0 === getBackup().backupCounter) {\n    _dom_adapter2.default.getBody().appendChild(getBackup().backupContainer);\n  }\n\n  ++getBackup().backupCounter;\n  root.append({\n    element: getBackup().backupContainer\n  });\n}\n\nfunction restoreRoot(root, container) {\n  root.append({\n    element: container\n  });\n  --getBackup().backupCounter;\n\n  if (0 === getBackup().backupCounter) {\n    _dom_adapter2.default.getBody().removeChild(getBackup().backupContainer);\n  }\n}\n\nvar getNextDefsSvgId = function () {\n  var numDefsSvgElements = 1;\n  return function () {\n    return \"DevExpress_\" + numDefsSvgElements++;\n  };\n}();\n\nfunction isObjectArgument(value) {\n  return value && \"string\" !== typeof value;\n}\n\nfunction createElement(tagName) {\n  return _dom_adapter2.default.createElementNS(\"http://www.w3.org/2000/svg\", tagName);\n}\n\nfunction getFuncIri(id, pathModified) {\n  return null !== id ? \"url(\" + (pathModified ? window.location.href.split(\"#\")[0] : \"\") + \"#\" + id + \")\" : id;\n}\n\nmodule.exports.getFuncIri = getFuncIri;\n\nfunction extend(target, source) {\n  var key;\n\n  for (key in source) {\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction roundValue(value, exp) {\n  value = value.toString().split(\"e\");\n  value = round(+(value[0] + \"e\" + (value[1] ? +value[1] + exp : exp)));\n  value = value.toString().split(\"e\");\n  return +(value[0] + \"e\" + (value[1] ? +value[1] - exp : -exp));\n}\n\nfunction getBoundingClientRect(element) {\n  var box;\n\n  try {\n    box = element.getBoundingClientRect();\n  } catch (e) {}\n\n  return box || {\n    left: 0,\n    top: 0\n  };\n}\n\nvar preserveAspectRatioMap = {\n  full: NONE,\n  lefttop: \"xMinYMin\",\n  leftcenter: \"xMinYMid\",\n  leftbottom: \"xMinYMax\",\n  centertop: \"xMidYMin\",\n  center: \"xMidYMid\",\n  centerbottom: \"xMidYMax\",\n  righttop: \"xMaxYMin\",\n  rightcenter: \"xMaxYMid\",\n  rightbottom: \"xMaxYMax\"\n};\n\nfunction processHatchingAttrs(element, attrs) {\n  if (attrs.hatching && \"none\" !== (0, _utils.normalizeEnum)(attrs.hatching.direction)) {\n    attrs = extend({}, attrs);\n    attrs.fill = element._hatching = element.renderer.lockHatching(attrs.fill, attrs.hatching, element._hatching);\n    delete attrs.hatching;\n  } else {\n    if (element._hatching) {\n      element.renderer.releaseHatching(element._hatching);\n      element._hatching = null;\n    }\n  }\n\n  return attrs;\n}\n\nmodule.exports.processHatchingAttrs = processHatchingAttrs;\n\nfunction normalizeArcParams(x, y, innerR, outerR, startAngle, endAngle) {\n  var isCircle;\n  var noArc = true;\n  var angleDiff = roundValue(endAngle, 3) - roundValue(startAngle, 3);\n\n  if (angleDiff) {\n    if (abs(angleDiff) % 360 === 0) {\n      startAngle = 0;\n      endAngle = 360;\n      isCircle = true;\n      endAngle -= .01;\n    }\n\n    if (startAngle > 360) {\n      startAngle %= 360;\n    }\n\n    if (endAngle > 360) {\n      endAngle %= 360;\n    }\n\n    if (startAngle > endAngle) {\n      startAngle -= 360;\n    }\n\n    noArc = false;\n  }\n\n  startAngle *= PI_DIV_180;\n  endAngle *= PI_DIV_180;\n  return [x, y, min(outerR, innerR), max(outerR, innerR), cos(startAngle), sin(startAngle), cos(endAngle), sin(endAngle), isCircle, floor(abs(endAngle - startAngle) / PI) % 2 ? \"1\" : \"0\", noArc];\n}\n\nvar buildArcPath = function buildArcPath(x, y, innerR, outerR, startAngleCos, startAngleSin, endAngleCos, endAngleSin, isCircle, longFlag) {\n  return [\"M\", (x + outerR * startAngleCos).toFixed(ARC_COORD_PREC), (y - outerR * startAngleSin).toFixed(ARC_COORD_PREC), \"A\", outerR.toFixed(ARC_COORD_PREC), outerR.toFixed(ARC_COORD_PREC), 0, longFlag, 0, (x + outerR * endAngleCos).toFixed(ARC_COORD_PREC), (y - outerR * endAngleSin).toFixed(ARC_COORD_PREC), isCircle ? \"M\" : \"L\", (x + innerR * endAngleCos).toFixed(5), (y - innerR * endAngleSin).toFixed(ARC_COORD_PREC), \"A\", innerR.toFixed(ARC_COORD_PREC), innerR.toFixed(ARC_COORD_PREC), 0, longFlag, 1, (x + innerR * startAngleCos).toFixed(ARC_COORD_PREC), (y - innerR * startAngleSin).toFixed(ARC_COORD_PREC), \"Z\"].join(\" \");\n};\n\nfunction buildPathSegments(points, type) {\n  var list = [[\"M\", 0, 0]];\n\n  switch (type) {\n    case \"line\":\n      list = buildLineSegments(points);\n      break;\n\n    case \"area\":\n      list = buildLineSegments(points, true);\n      break;\n\n    case \"bezier\":\n      list = buildCurveSegments(points);\n      break;\n\n    case \"bezierarea\":\n      list = buildCurveSegments(points, true);\n  }\n\n  return list;\n}\n\nfunction buildLineSegments(points, close) {\n  return buildSegments(points, buildSimpleLineSegment, close);\n}\n\nfunction buildCurveSegments(points, close) {\n  return buildSegments(points, buildSimpleCurveSegment, close);\n}\n\nfunction buildSegments(points, buildSimpleSegment, close) {\n  var i;\n  var ii;\n  var list = [];\n\n  if (points[0] && points[0].length) {\n    for (i = 0, ii = points.length; i < ii; ++i) {\n      buildSimpleSegment(points[i], close, list);\n    }\n  } else {\n    buildSimpleSegment(points, close, list);\n  }\n\n  return list;\n}\n\nfunction buildSimpleLineSegment(points, close, list) {\n  var i = 0;\n  var k0 = list.length;\n  var k = k0;\n  var ii = (points || []).length;\n\n  if (ii) {\n    if (void 0 !== points[0].x) {\n      for (; i < ii;) {\n        list[k++] = [\"L\", points[i].x, points[i++].y];\n      }\n    } else {\n      for (; i < ii;) {\n        list[k++] = [\"L\", points[i++], points[i++]];\n      }\n    }\n\n    list[k0][0] = \"M\";\n  } else {\n    list[k] = [\"M\", 0, 0];\n  }\n\n  close && list.push([\"Z\"]);\n  return list;\n}\n\nfunction buildSimpleCurveSegment(points, close, list) {\n  var i;\n  var k = list.length;\n  var ii = (points || []).length;\n\n  if (ii) {\n    if (void 0 !== points[0].x) {\n      list[k++] = [\"M\", points[0].x, points[0].y];\n\n      for (i = 1; i < ii;) {\n        list[k++] = [\"C\", points[i].x, points[i++].y, points[i].x, points[i++].y, points[i].x, points[i++].y];\n      }\n    } else {\n      list[k++] = [\"M\", points[0], points[1]];\n\n      for (i = 2; i < ii;) {\n        list[k++] = [\"C\", points[i++], points[i++], points[i++], points[i++], points[i++], points[i++]];\n      }\n    }\n  } else {\n    list[k] = [\"M\", 0, 0];\n  }\n\n  close && list.push([\"Z\"]);\n  return list;\n}\n\nfunction combinePathParam(segments) {\n  var d = [];\n  var k = 0;\n  var i;\n  var ii = segments.length;\n  var segment;\n  var j;\n  var jj;\n\n  for (i = 0; i < ii; ++i) {\n    segment = segments[i];\n\n    for (j = 0, jj = segment.length; j < jj; ++j) {\n      d[k++] = segment[j];\n    }\n  }\n\n  return d.join(\" \");\n}\n\nfunction compensateSegments(oldSegments, newSegments, type) {\n  var oldLength = oldSegments.length;\n  var newLength = newSegments.length;\n  var i;\n  var originalNewSegments;\n  var makeEqualSegments = type.indexOf(\"area\") !== -1 ? makeEqualAreaSegments : makeEqualLineSegments;\n\n  if (0 === oldLength) {\n    for (i = 0; i < newLength; i++) {\n      oldSegments.push(newSegments[i].slice(0));\n    }\n  } else {\n    if (oldLength < newLength) {\n      makeEqualSegments(oldSegments, newSegments, type);\n    } else {\n      if (oldLength > newLength) {\n        originalNewSegments = newSegments.slice(0);\n        makeEqualSegments(newSegments, oldSegments, type);\n      }\n    }\n  }\n\n  return originalNewSegments;\n}\n\nfunction prepareConstSegment(constSeg, type) {\n  var x = constSeg[constSeg.length - 2];\n  var y = constSeg[constSeg.length - 1];\n\n  switch (type) {\n    case \"line\":\n    case \"area\":\n      constSeg[0] = \"L\";\n      break;\n\n    case \"bezier\":\n    case \"bezierarea\":\n      constSeg[0] = \"C\";\n      constSeg[1] = constSeg[3] = constSeg[5] = x;\n      constSeg[2] = constSeg[4] = constSeg[6] = y;\n  }\n}\n\nfunction makeEqualLineSegments(short, long, type) {\n  var constSeg = short[short.length - 1].slice();\n  var i = short.length;\n  prepareConstSegment(constSeg, type);\n\n  for (; i < long.length; i++) {\n    short[i] = constSeg.slice(0);\n  }\n}\n\nfunction makeEqualAreaSegments(short, long, type) {\n  var i;\n  var head;\n  var shortLength = short.length;\n  var longLength = long.length;\n  var constsSeg1;\n  var constsSeg2;\n\n  if ((shortLength - 1) % 2 === 0 && (longLength - 1) % 2 === 0) {\n    i = (shortLength - 1) / 2 - 1;\n    head = short.slice(0, i + 1);\n    constsSeg1 = head[head.length - 1].slice(0);\n    constsSeg2 = short.slice(i + 1)[0].slice(0);\n    prepareConstSegment(constsSeg1, type);\n    prepareConstSegment(constsSeg2, type);\n\n    for (var j = i; j < (longLength - 1) / 2 - 1; j++) {\n      short.splice(j + 1, 0, constsSeg1);\n      short.splice(j + 3, 0, constsSeg2);\n    }\n  }\n}\n\nfunction baseCss(that, styles) {\n  var elemStyles = that._styles;\n  var str = \"\";\n  var key;\n  var value;\n  styles = styles || {};\n\n  for (key in styles) {\n    value = styles[key];\n\n    if ((0, _type.isDefined)(value)) {\n      value += \"number\" === typeof value && !pxAddingExceptions[key] ? \"px\" : \"\";\n      elemStyles[key] = \"\" !== value ? value : null;\n    }\n  }\n\n  for (key in elemStyles) {\n    value = elemStyles[key];\n\n    if (value) {\n      str += key + \":\" + value + \";\";\n    }\n  }\n\n  str && that.element.setAttribute(\"style\", str);\n  return that;\n}\n\nfunction fixFuncIri(wrapper, attribute) {\n  var element = wrapper.element;\n  var id = wrapper.attr(attribute);\n\n  if (id && id.indexOf(\"DevExpress\") !== -1) {\n    element.removeAttribute(attribute);\n    element.setAttribute(attribute, getFuncIri(id, wrapper.renderer.pathModified));\n  }\n}\n\nfunction baseAttr(that, attrs) {\n  attrs = attrs || {};\n  var settings = that._settings;\n  var attributes = {};\n  var key;\n  var value;\n  var elem = that.element;\n  var renderer = that.renderer;\n  var rtl = renderer.rtl;\n  var hasTransformations;\n  var recalculateDashStyle;\n  var sw;\n  var i;\n\n  if (!isObjectArgument(attrs)) {\n    if (attrs in settings) {\n      return settings[attrs];\n    }\n\n    if (attrs in DEFAULTS) {\n      return DEFAULTS[attrs];\n    }\n\n    return 0;\n  }\n\n  extend(attributes, attrs);\n\n  for (key in attributes) {\n    value = attributes[key];\n\n    if (void 0 === value) {\n      continue;\n    }\n\n    settings[key] = value;\n\n    if (\"align\" === key) {\n      key = \"text-anchor\";\n      value = {\n        left: rtl ? \"end\" : \"start\",\n        center: \"middle\",\n        right: rtl ? \"start\" : \"end\"\n      }[value] || null;\n    } else {\n      if (\"dashStyle\" === key) {\n        recalculateDashStyle = true;\n        continue;\n      } else {\n        if (key === KEY_STROKE_WIDTH) {\n          recalculateDashStyle = true;\n        } else {\n          if (value && (\"fill\" === key || \"clip-path\" === key || \"filter\" === key) && 0 === value.indexOf(\"DevExpress\")) {\n            that._addFixIRICallback();\n\n            value = getFuncIri(value, renderer.pathModified);\n          } else {\n            if (/^(translate(X|Y)|rotate[XY]?|scale(X|Y)|sharp|sharpDirection)$/i.test(key)) {\n              hasTransformations = true;\n              continue;\n            } else {\n              if (/^(x|y|d)$/i.test(key)) {\n                hasTransformations = true;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    if (null === value) {\n      elem.removeAttribute(key);\n    } else {\n      elem.setAttribute(key, value);\n    }\n  }\n\n  if (recalculateDashStyle && \"dashStyle\" in settings) {\n    value = settings.dashStyle;\n    sw = (\"_originalSW\" in that ? that._originalSW : settings[KEY_STROKE_WIDTH]) || 1;\n    key = \"stroke-dasharray\";\n    value = null === value ? \"\" : (0, _utils.normalizeEnum)(value);\n\n    if (\"\" === value || \"solid\" === value || value === NONE) {\n      that.element.removeAttribute(key);\n    } else {\n      value = value.replace(/longdash/g, \"8,3,\").replace(/dash/g, \"4,3,\").replace(/dot/g, \"1,3,\").replace(/,$/, \"\").split(\",\");\n      i = value.length;\n\n      while (i--) {\n        value[i] = parseInt(value[i]) * sw;\n      }\n\n      that.element.setAttribute(key, value.join(\",\"));\n    }\n  }\n\n  if (hasTransformations) {\n    that._applyTransformation();\n  }\n\n  return that;\n}\n\nfunction pathAttr(attrs) {\n  var that = this;\n  var segments;\n\n  if (isObjectArgument(attrs)) {\n    attrs = extend({}, attrs);\n    segments = attrs.segments;\n\n    if (\"points\" in attrs) {\n      segments = buildPathSegments(attrs.points, that.type);\n      delete attrs.points;\n    }\n\n    if (segments) {\n      attrs.d = combinePathParam(segments);\n      that.segments = segments;\n      delete attrs.segments;\n    }\n  }\n\n  return baseAttr(that, attrs);\n}\n\nfunction arcAttr(attrs) {\n  var settings = this._settings;\n  var x;\n  var y;\n  var innerRadius;\n  var outerRadius;\n  var startAngle;\n  var endAngle;\n\n  if (isObjectArgument(attrs)) {\n    attrs = extend({}, attrs);\n\n    if (\"x\" in attrs || \"y\" in attrs || \"innerRadius\" in attrs || \"outerRadius\" in attrs || \"startAngle\" in attrs || \"endAngle\" in attrs) {\n      settings.x = x = \"x\" in attrs ? attrs.x : settings.x;\n      delete attrs.x;\n      settings.y = y = \"y\" in attrs ? attrs.y : settings.y;\n      delete attrs.y;\n      settings.innerRadius = innerRadius = \"innerRadius\" in attrs ? attrs.innerRadius : settings.innerRadius;\n      delete attrs.innerRadius;\n      settings.outerRadius = outerRadius = \"outerRadius\" in attrs ? attrs.outerRadius : settings.outerRadius;\n      delete attrs.outerRadius;\n      settings.startAngle = startAngle = \"startAngle\" in attrs ? attrs.startAngle : settings.startAngle;\n      delete attrs.startAngle;\n      settings.endAngle = endAngle = \"endAngle\" in attrs ? attrs.endAngle : settings.endAngle;\n      delete attrs.endAngle;\n      attrs.d = buildArcPath.apply(null, normalizeArcParams(x, y, innerRadius, outerRadius, startAngle, endAngle));\n    }\n  }\n\n  return baseAttr(this, attrs);\n}\n\nfunction rectAttr(attrs) {\n  var that = this;\n  var x;\n  var y;\n  var width;\n  var height;\n  var sw;\n  var maxSW;\n  var newSW;\n\n  if (isObjectArgument(attrs)) {\n    attrs = extend({}, attrs);\n\n    if (void 0 !== attrs.x || void 0 !== attrs.y || void 0 !== attrs.width || void 0 !== attrs.height || void 0 !== attrs[KEY_STROKE_WIDTH]) {\n      void 0 !== attrs.x ? x = that._originalX = attrs.x : x = that._originalX || 0;\n      void 0 !== attrs.y ? y = that._originalY = attrs.y : y = that._originalY || 0;\n      void 0 !== attrs.width ? width = that._originalWidth = attrs.width : width = that._originalWidth || 0;\n      void 0 !== attrs.height ? height = that._originalHeight = attrs.height : height = that._originalHeight || 0;\n      void 0 !== attrs[KEY_STROKE_WIDTH] ? sw = that._originalSW = attrs[KEY_STROKE_WIDTH] : sw = that._originalSW;\n      maxSW = ~~((width < height ? width : height) / 2);\n      newSW = (sw || 0) < maxSW ? sw || 0 : maxSW;\n      attrs.x = x + newSW / 2;\n      attrs.y = y + newSW / 2;\n      attrs.width = width - newSW;\n      attrs.height = height - newSW;\n      ((sw || 0) !== newSW || !(0 === newSW && void 0 === sw)) && (attrs[KEY_STROKE_WIDTH] = newSW);\n    }\n\n    if (\"sharp\" in attrs) {\n      delete attrs.sharp;\n    }\n  }\n\n  return baseAttr(that, attrs);\n}\n\nfunction textAttr(attrs) {\n  var that = this;\n  var settings;\n  var isResetRequired;\n  var wasStroked;\n  var isStroked;\n\n  if (!isObjectArgument(attrs)) {\n    return baseAttr(that, attrs);\n  }\n\n  attrs = extend({}, attrs);\n  settings = that._settings;\n  wasStroked = (0, _type.isDefined)(settings[KEY_STROKE]) && (0, _type.isDefined)(settings[KEY_STROKE_WIDTH]);\n\n  if (void 0 !== attrs[KEY_TEXT]) {\n    settings[KEY_TEXT] = attrs[KEY_TEXT];\n    delete attrs[KEY_TEXT];\n    isResetRequired = true;\n  }\n\n  if (void 0 !== attrs[KEY_STROKE]) {\n    settings[KEY_STROKE] = attrs[KEY_STROKE];\n    delete attrs[KEY_STROKE];\n  }\n\n  if (void 0 !== attrs[KEY_STROKE_WIDTH]) {\n    settings[KEY_STROKE_WIDTH] = attrs[KEY_STROKE_WIDTH];\n    delete attrs[KEY_STROKE_WIDTH];\n  }\n\n  if (void 0 !== attrs[KEY_STROKE_OPACITY]) {\n    settings[KEY_STROKE_OPACITY] = attrs[KEY_STROKE_OPACITY];\n    delete attrs[KEY_STROKE_OPACITY];\n  }\n\n  if (void 0 !== attrs[KEY_TEXTS_ALIGNMENT]) {\n    alignTextNodes(that, attrs[KEY_TEXTS_ALIGNMENT]);\n    delete attrs[KEY_TEXTS_ALIGNMENT];\n  }\n\n  isStroked = (0, _type.isDefined)(settings[KEY_STROKE]) && (0, _type.isDefined)(settings[KEY_STROKE_WIDTH]);\n  baseAttr(that, attrs);\n  isResetRequired = isResetRequired || isStroked !== wasStroked && settings[KEY_TEXT];\n\n  if (isResetRequired) {\n    createTextNodes(that, settings.text, isStroked);\n    that._hasEllipsis = false;\n  }\n\n  if (isResetRequired || void 0 !== attrs.x || void 0 !== attrs.y) {\n    locateTextNodes(that);\n  }\n\n  if (isStroked) {\n    strokeTextNodes(that);\n  }\n\n  return that;\n}\n\nfunction textCss(styles) {\n  styles = styles || {};\n  baseCss(this, styles);\n\n  if (KEY_FONT_SIZE in styles) {\n    locateTextNodes(this);\n  }\n\n  return this;\n}\n\nfunction orderHtmlTree(list, line, node, parentStyle, parentClassName) {\n  var style;\n  var realStyle;\n  var i;\n  var ii;\n  var nodes;\n\n  if (void 0 !== node.wholeText) {\n    list.push({\n      value: node.wholeText,\n      style: parentStyle,\n      className: parentClassName,\n      line: line,\n      height: parentStyle[KEY_FONT_SIZE] || 0\n    });\n  } else {\n    if (\"BR\" === node.tagName) {\n      ++line;\n    } else {\n      if (_dom_adapter2.default.isElementNode(node)) {\n        extend(style = {}, parentStyle);\n\n        switch (node.tagName) {\n          case \"B\":\n          case \"STRONG\":\n            style[KEY_FONT_WEIGHT] = \"bold\";\n            break;\n\n          case \"I\":\n          case \"EM\":\n            style[KEY_FONT_STYLE] = \"italic\";\n            break;\n\n          case \"U\":\n            style[KEY_TEXT_DECORATION] = \"underline\";\n        }\n\n        realStyle = node.style;\n        realStyle.color && (style.fill = realStyle.color);\n        realStyle.fontSize && (style[KEY_FONT_SIZE] = realStyle.fontSize);\n        realStyle.fontStyle && (style[KEY_FONT_STYLE] = realStyle.fontStyle);\n        realStyle.fontWeight && (style[KEY_FONT_WEIGHT] = realStyle.fontWeight);\n        realStyle.textDecoration && (style[KEY_TEXT_DECORATION] = realStyle.textDecoration);\n\n        for (i = 0, nodes = node.childNodes, ii = nodes.length; i < ii; ++i) {\n          line = orderHtmlTree(list, line, nodes[i], style, node.className || parentClassName);\n        }\n      }\n    }\n  }\n\n  return line;\n}\n\nfunction adjustLineHeights(items) {\n  var i;\n  var ii;\n  var currentItem = items[0];\n  var item;\n\n  for (i = 1, ii = items.length; i < ii; ++i) {\n    item = items[i];\n\n    if (item.line === currentItem.line) {\n      currentItem.height = maxLengthFontSize(currentItem.height, item.height);\n      currentItem.inherits = currentItem.inherits || 0 === parseFloat(item.height);\n      item.height = NaN;\n    } else {\n      currentItem = item;\n    }\n  }\n}\n\nfunction removeExtraAttrs(html) {\n  var findTagAttrs = /(?:(<[a-z0-9]+\\s*))([\\s\\S]*?)(>|\\/>)/gi;\n  var findStyleAndClassAttrs = /(style|class)\\s*=\\s*([\"'])(?:(?!\\2).)*\\2\\s?/gi;\n  return html.replace(findTagAttrs, function (allTagAttrs, p1, p2, p3) {\n    p2 = (p2 && p2.match(findStyleAndClassAttrs) || []).map(function (str) {\n      return str;\n    }).join(\" \");\n    return p1 + p2 + p3;\n  });\n}\n\nfunction parseHTML(text) {\n  var items = [];\n\n  var div = _dom_adapter2.default.createElement(\"div\");\n\n  div.innerHTML = text.replace(/\\r/g, \"\").replace(/\\n/g, \"<br/>\");\n  orderHtmlTree(items, 0, div, {}, \"\");\n  adjustLineHeights(items);\n  return items;\n}\n\nfunction parseMultiline(text) {\n  var texts = text.replace(/\\r/g, \"\").split(/\\n/g);\n  var i = 0;\n  var items = [];\n\n  for (; i < texts.length; i++) {\n    items.push({\n      value: texts[i].trim(),\n      height: 0,\n      line: i\n    });\n  }\n\n  return items;\n}\n\nfunction createTspans(items, element, fieldName) {\n  var i;\n  var ii;\n  var item;\n\n  for (i = 0, ii = items.length; i < ii; ++i) {\n    item = items[i];\n    item[fieldName] = createElement(\"tspan\");\n    item[fieldName].appendChild(_dom_adapter2.default.createTextNode(item.value));\n    item.style && baseCss({\n      element: item[fieldName],\n      _styles: {}\n    }, item.style);\n    item.className && item[fieldName].setAttribute(\"class\", item.className);\n    element.appendChild(item[fieldName]);\n  }\n}\n\nfunction restoreText() {\n  if (this._hasEllipsis) {\n    this.attr({\n      text: this._settings.text\n    });\n  }\n}\n\nfunction applyEllipsis(maxWidth) {\n  var that = this;\n  var lines;\n  var hasEllipsis = false;\n  var i;\n  var ii;\n  var lineParts;\n  var j;\n  var jj;\n  var text;\n  var ellipsis;\n  var ellipsisWidth;\n  restoreText.call(that);\n  ellipsis = that.renderer.text(ELLIPSIS).attr(that._styles).append(that.renderer.root);\n  ellipsisWidth = ellipsis.getBBox().width;\n\n  if (that._getElementBBox().width > maxWidth) {\n    if (maxWidth - ellipsisWidth < 0) {\n      maxWidth = 0;\n    } else {\n      maxWidth -= ellipsisWidth;\n    }\n\n    lines = prepareLines(that.element, that._texts, maxWidth);\n\n    for (i = 0, ii = lines.length; i < ii; ++i) {\n      lineParts = lines[i].parts;\n\n      if (1 === lines[i].commonLength) {\n        continue;\n      }\n\n      for (j = 0, jj = lineParts.length; j < jj; ++j) {\n        text = lineParts[j];\n\n        if ((0, _type.isDefined)(text.endIndex)) {\n          setNewText(text, text.endIndex);\n          hasEllipsis = true;\n        } else {\n          if (text.startBox > maxWidth) {\n            removeTextSpan(text);\n          }\n        }\n      }\n    }\n  }\n\n  ellipsis.remove();\n  that._hasEllipsis = hasEllipsis;\n  return hasEllipsis;\n}\n\nfunction cloneAndRemoveAttrs(node) {\n  var clone;\n\n  if (node) {\n    clone = node.cloneNode();\n    clone.removeAttribute(\"y\");\n    clone.removeAttribute(\"x\");\n  }\n\n  return clone || node;\n}\n\nfunction detachAndStoreTitleElements(element) {\n  var titleElements = _dom_adapter2.default.querySelectorAll(element, \"title\");\n\n  for (var i = 0; i < titleElements.length; i++) {\n    element.removeChild(titleElements[i]);\n  }\n\n  return function () {\n    for (var _i = 0; _i < titleElements.length; _i++) {\n      element.appendChild(titleElements[_i]);\n    }\n  };\n}\n\nfunction setMaxSize(maxWidth, maxHeight) {\n  var options = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\n  var that = this;\n  var lines = [];\n  var textChanged = false;\n  var textIsEmpty = false;\n  var ellipsis;\n  var ellipsisWidth;\n  var ellipsisMaxWidth = maxWidth;\n  restoreText.call(that);\n  var restoreTitleElement = detachAndStoreTitleElements(this.element);\n  ellipsis = that.renderer.text(ELLIPSIS).attr(that._styles).append(that.renderer.root);\n  ellipsisWidth = ellipsis.getBBox().width;\n\n  var _that$_getElementBBox = that._getElementBBox(),\n      width = _that$_getElementBBox.width,\n      height = _that$_getElementBBox.height;\n\n  if ((width || height) && (width > maxWidth || maxHeight && height > maxHeight)) {\n    if (maxWidth - ellipsisWidth < 0) {\n      ellipsisMaxWidth = 0;\n    } else {\n      ellipsisMaxWidth -= ellipsisWidth;\n    }\n\n    lines = applyOverflowRules(that.element, that._texts, maxWidth, ellipsisMaxWidth, options, maxHeight);\n    lines = setMaxHeight(lines, ellipsisMaxWidth, options, maxHeight, parseFloat(this._getLineHeight()));\n    this._texts = lines.reduce(function (texts, line) {\n      return texts.concat(line.parts);\n    }, []).filter(function (t) {\n      return \"\" !== t.value;\n    }).map(function (t) {\n      t.stroke && t.tspan.parentNode.appendChild(t.stroke);\n      return t;\n    }).map(function (t) {\n      t.tspan.parentNode.appendChild(t.tspan);\n      return t;\n    });\n    !this._texts.length && (this._texts = null);\n    textChanged = true;\n\n    if (this._texts) {\n      locateTextNodes(this);\n    } else {\n      this.element.textContent = \"\";\n      textIsEmpty = true;\n    }\n  }\n\n  ellipsis.remove();\n  that._hasEllipsis = textChanged;\n  restoreTitleElement();\n  return {\n    rowCount: lines.length,\n    textChanged: textChanged,\n    textIsEmpty: textIsEmpty\n  };\n}\n\nfunction getIndexForEllipsis(text, maxWidth, startBox, endBox) {\n  var k;\n  var kk;\n\n  if (startBox <= maxWidth && endBox > maxWidth) {\n    for (k = 1, kk = text.value.length; k <= kk; ++k) {\n      if (startBox + text.tspan.getSubStringLength(0, k) > maxWidth) {\n        return k - 1;\n      }\n    }\n  }\n}\n\nfunction getTextWidth(text) {\n  return text.value.length ? text.tspan.getSubStringLength(0, text.value.length) : 0;\n}\n\nfunction prepareLines(element, texts, maxWidth) {\n  var lines = [];\n  var i;\n  var ii;\n  var text;\n  var startBox;\n  var endBox;\n\n  if (texts) {\n    for (i = 0, ii = texts.length; i < ii; ++i) {\n      text = texts[i];\n\n      if (!lines[text.line]) {\n        text.startBox = startBox = 0;\n        lines.push({\n          commonLength: text.value.length,\n          parts: [text]\n        });\n      } else {\n        text.startBox = startBox;\n        lines[text.line].parts.push(text);\n        lines[text.line].commonLength += text.value.length;\n      }\n\n      endBox = startBox + text.tspan.getSubStringLength(0, text.value.length);\n      text.endIndex = getIndexForEllipsis(text, maxWidth, startBox, endBox);\n      startBox = endBox;\n    }\n  } else {\n    text = {\n      value: element.textContent,\n      tspan: element\n    };\n    text.startBox = startBox = 0;\n    endBox = startBox + getTextWidth(text);\n    text.endIndex = getIndexForEllipsis(text, maxWidth, startBox, endBox);\n    lines = [{\n      commonLength: element.textContent.length,\n      parts: [text]\n    }];\n  }\n\n  return lines;\n}\n\nfunction getSpaceBreakIndex(text, maxWidth) {\n  var initialIndices = text.startBox > 0 ? [0] : [];\n  var spaceIndices = text.value.split(\"\").reduce(function (indices, char, index) {\n    if (\" \" === char) {\n      indices.push(index);\n    }\n\n    return indices;\n  }, initialIndices);\n  var spaceIndex = 0;\n\n  while (void 0 !== spaceIndices[spaceIndex + 1] && text.startBox + text.tspan.getSubStringLength(0, spaceIndices[spaceIndex + 1]) < maxWidth) {\n    spaceIndex++;\n  }\n\n  return spaceIndices[spaceIndex];\n}\n\nfunction getWordBreakIndex(text, maxWidth) {\n  for (var i = 0; i < text.value.length - 1; i++) {\n    if (text.startBox + text.tspan.getSubStringLength(0, i + 1) > maxWidth) {\n      return i;\n    }\n  }\n}\n\nfunction getEllipsisString(ellipsisMaxWidth, _ref) {\n  var hideOverflowEllipsis = _ref.hideOverflowEllipsis;\n  return hideOverflowEllipsis && 0 === ellipsisMaxWidth ? \"\" : ELLIPSIS;\n}\n\nfunction setEllipsis(text, ellipsisMaxWidth, options) {\n  var ellipsis = getEllipsisString(ellipsisMaxWidth, options);\n\n  if (text.value.length && text.tspan.parentNode) {\n    for (var i = text.value.length - 1; i >= 1; i--) {\n      if (text.startBox + text.tspan.getSubStringLength(0, i) < ellipsisMaxWidth) {\n        setNewText(text, i, ellipsis);\n        break;\n      } else {\n        if (1 === i) {\n          setNewText(text, 0, ellipsis);\n        }\n      }\n    }\n  }\n}\n\nfunction wordWrap(text, maxWidth, ellipsisMaxWidth, options) {\n  var wholeText = text.value;\n  var breakIndex;\n\n  if (\"none\" !== options.wordWrap) {\n    breakIndex = \"normal\" === options.wordWrap ? getSpaceBreakIndex(text, maxWidth) : getWordBreakIndex(text, maxWidth);\n  }\n\n  var restLines = [];\n  var restText;\n\n  if (isFinite(breakIndex)) {\n    setNewText(text, breakIndex, \"\");\n    var newTextOffset = \" \" === wholeText[breakIndex] ? 1 : 0;\n    var restString = wholeText.slice(breakIndex + newTextOffset);\n\n    if (restString.length) {\n      var restTspan = cloneAndRemoveAttrs(text.tspan);\n      restTspan.textContent = restString;\n      text.tspan.parentNode.appendChild(restTspan);\n      restText = extend(extend({}, text), {\n        value: restString,\n        startBox: 0,\n        height: 0,\n        tspan: restTspan,\n        stroke: cloneAndRemoveAttrs(text.stroke),\n        endBox: restTspan.getSubStringLength(0, restString.length)\n      });\n      restText.stroke && (restText.stroke.textContent = restString);\n\n      if (restText.endBox > maxWidth) {\n        restLines = wordWrap(restText, maxWidth, ellipsisMaxWidth, options);\n\n        if (!restLines.length) {\n          return [];\n        }\n      }\n    }\n  }\n\n  if (text.value.length) {\n    if (\"ellipsis\" === options.textOverflow && text.tspan.getSubStringLength(0, text.value.length) > maxWidth) {\n      setEllipsis(text, ellipsisMaxWidth, options);\n    }\n\n    if (\"hide\" === options.textOverflow && text.tspan.getSubStringLength(0, text.value.length) > maxWidth) {\n      return [];\n    }\n  } else {\n    text.tspan.parentNode.removeChild(text.tspan);\n  }\n\n  var parts = [];\n\n  if (restText) {\n    parts.push(restText);\n  }\n\n  return [{\n    commonLength: wholeText.length,\n    parts: parts\n  }].concat(restLines);\n}\n\nfunction calculateLineHeight(line, lineHeight) {\n  return line.parts.reduce(function (height, text) {\n    return max(height, getItemLineHeight(text, lineHeight));\n  }, 0);\n}\n\nfunction setMaxHeight(lines, ellipsisMaxWidth, options, maxHeight, lineHeight) {\n  var textOverflow = options.textOverflow;\n\n  if (!isFinite(maxHeight) || 0 === Number(maxHeight) || \"none\" === textOverflow) {\n    return lines;\n  }\n\n  var result = lines.reduce(function (_ref2, l, index, arr) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        lines = _ref3[0],\n        commonHeight = _ref3[1];\n\n    var height = calculateLineHeight(l, lineHeight);\n    commonHeight += height;\n\n    if (commonHeight < maxHeight) {\n      lines.push(l);\n    } else {\n      l.parts.forEach(function (item) {\n        removeTextSpan(item);\n      });\n\n      if (\"ellipsis\" === textOverflow) {\n        var prevLine = arr[index - 1];\n\n        if (prevLine) {\n          var text = prevLine.parts[prevLine.parts.length - 1];\n\n          if (!text.hasEllipsis) {\n            if (0 === ellipsisMaxWidth || text.endBox < ellipsisMaxWidth) {\n              setNewText(text, text.value.length, getEllipsisString(ellipsisMaxWidth, options));\n            } else {\n              setEllipsis(text, ellipsisMaxWidth, options);\n            }\n          }\n        }\n      }\n    }\n\n    return [lines, commonHeight];\n  }, [[], 0]);\n\n  if (\"hide\" === textOverflow && result[1] > maxHeight) {\n    result[0].forEach(function (l) {\n      l.parts.forEach(function (item) {\n        removeTextSpan(item);\n      });\n    });\n    return [];\n  }\n\n  return result[0];\n}\n\nfunction applyOverflowRules(element, texts, maxWidth, ellipsisMaxWidth, options) {\n  if (!texts) {\n    var textValue = element.textContent;\n    var text = {\n      value: textValue,\n      height: 0,\n      line: 0\n    };\n    element.textContent = \"\";\n    createTspans([text], element, \"tspan\");\n    texts = [text];\n  }\n\n  return texts.reduce(function (_ref4, text) {\n    var _ref5 = _slicedToArray(_ref4, 5),\n        lines = _ref5[0],\n        startBox = _ref5[1],\n        endBox = _ref5[2],\n        stop = _ref5[3],\n        lineNumber = _ref5[4];\n\n    var line = lines[lines.length - 1];\n\n    if (stop) {\n      return [lines, startBox, endBox, stop];\n    }\n\n    if (!line || text.line !== lineNumber) {\n      text.startBox = startBox = 0;\n      lines.push({\n        commonLength: text.value.length,\n        parts: [text]\n      });\n    } else {\n      text.startBox = startBox;\n\n      if (startBox > ellipsisMaxWidth && \"none\" === options.wordWrap && \"ellipsis\" === options.textOverflow) {\n        removeTextSpan(text);\n        return [lines, startBox, endBox, stop, lineNumber];\n      }\n\n      line.parts.push(text);\n      line.commonLength += text.value.length;\n    }\n\n    text.endBox = endBox = startBox + getTextWidth(text);\n    startBox = endBox;\n\n    if ((0, _type.isDefined)(maxWidth) && endBox > maxWidth) {\n      var wordWrapLines = wordWrap(text, maxWidth, ellipsisMaxWidth, options);\n\n      if (!wordWrapLines.length) {\n        lines = [];\n        stop = true;\n      } else {\n        lines = lines.concat(wordWrapLines.filter(function (l) {\n          return l.parts.length > 0;\n        }));\n      }\n    }\n\n    return [lines, startBox, endBox, stop, text.line];\n  }, [[], 0, 0, false, 0])[0];\n}\n\nfunction setNewText(text, index) {\n  var insertString = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : ELLIPSIS;\n  var newText = text.value.substr(0, index) + insertString;\n  text.value = text.tspan.textContent = newText;\n  text.stroke && (text.stroke.textContent = newText);\n\n  if (insertString === ELLIPSIS) {\n    text.hasEllipsis = true;\n  }\n}\n\nfunction removeTextSpan(text) {\n  text.tspan.parentNode && text.tspan.parentNode.removeChild(text.tspan);\n  text.stroke && text.stroke.parentNode && text.stroke.parentNode.removeChild(text.stroke);\n}\n\nfunction createTextNodes(wrapper, text, isStroked) {\n  var items;\n  var parsedHtml;\n  wrapper._texts = null;\n  wrapper.clear();\n\n  if (null === text) {\n    return;\n  }\n\n  text = \"\" + text;\n\n  if (!wrapper.renderer.encodeHtml && (/<[a-z][\\s\\S]*>/i.test(text) || text.indexOf(\"&\") !== -1)) {\n    parsedHtml = removeExtraAttrs(text);\n    items = parseHTML(parsedHtml);\n  } else {\n    if (/\\n/g.test(text)) {\n      items = parseMultiline(text);\n    } else {\n      if (isStroked) {\n        items = [{\n          value: text.trim(),\n          height: 0\n        }];\n      }\n    }\n  }\n\n  if (items) {\n    if (items.length) {\n      wrapper._texts = items;\n\n      if (isStroked) {\n        createTspans(items, wrapper.element, KEY_STROKE);\n      }\n\n      createTspans(items, wrapper.element, \"tspan\");\n    }\n  } else {\n    wrapper.element.appendChild(_dom_adapter2.default.createTextNode(text));\n  }\n}\n\nfunction setTextNodeAttribute(item, name, value) {\n  item.tspan.setAttribute(name, value);\n  item.stroke && item.stroke.setAttribute(name, value);\n}\n\nfunction getItemLineHeight(item, defaultValue) {\n  return item.inherits ? maxLengthFontSize(item.height, defaultValue) : item.height || defaultValue;\n}\n\nfunction locateTextNodes(wrapper) {\n  if (!wrapper._texts) {\n    return;\n  }\n\n  var items = wrapper._texts;\n  var x = wrapper._settings.x;\n\n  var lineHeight = wrapper._getLineHeight();\n\n  var i;\n  var ii;\n  var item = items[0];\n  setTextNodeAttribute(item, \"x\", x);\n  setTextNodeAttribute(item, \"y\", wrapper._settings.y);\n\n  for (i = 1, ii = items.length; i < ii; ++i) {\n    item = items[i];\n\n    if (parseFloat(item.height) >= 0) {\n      setTextNodeAttribute(item, \"x\", x);\n      var height = getItemLineHeight(item, lineHeight);\n      setTextNodeAttribute(item, \"dy\", height);\n    }\n  }\n}\n\nfunction alignTextNodes(wrapper, alignment) {\n  if (!wrapper._texts || \"center\" === alignment) {\n    return;\n  }\n\n  var items = wrapper._texts;\n  var direction = \"left\" === alignment ? -1 : 1;\n  var maxTextWidth = Math.max.apply(Math, items.map(function (t) {\n    return getTextWidth(t);\n  }));\n\n  for (var i = 0; i < items.length; i++) {\n    var item = items[i];\n    var textWidth = getTextWidth(item);\n\n    if (0 !== maxTextWidth && maxTextWidth !== textWidth) {\n      setTextNodeAttribute(item, \"dx\", direction * round((maxTextWidth - textWidth) / 2 * 10) / 10);\n    }\n  }\n}\n\nfunction maxLengthFontSize(fontSize1, fontSize2) {\n  var parsedHeight1 = parseFloat(fontSize1);\n  var parsedHeight2 = parseFloat(fontSize2);\n  var height1 = parsedHeight1 || DEFAULT_FONT_SIZE;\n  var height2 = parsedHeight2 || DEFAULT_FONT_SIZE;\n  return height1 > height2 ? !isNaN(parsedHeight1) ? fontSize1 : height1 : !isNaN(parsedHeight2) ? fontSize2 : height2;\n}\n\nfunction strokeTextNodes(wrapper) {\n  if (!wrapper._texts) {\n    return;\n  }\n\n  var items = wrapper._texts;\n  var stroke = wrapper._settings[KEY_STROKE];\n  var strokeWidth = wrapper._settings[KEY_STROKE_WIDTH];\n  var strokeOpacity = wrapper._settings[KEY_STROKE_OPACITY] || 1;\n  var tspan;\n  var i;\n  var ii;\n\n  for (i = 0, ii = items.length; i < ii; ++i) {\n    tspan = items[i].stroke;\n    tspan.setAttribute(KEY_STROKE, stroke);\n    tspan.setAttribute(KEY_STROKE_WIDTH, strokeWidth);\n    tspan.setAttribute(KEY_STROKE_OPACITY, strokeOpacity);\n    tspan.setAttribute(\"stroke-linejoin\", \"round\");\n  }\n}\n\nfunction baseAnimate(that, params, options, complete) {\n  options = options || {};\n  var key;\n  var value;\n  var renderer = that.renderer;\n  var settings = that._settings;\n  var animationParams = {};\n  var defaults = {\n    translateX: 0,\n    translateY: 0,\n    scaleX: 1,\n    scaleY: 1,\n    rotate: 0,\n    rotateX: 0,\n    rotateY: 0\n  };\n\n  if (complete) {\n    options.complete = complete;\n  }\n\n  if (renderer.animationEnabled()) {\n    for (key in params) {\n      value = params[key];\n\n      if (/^(translate(X|Y)|rotate[XY]?|scale(X|Y))$/i.test(key)) {\n        animationParams.transform = animationParams.transform || {\n          from: {},\n          to: {}\n        };\n        animationParams.transform.from[key] = key in settings ? Number(settings[key].toFixed(3)) : defaults[key];\n        animationParams.transform.to[key] = value;\n      } else {\n        if (\"arc\" === key || \"segments\" === key) {\n          animationParams[key] = value;\n        } else {\n          animationParams[key] = {\n            from: key in settings ? settings[key] : parseFloat(that.element.getAttribute(key) || 0),\n            to: value\n          };\n        }\n      }\n    }\n\n    renderer.animateElement(that, animationParams, extend(extend({}, renderer._animation), options));\n  } else {\n    options.step && options.step.call(that, 1, 1);\n    options.complete && options.complete.call(that);\n    that.attr(params);\n  }\n\n  return that;\n}\n\nfunction pathAnimate(params, options, complete) {\n  var that = this;\n  var curSegments = that.segments || [];\n  var newSegments;\n  var endSegments;\n\n  if (that.renderer.animationEnabled() && \"points\" in params) {\n    newSegments = buildPathSegments(params.points, that.type);\n    endSegments = compensateSegments(curSegments, newSegments, that.type);\n    params.segments = {\n      from: curSegments,\n      to: newSegments,\n      end: endSegments\n    };\n    delete params.points;\n  }\n\n  return baseAnimate(that, params, options, complete);\n}\n\nfunction arcAnimate(params, options, complete) {\n  var that = this;\n  var settings = that._settings;\n  var arcParams = {\n    from: {},\n    to: {}\n  };\n\n  if (that.renderer.animationEnabled() && (\"x\" in params || \"y\" in params || \"innerRadius\" in params || \"outerRadius\" in params || \"startAngle\" in params || \"endAngle\" in params)) {\n    arcParams.from.x = settings.x || 0;\n    arcParams.from.y = settings.y || 0;\n    arcParams.from.innerRadius = settings.innerRadius || 0;\n    arcParams.from.outerRadius = settings.outerRadius || 0;\n    arcParams.from.startAngle = settings.startAngle || 0;\n    arcParams.from.endAngle = settings.endAngle || 0;\n    arcParams.to.x = \"x\" in params ? params.x : settings.x;\n    delete params.x;\n    arcParams.to.y = \"y\" in params ? params.y : settings.y;\n    delete params.y;\n    arcParams.to.innerRadius = \"innerRadius\" in params ? params.innerRadius : settings.innerRadius;\n    delete params.innerRadius;\n    arcParams.to.outerRadius = \"outerRadius\" in params ? params.outerRadius : settings.outerRadius;\n    delete params.outerRadius;\n    arcParams.to.startAngle = \"startAngle\" in params ? params.startAngle : settings.startAngle;\n    delete params.startAngle;\n    arcParams.to.endAngle = \"endAngle\" in params ? params.endAngle : settings.endAngle;\n    delete params.endAngle;\n    params.arc = arcParams;\n  }\n\n  return baseAnimate(that, params, options, complete);\n}\n\nfunction buildLink(target, parameters) {\n  var obj = {\n    is: false,\n    name: parameters.name || parameters,\n    after: parameters.after\n  };\n\n  if (target) {\n    obj.to = target;\n  } else {\n    obj.virtual = true;\n  }\n\n  return obj;\n}\n\nfunction SvgElement(renderer, tagName, type) {\n  var that = this;\n  that.renderer = renderer;\n  that.element = createElement(tagName);\n  that._settings = {};\n  that._styles = {};\n\n  if (\"path\" === tagName) {\n    that.type = type || \"line\";\n  }\n}\n\nfunction removeFuncIriCallback(callback) {\n  fixFuncIriCallbacks.remove(callback);\n}\n\nexports.SvgElement = SvgElement;\nSvgElement.prototype = {\n  constructor: SvgElement,\n  _getJQElement: function _getJQElement() {\n    return this._$element || (this._$element = (0, _renderer2.default)(this.element));\n  },\n  _addFixIRICallback: function _addFixIRICallback() {\n    var that = this;\n\n    var fn = function fn() {\n      fixFuncIri(that, \"fill\");\n      fixFuncIri(that, \"clip-path\");\n      fixFuncIri(that, \"filter\");\n    };\n\n    that.element._fixFuncIri = fn;\n    fn.renderer = that.renderer;\n    fixFuncIriCallbacks.add(fn);\n\n    that._addFixIRICallback = function () {};\n  },\n  _clearChildrenFuncIri: function _clearChildrenFuncIri() {\n    var clearChildren = function clearChildren(element) {\n      var i;\n\n      for (i = 0; i < element.childNodes.length; i++) {\n        removeFuncIriCallback(element.childNodes[i]._fixFuncIri);\n        clearChildren(element.childNodes[i]);\n      }\n    };\n\n    clearChildren(this.element);\n  },\n  dispose: function dispose() {\n    removeFuncIriCallback(this.element._fixFuncIri);\n\n    this._clearChildrenFuncIri();\n\n    this._getJQElement().remove();\n\n    return this;\n  },\n  append: function append(parent) {\n    (parent || this.renderer.root).element.appendChild(this.element);\n    return this;\n  },\n  remove: function remove() {\n    var element = this.element;\n    element.parentNode && element.parentNode.removeChild(element);\n    return this;\n  },\n  enableLinks: function enableLinks() {\n    this._links = [];\n    return this;\n  },\n  virtualLink: function virtualLink(parameters) {\n    linkItem({\n      _link: buildLink(null, parameters)\n    }, this);\n    return this;\n  },\n  linkAfter: function linkAfter(name) {\n    this._linkAfter = name;\n    return this;\n  },\n  linkOn: function linkOn(target, parameters) {\n    this._link = buildLink(target, parameters);\n    linkItem(this, target);\n    return this;\n  },\n  linkOff: function linkOff() {\n    unlinkItem(this);\n    this._link = null;\n    return this;\n  },\n  linkAppend: function linkAppend() {\n    var link = this._link;\n    var items = link.to._links;\n    var i;\n    var next;\n\n    for (i = link.i + 1; (next = items[i]) && !next._link.is; ++i) {}\n\n    this._insert(link.to, next);\n\n    link.is = true;\n    return this;\n  },\n  _insert: function _insert(parent, next) {\n    parent.element.insertBefore(this.element, next ? next.element : null);\n  },\n  linkRemove: function linkRemove() {\n    this.remove();\n    this._link.is = false;\n    return this;\n  },\n  clear: function clear() {\n    this._clearChildrenFuncIri();\n\n    this._getJQElement().empty();\n\n    return this;\n  },\n  toBackground: function toBackground() {\n    var elem = this.element;\n    var parent = elem.parentNode;\n    parent && parent.insertBefore(elem, parent.firstChild);\n    return this;\n  },\n  toForeground: function toForeground() {\n    var elem = this.element;\n    var parent = elem.parentNode;\n    parent && parent.appendChild(elem);\n    return this;\n  },\n  attr: function attr(attrs) {\n    return baseAttr(this, attrs);\n  },\n  smartAttr: function smartAttr(attrs) {\n    return this.attr(processHatchingAttrs(this, attrs));\n  },\n  css: function css(styles) {\n    return baseCss(this, styles);\n  },\n  animate: function animate(params, options, complete) {\n    return baseAnimate(this, params, options, complete);\n  },\n  sharp: function sharp(pos, sharpDirection) {\n    return this.attr({\n      sharp: pos || true,\n      sharpDirection: sharpDirection\n    });\n  },\n  _applyTransformation: function _applyTransformation() {\n    var tr = this._settings;\n    var scaleXDefined;\n    var scaleYDefined;\n    var rotateX;\n    var rotateY;\n    var transformations = [];\n    var sharpMode = tr.sharp;\n    var trDirection = tr.sharpDirection || 1;\n    var strokeOdd = tr[KEY_STROKE_WIDTH] % 2;\n    var correctionX = strokeOdd && (\"h\" === sharpMode || true === sharpMode) ? SHARPING_CORRECTION * trDirection : 0;\n    var correctionY = strokeOdd && (\"v\" === sharpMode || true === sharpMode) ? SHARPING_CORRECTION * trDirection : 0;\n    transformations.push(\"translate(\" + ((tr.translateX || 0) + correctionX) + \",\" + ((tr.translateY || 0) + correctionY) + \")\");\n\n    if (tr.rotate) {\n      if (\"rotateX\" in tr) {\n        rotateX = tr.rotateX;\n      } else {\n        rotateX = tr.x;\n      }\n\n      if (\"rotateY\" in tr) {\n        rotateY = tr.rotateY;\n      } else {\n        rotateY = tr.y;\n      }\n\n      transformations.push(\"rotate(\" + tr.rotate + \",\" + (rotateX || 0) + \",\" + (rotateY || 0) + \")\");\n    }\n\n    scaleXDefined = (0, _type.isDefined)(tr.scaleX);\n    scaleYDefined = (0, _type.isDefined)(tr.scaleY);\n\n    if (scaleXDefined || scaleYDefined) {\n      transformations.push(\"scale(\" + (scaleXDefined ? tr.scaleX : 1) + \",\" + (scaleYDefined ? tr.scaleY : 1) + \")\");\n    }\n\n    if (transformations.length) {\n      this.element.setAttribute(\"transform\", transformations.join(\" \"));\n    }\n  },\n  move: function move(x, y, animate, animOptions) {\n    var obj = {};\n    (0, _type.isDefined)(x) && (obj.translateX = x);\n    (0, _type.isDefined)(y) && (obj.translateY = y);\n\n    if (!animate) {\n      this.attr(obj);\n    } else {\n      this.animate(obj, animOptions);\n    }\n\n    return this;\n  },\n  rotate: function rotate(angle, x, y, animate, animOptions) {\n    var obj = {\n      rotate: angle || 0\n    };\n    (0, _type.isDefined)(x) && (obj.rotateX = x);\n    (0, _type.isDefined)(y) && (obj.rotateY = y);\n\n    if (!animate) {\n      this.attr(obj);\n    } else {\n      this.animate(obj, animOptions);\n    }\n\n    return this;\n  },\n  _getElementBBox: function _getElementBBox() {\n    var elem = this.element;\n    var bBox;\n\n    try {\n      bBox = elem.getBBox && elem.getBBox();\n    } catch (e) {}\n\n    return bBox || {\n      x: 0,\n      y: 0,\n      width: elem.offsetWidth || 0,\n      height: elem.offsetHeight || 0\n    };\n  },\n  getBBox: function getBBox() {\n    var transformation = this._settings;\n\n    var bBox = this._getElementBBox();\n\n    if (transformation.rotate) {\n      bBox = (0, _utils.rotateBBox)(bBox, [(\"rotateX\" in transformation ? transformation.rotateX : transformation.x) || 0, (\"rotateY\" in transformation ? transformation.rotateY : transformation.y) || 0], -transformation.rotate);\n    } else {\n      bBox = (0, _utils.normalizeBBox)(bBox);\n    }\n\n    return bBox;\n  },\n  markup: function markup() {\n    return (0, _svg.getSvgMarkup)(this.element);\n  },\n  getOffset: function getOffset() {\n    return this._getJQElement().offset();\n  },\n  stopAnimation: function stopAnimation(disableComplete) {\n    var animation = this.animation;\n    animation && animation.stop(disableComplete);\n    return this;\n  },\n  setTitle: function setTitle(text) {\n    var titleElem = createElement(\"title\");\n    titleElem.textContent = text || \"\";\n    this.element.appendChild(titleElem);\n  },\n  data: function data(obj, val) {\n    var elem = this.element;\n    var key;\n\n    if (void 0 !== val) {\n      elem[obj] = val;\n    } else {\n      for (key in obj) {\n        elem[key] = obj[key];\n      }\n    }\n\n    return this;\n  },\n  on: function on() {\n    var args = [this._getJQElement()];\n    args.push.apply(args, arguments);\n\n    _events_engine2.default.on.apply(_events_engine2.default, args);\n\n    return this;\n  },\n  off: function off() {\n    var args = [this._getJQElement()];\n    args.push.apply(args, arguments);\n\n    _events_engine2.default.off.apply(_events_engine2.default, args);\n\n    return this;\n  },\n  trigger: function trigger() {\n    var args = [this._getJQElement()];\n    args.push.apply(args, arguments);\n\n    _events_engine2.default.trigger.apply(_events_engine2.default, args);\n\n    return this;\n  }\n};\n\nfunction PathSvgElement(renderer, type) {\n  SvgElement.call(this, renderer, \"path\", type);\n}\n\nexports.PathSvgElement = PathSvgElement;\nPathSvgElement.prototype = objectCreate(SvgElement.prototype);\nextend(PathSvgElement.prototype, {\n  constructor: PathSvgElement,\n  attr: pathAttr,\n  animate: pathAnimate\n});\n\nfunction ArcSvgElement(renderer) {\n  SvgElement.call(this, renderer, \"path\", \"arc\");\n}\n\nexports.ArcSvgElement = ArcSvgElement;\nArcSvgElement.prototype = objectCreate(SvgElement.prototype);\nextend(ArcSvgElement.prototype, {\n  constructor: ArcSvgElement,\n  attr: arcAttr,\n  animate: arcAnimate\n});\n\nfunction RectSvgElement(renderer) {\n  SvgElement.call(this, renderer, \"rect\");\n}\n\nexports.RectSvgElement = RectSvgElement;\nRectSvgElement.prototype = objectCreate(SvgElement.prototype);\nextend(RectSvgElement.prototype, {\n  constructor: RectSvgElement,\n  attr: rectAttr\n});\n\nfunction TextSvgElement(renderer) {\n  SvgElement.call(this, renderer, \"text\");\n  this.css({\n    \"white-space\": \"pre\"\n  });\n}\n\nexports.TextSvgElement = TextSvgElement;\nTextSvgElement.prototype = objectCreate(SvgElement.prototype);\nextend(TextSvgElement.prototype, {\n  constructor: TextSvgElement,\n  attr: textAttr,\n  css: textCss,\n  applyEllipsis: applyEllipsis,\n  setMaxSize: setMaxSize,\n  restoreText: restoreText,\n  _getLineHeight: function _getLineHeight() {\n    return !isNaN(parseFloat(this._styles[KEY_FONT_SIZE])) ? this._styles[KEY_FONT_SIZE] : DEFAULT_FONT_SIZE;\n  }\n});\n\nfunction updateIndexes(items, k) {\n  var i;\n  var item;\n\n  for (i = k; item = items[i]; ++i) {\n    item._link.i = i;\n  }\n}\n\nfunction linkItem(target, container) {\n  var items = container._links;\n  var key = target._link.after = target._link.after || container._linkAfter;\n  var i;\n  var item;\n\n  if (key) {\n    for (i = 0; (item = items[i]) && item._link.name !== key; ++i) {}\n\n    if (item) {\n      for (++i; (item = items[i]) && item._link.after === key; ++i) {}\n    }\n  } else {\n    i = items.length;\n  }\n\n  items.splice(i, 0, target);\n  updateIndexes(items, i);\n}\n\nfunction unlinkItem(target) {\n  var i;\n  var items = target._link.to._links;\n\n  for (i = 0; items[i] !== target; ++i) {}\n\n  items.splice(i, 1);\n  updateIndexes(items, i);\n}\n\nfunction Renderer(options) {\n  var that = this;\n  that.root = that._createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    fill: NONE,\n    stroke: NONE,\n    \"stroke-width\": 0\n  }).attr({\n    \"class\": options.cssClass\n  }).css({\n    \"line-height\": \"normal\",\n    \"-ms-user-select\": NONE,\n    \"-moz-user-select\": NONE,\n    \"-webkit-user-select\": NONE,\n    \"-webkit-tap-highlight-color\": \"rgba(0, 0, 0, 0)\",\n    display: \"block\",\n    overflow: \"hidden\"\n  });\n\n  that._init();\n\n  that.pathModified = !!options.pathModified;\n  that._$container = (0, _renderer2.default)(options.container);\n  that.root.append({\n    element: options.container\n  });\n  that.fixPlacement();\n  that._locker = 0;\n  that._backed = false;\n}\n\nexports.Renderer = Renderer;\nRenderer.prototype = {\n  constructor: Renderer,\n  _init: function _init() {\n    var that = this;\n    that._defs = that._createElement(\"defs\").append(that.root);\n    that._animationController = new _animation2.default.AnimationController(that.root.element);\n    that._animation = {\n      enabled: true,\n      duration: 1e3,\n      easing: \"easeOutCubic\"\n    };\n  },\n  fixPlacement: function fixPlacement() {\n    if (!_browser2.default.mozilla && !_browser2.default.msie) {\n      return;\n    }\n\n    var box = getBoundingClientRect(this._$container.get(0));\n    var dx = roundValue(box.left % 1, 2);\n    var dy = roundValue(box.top % 1, 2);\n\n    if (_browser2.default.msie) {\n      this.root.css({\n        transform: \"translate(\" + -dx + \"px,\" + -dy + \"px)\"\n      });\n    } else {\n      if (_browser2.default.mozilla) {\n        this.root.move(-dx, -dy);\n      }\n    }\n  },\n  removePlacementFix: function removePlacementFix() {\n    if (!_browser2.default.mozilla && !_browser2.default.msie) {\n      return;\n    }\n\n    if (_browser2.default.msie) {\n      this.root.css({\n        transform: \"\"\n      });\n    } else {\n      if (_browser2.default.mozilla) {\n        this.root.attr({\n          transform: null\n        });\n      }\n    }\n  },\n  setOptions: function setOptions(options) {\n    var that = this;\n    that.rtl = !!options.rtl;\n    that.encodeHtml = !!options.encodeHtml;\n    that.updateAnimationOptions(options.animation || {});\n    that.root.attr({\n      direction: that.rtl ? \"rtl\" : \"ltr\"\n    });\n    return that;\n  },\n  _createElement: function _createElement(tagName, attr, type) {\n    var elem = new exports.SvgElement(this, tagName, type);\n    attr && elem.attr(attr);\n    return elem;\n  },\n  lock: function lock() {\n    var that = this;\n\n    if (0 === that._locker) {\n      that._backed = !that._$container.is(\":visible\");\n\n      if (that._backed) {\n        backupRoot(that.root);\n      }\n    }\n\n    ++that._locker;\n    return that;\n  },\n  unlock: function unlock() {\n    var that = this;\n    --that._locker;\n\n    if (0 === that._locker) {\n      if (that._backed) {\n        restoreRoot(that.root, that._$container[0]);\n        that.fixPlacement();\n      }\n\n      that._backed = false;\n    }\n\n    return that;\n  },\n  resize: function resize(width, height) {\n    if (width >= 0 && height >= 0) {\n      this.root.attr({\n        width: width,\n        height: height\n      });\n    }\n\n    return this;\n  },\n  dispose: function dispose() {\n    var that = this;\n    var key;\n    that.root.dispose();\n\n    that._defs.dispose();\n\n    that._animationController.dispose();\n\n    fixFuncIriCallbacks.removeByRenderer(that);\n\n    for (key in that) {\n      that[key] = null;\n    }\n\n    return that;\n  },\n  animationEnabled: function animationEnabled() {\n    return !!this._animation.enabled;\n  },\n  updateAnimationOptions: function updateAnimationOptions(newOptions) {\n    extend(this._animation, newOptions);\n    return this;\n  },\n  stopAllAnimations: function stopAllAnimations(lock) {\n    this._animationController[lock ? \"lock\" : \"stop\"]();\n\n    return this;\n  },\n  animateElement: function animateElement(element, params, options) {\n    this._animationController.animateElement(element, params, options);\n\n    return this;\n  },\n  svg: function svg() {\n    this.removePlacementFix();\n    var markup = this.root.markup();\n    this.fixPlacement();\n    return markup;\n  },\n  getRootOffset: function getRootOffset() {\n    return this.root.getOffset();\n  },\n  onEndAnimation: function onEndAnimation(endAnimation) {\n    this._animationController.onEndAnimation(endAnimation);\n  },\n  rect: function rect(x, y, width, height) {\n    var elem = new exports.RectSvgElement(this);\n    return elem.attr({\n      x: x || 0,\n      y: y || 0,\n      width: width || 0,\n      height: height || 0\n    });\n  },\n  simpleRect: function simpleRect() {\n    return this._createElement(\"rect\");\n  },\n  circle: function circle(x, y, r) {\n    return this._createElement(\"circle\", {\n      cx: x || 0,\n      cy: y || 0,\n      r: r || 0\n    });\n  },\n  g: function g() {\n    return this._createElement(\"g\");\n  },\n  image: function image(x, y, w, h, href, location) {\n    var image = this._createElement(\"image\", {\n      x: x || 0,\n      y: y || 0,\n      width: w || 0,\n      height: h || 0,\n      preserveAspectRatio: preserveAspectRatioMap[(0, _utils.normalizeEnum)(location)] || NONE\n    });\n\n    image.element.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", href || \"\");\n    return image;\n  },\n  path: function path(points, type) {\n    var elem = new exports.PathSvgElement(this, type);\n    return elem.attr({\n      points: points || []\n    });\n  },\n  arc: function arc(x, y, innerRadius, outerRadius, startAngle, endAngle) {\n    var elem = new exports.ArcSvgElement(this);\n    return elem.attr({\n      x: x || 0,\n      y: y || 0,\n      innerRadius: innerRadius || 0,\n      outerRadius: outerRadius || 0,\n      startAngle: startAngle || 0,\n      endAngle: endAngle || 0\n    });\n  },\n  text: function text(_text, x, y) {\n    var elem = new exports.TextSvgElement(this);\n    return elem.attr({\n      text: _text,\n      x: x || 0,\n      y: y || 0\n    });\n  },\n  linearGradient: function linearGradient(stops) {\n    var gradient;\n    var id = getNextDefsSvgId();\n    var that = this;\n    gradient = that._createElement(\"linearGradient\", {\n      id: id\n    }).append(that._defs);\n    gradient.id = id;\n    stops.forEach(function (stop) {\n      that._createElement(\"stop\", {\n        offset: stop.offset,\n        \"stop-color\": stop[\"stop-color\"]\n      }).append(gradient);\n    });\n    return gradient;\n  },\n  pattern: function pattern(color, hatching, _id) {\n    hatching = hatching || {};\n    var that = this;\n    var id;\n    var d;\n    var pattern;\n    var rect;\n    var path;\n    var step = hatching.step || 6;\n    var stepTo2 = step / 2;\n    var stepBy15 = 1.5 * step;\n    id = _id || getNextDefsSvgId();\n    d = \"right\" === (0, _utils.normalizeEnum)(hatching.direction) ? \"M \" + stepTo2 + \" \" + -stepTo2 + \" L \" + -stepTo2 + \" \" + stepTo2 + \" M 0 \" + step + \" L \" + step + \" 0 M \" + stepBy15 + \" \" + stepTo2 + \" L \" + stepTo2 + \" \" + stepBy15 : \"M 0 0 L \" + step + \" \" + step + \" M \" + -stepTo2 + \" \" + stepTo2 + \" L \" + stepTo2 + \" \" + stepBy15 + \" M \" + stepTo2 + \" \" + -stepTo2 + \" L \" + stepBy15 + \" \" + stepTo2;\n    pattern = that._createElement(\"pattern\", {\n      id: id,\n      width: step,\n      height: step,\n      patternUnits: \"userSpaceOnUse\"\n    }).append(that._defs);\n    pattern.id = id;\n    rect = that.rect(0, 0, step, step).attr({\n      fill: color,\n      opacity: hatching.opacity\n    }).append(pattern);\n    path = new exports.PathSvgElement(this).attr({\n      d: d,\n      \"stroke-width\": hatching.width || 1,\n      stroke: color\n    }).append(pattern);\n    return pattern;\n  },\n  _getPointsWithYOffset: function _getPointsWithYOffset(points, offset) {\n    return points.map(function (point, index) {\n      if (index % 2 !== 0) {\n        return point + offset;\n      }\n\n      return point;\n    });\n  },\n  clipShape: function clipShape(method, methodArgs) {\n    var that = this;\n    var id = getNextDefsSvgId();\n\n    var clipPath = that._createElement(\"clipPath\", {\n      id: id\n    }).append(that._defs);\n\n    var shape = method.apply(that, methodArgs).append(clipPath);\n    shape.id = id;\n\n    shape.remove = function () {\n      throw \"Not implemented\";\n    };\n\n    shape.dispose = function () {\n      clipPath.dispose();\n      clipPath = null;\n      return this;\n    };\n\n    return shape;\n  },\n  clipRect: function clipRect(x, y, width, height) {\n    return this.clipShape(this.rect, arguments);\n  },\n  clipCircle: function clipCircle(x, y, radius) {\n    return this.clipShape(this.circle, arguments);\n  },\n  shadowFilter: function shadowFilter(x, y, width, height, offsetX, offsetY, blur, color, opacity) {\n    var that = this;\n    var id = getNextDefsSvgId();\n\n    var filter = that._createElement(\"filter\", {\n      id: id,\n      x: x || 0,\n      y: y || 0,\n      width: width || 0,\n      height: height || 0\n    }).append(that._defs);\n\n    var gaussianBlur = that._createElement(\"feGaussianBlur\", {\n      \"in\": \"SourceGraphic\",\n      result: \"gaussianBlurResult\",\n      stdDeviation: blur || 0\n    }).append(filter);\n\n    var offset = that._createElement(\"feOffset\", {\n      \"in\": \"gaussianBlurResult\",\n      result: \"offsetResult\",\n      dx: offsetX || 0,\n      dy: offsetY || 0\n    }).append(filter);\n\n    var flood = that._createElement(\"feFlood\", {\n      result: \"floodResult\",\n      \"flood-color\": color || \"\",\n      \"flood-opacity\": opacity\n    }).append(filter);\n\n    var composite = that._createElement(\"feComposite\", {\n      \"in\": \"floodResult\",\n      in2: \"offsetResult\",\n      operator: \"in\",\n      result: \"compositeResult\"\n    }).append(filter);\n\n    var finalComposite = that._createElement(\"feComposite\", {\n      \"in\": \"SourceGraphic\",\n      in2: \"compositeResult\",\n      operator: \"over\"\n    }).append(filter);\n\n    filter.id = id;\n    filter.gaussianBlur = gaussianBlur;\n    filter.offset = offset;\n    filter.flood = flood;\n    filter.composite = composite;\n    filter.finalComposite = finalComposite;\n\n    filter.attr = function (attrs) {\n      var that = this;\n      var filterAttrs = {};\n      var offsetAttrs = {};\n      var floodAttrs = {};\n      \"x\" in attrs && (filterAttrs.x = attrs.x);\n      \"y\" in attrs && (filterAttrs.y = attrs.y);\n      \"width\" in attrs && (filterAttrs.width = attrs.width);\n      \"height\" in attrs && (filterAttrs.height = attrs.height);\n      baseAttr(that, filterAttrs);\n      \"blur\" in attrs && that.gaussianBlur.attr({\n        stdDeviation: attrs.blur\n      });\n      \"offsetX\" in attrs && (offsetAttrs.dx = attrs.offsetX);\n      \"offsetY\" in attrs && (offsetAttrs.dy = attrs.offsetY);\n      that.offset.attr(offsetAttrs);\n      \"color\" in attrs && (floodAttrs[\"flood-color\"] = attrs.color);\n      \"opacity\" in attrs && (floodAttrs[\"flood-opacity\"] = attrs.opacity);\n      that.flood.attr(floodAttrs);\n      return that;\n    };\n\n    return filter;\n  },\n  brightFilter: function brightFilter(type, slope) {\n    var that = this;\n    var id = getNextDefsSvgId();\n\n    var filter = that._createElement(\"filter\", {\n      id: id\n    }).append(that._defs);\n\n    var componentTransferElement = that._createElement(\"feComponentTransfer\").append(filter);\n\n    var attrs = {\n      type: type,\n      slope: slope\n    };\n    filter.id = id;\n\n    that._createElement(\"feFuncR\", attrs).append(componentTransferElement);\n\n    that._createElement(\"feFuncG\", attrs).append(componentTransferElement);\n\n    that._createElement(\"feFuncB\", attrs).append(componentTransferElement);\n\n    return filter;\n  },\n  getGrayScaleFilter: function getGrayScaleFilter() {\n    if (this._grayScaleFilter) {\n      return this._grayScaleFilter;\n    }\n\n    var that = this;\n    var id = getNextDefsSvgId();\n\n    var filter = that._createElement(\"filter\", {\n      id: id\n    }).append(that._defs);\n\n    that._createElement(\"feColorMatrix\").attr({\n      type: \"matrix\",\n      values: \"0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 0.6 0\"\n    }).append(filter);\n\n    filter.id = id;\n    that._grayScaleFilter = filter;\n    return filter;\n  },\n  initHatching: function initHatching() {\n    var storage = this._hatchingStorage = this._hatchingStorage || {\n      byHash: {},\n      baseId: getNextDefsSvgId()\n    };\n    var byHash = storage.byHash;\n    var name;\n\n    for (name in byHash) {\n      byHash[name].pattern.dispose();\n    }\n\n    storage.byHash = {};\n    storage.refToHash = {};\n    storage.nextId = 0;\n  },\n  lockHatching: function lockHatching(color, hatching, ref) {\n    var storage = this._hatchingStorage;\n    var hash = getHatchingHash(color, hatching);\n    var storageItem;\n    var pattern;\n\n    if (storage.refToHash[ref] !== hash) {\n      if (ref) {\n        this.releaseHatching(ref);\n      }\n\n      storageItem = storage.byHash[hash];\n\n      if (!storageItem) {\n        pattern = this.pattern(color, hatching, storage.baseId + \"-hatching-\" + storage.nextId++);\n        storageItem = storage.byHash[hash] = {\n          pattern: pattern,\n          count: 0\n        };\n        storage.refToHash[pattern.id] = hash;\n      }\n\n      ++storageItem.count;\n      ref = storageItem.pattern.id;\n    }\n\n    return ref;\n  },\n  releaseHatching: function releaseHatching(ref) {\n    var storage = this._hatchingStorage;\n    var hash = storage.refToHash[ref];\n    var storageItem = storage.byHash[hash];\n\n    if (storageItem && 0 === --storageItem.count) {\n      storageItem.pattern.dispose();\n      delete storage.byHash[hash];\n      delete storage.refToHash[ref];\n    }\n  }\n};\n\nfunction getHatchingHash(color, hatching) {\n  return \"@\" + color + \"::\" + hatching.step + \":\" + hatching.width + \":\" + hatching.opacity + \":\" + hatching.direction;\n}\n\nvar fixFuncIriCallbacks = function () {\n  var callbacks = [];\n  return {\n    add: function add(fn) {\n      callbacks.push(fn);\n    },\n    remove: function remove(fn) {\n      callbacks = callbacks.filter(function (el) {\n        return el !== fn;\n      });\n    },\n    removeByRenderer: function removeByRenderer(renderer) {\n      callbacks = callbacks.filter(function (el) {\n        return el.renderer !== renderer;\n      });\n    },\n    fire: function fire() {\n      callbacks.forEach(function (fn) {\n        fn();\n      });\n    }\n  };\n}();\n\nexports.refreshPaths = function () {\n  fixFuncIriCallbacks.fire();\n};","map":{"version":3,"sources":["C:/Users/va112/Documents/Webdev/React/Corona/node_modules/devextreme/viz/core/renderers/renderer.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_dom_adapter","_dom_adapter2","_window","_window2","_call_once","_call_once2","_events_engine","_events_engine2","_browser","_browser2","_svg","_animation","_animation2","_utils","_type","obj","__esModule","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","len","length","arr2","Symbol","iterator","_arr","_n","_d","_e","_s","_i","next","done","push","value","err","return","isArray","window","default","getWindow","max","Math","min","floor","round","sin","cos","abs","PI","PI_DIV_180","SHARPING_CORRECTION","ARC_COORD_PREC","pxAddingExceptions","opacity","order","orphans","widows","zoom","KEY_TEXT","KEY_STROKE","KEY_STROKE_WIDTH","KEY_STROKE_OPACITY","KEY_FONT_SIZE","KEY_FONT_STYLE","KEY_FONT_WEIGHT","KEY_TEXT_DECORATION","KEY_TEXTS_ALIGNMENT","NONE","DEFAULT_FONT_SIZE","ELLIPSIS","objectCreate","create","proto","F","DEFAULTS","scaleX","scaleY","getBackup","backupContainer","createElement","backupCounter","style","left","position","backupRoot","root","getBody","appendChild","append","element","restoreRoot","container","removeChild","getNextDefsSvgId","numDefsSvgElements","isObjectArgument","tagName","createElementNS","getFuncIri","id","pathModified","location","href","split","module","exports","extend","target","source","key","roundValue","exp","getBoundingClientRect","box","e","top","preserveAspectRatioMap","full","lefttop","leftcenter","leftbottom","centertop","center","centerbottom","righttop","rightcenter","rightbottom","processHatchingAttrs","attrs","hatching","normalizeEnum","direction","fill","_hatching","renderer","lockHatching","releaseHatching","normalizeArcParams","x","y","innerR","outerR","startAngle","endAngle","isCircle","noArc","angleDiff","buildArcPath","startAngleCos","startAngleSin","endAngleCos","endAngleSin","longFlag","toFixed","join","buildPathSegments","points","type","list","buildLineSegments","buildCurveSegments","close","buildSegments","buildSimpleLineSegment","buildSimpleCurveSegment","buildSimpleSegment","ii","k0","k","combinePathParam","segments","d","segment","j","jj","compensateSegments","oldSegments","newSegments","oldLength","newLength","originalNewSegments","makeEqualSegments","indexOf","makeEqualAreaSegments","makeEqualLineSegments","prepareConstSegment","constSeg","short","long","head","shortLength","longLength","constsSeg1","constsSeg2","splice","baseCss","that","styles","elemStyles","_styles","str","isDefined","setAttribute","fixFuncIri","wrapper","attribute","attr","removeAttribute","baseAttr","settings","_settings","attributes","elem","rtl","hasTransformations","recalculateDashStyle","sw","right","_addFixIRICallback","dashStyle","_originalSW","replace","parseInt","_applyTransformation","pathAttr","arcAttr","innerRadius","outerRadius","apply","rectAttr","width","height","maxSW","newSW","_originalX","_originalY","_originalWidth","_originalHeight","sharp","textAttr","isResetRequired","wasStroked","isStroked","alignTextNodes","createTextNodes","text","_hasEllipsis","locateTextNodes","strokeTextNodes","textCss","orderHtmlTree","line","node","parentStyle","parentClassName","realStyle","nodes","wholeText","className","isElementNode","color","fontSize","fontStyle","fontWeight","textDecoration","childNodes","adjustLineHeights","items","currentItem","item","maxLengthFontSize","inherits","parseFloat","NaN","removeExtraAttrs","html","findTagAttrs","findStyleAndClassAttrs","allTagAttrs","p1","p2","p3","match","map","parseHTML","div","innerHTML","parseMultiline","texts","trim","createTspans","fieldName","createTextNode","restoreText","applyEllipsis","maxWidth","lines","hasEllipsis","lineParts","ellipsis","ellipsisWidth","getBBox","_getElementBBox","prepareLines","_texts","parts","commonLength","endIndex","setNewText","startBox","removeTextSpan","remove","cloneAndRemoveAttrs","clone","cloneNode","detachAndStoreTitleElements","titleElements","querySelectorAll","setMaxSize","maxHeight","options","arguments","textChanged","textIsEmpty","ellipsisMaxWidth","restoreTitleElement","_that$_getElementBBox","applyOverflowRules","setMaxHeight","_getLineHeight","reduce","concat","filter","t","stroke","tspan","parentNode","textContent","rowCount","getIndexForEllipsis","endBox","kk","getSubStringLength","getTextWidth","getSpaceBreakIndex","initialIndices","spaceIndices","indices","char","index","spaceIndex","getWordBreakIndex","getEllipsisString","_ref","hideOverflowEllipsis","setEllipsis","wordWrap","breakIndex","restLines","restText","isFinite","newTextOffset","restString","restTspan","textOverflow","calculateLineHeight","lineHeight","getItemLineHeight","Number","result","_ref2","l","_ref3","commonHeight","forEach","prevLine","textValue","_ref4","_ref5","stop","lineNumber","wordWrapLines","insertString","newText","substr","parsedHtml","clear","encodeHtml","setTextNodeAttribute","defaultValue","alignment","maxTextWidth","textWidth","fontSize1","fontSize2","parsedHeight1","parsedHeight2","height1","height2","isNaN","strokeWidth","strokeOpacity","baseAnimate","params","complete","animationParams","defaults","translateX","translateY","rotate","rotateX","rotateY","animationEnabled","transform","to","getAttribute","animateElement","step","pathAnimate","curSegments","endSegments","end","arcAnimate","arcParams","arc","buildLink","parameters","is","after","virtual","SvgElement","removeFuncIriCallback","callback","fixFuncIriCallbacks","_getJQElement","_$element","fn","_fixFuncIri","add","_clearChildrenFuncIri","clearChildren","dispose","parent","enableLinks","_links","virtualLink","linkItem","_link","linkAfter","_linkAfter","linkOn","linkOff","unlinkItem","linkAppend","link","_insert","insertBefore","linkRemove","empty","toBackground","firstChild","toForeground","smartAttr","css","animate","pos","sharpDirection","tr","scaleXDefined","scaleYDefined","transformations","sharpMode","trDirection","strokeOdd","correctionX","correctionY","move","animOptions","angle","bBox","offsetWidth","offsetHeight","transformation","rotateBBox","normalizeBBox","markup","getSvgMarkup","getOffset","offset","stopAnimation","disableComplete","animation","setTitle","titleElem","data","val","on","args","off","trigger","PathSvgElement","ArcSvgElement","RectSvgElement","TextSvgElement","updateIndexes","Renderer","_createElement","xmlns","version","cssClass","display","overflow","_init","_$container","fixPlacement","_locker","_backed","_defs","_animationController","AnimationController","enabled","duration","easing","mozilla","msie","get","dx","dy","removePlacementFix","setOptions","updateAnimationOptions","lock","unlock","resize","removeByRenderer","newOptions","stopAllAnimations","svg","getRootOffset","onEndAnimation","endAnimation","rect","simpleRect","circle","r","cx","cy","g","image","w","h","preserveAspectRatio","setAttributeNS","path","_text","linearGradient","stops","gradient","pattern","_id","stepTo2","stepBy15","patternUnits","_getPointsWithYOffset","point","clipShape","method","methodArgs","clipPath","shape","clipRect","clipCircle","radius","shadowFilter","offsetX","offsetY","blur","gaussianBlur","stdDeviation","flood","composite","in2","operator","finalComposite","filterAttrs","offsetAttrs","floodAttrs","brightFilter","slope","componentTransferElement","getGrayScaleFilter","_grayScaleFilter","values","initHatching","storage","_hatchingStorage","byHash","baseId","refToHash","nextId","ref","hash","getHatchingHash","storageItem","count","callbacks","el","fire","refreshPaths"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/core/renderers/renderer.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _dom_adapter = require(\"../../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _window = require(\"../../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\nvar _call_once = require(\"../../../core/utils/call_once\");\r\nvar _call_once2 = _interopRequireDefault(_call_once);\r\nvar _events_engine = require(\"../../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _browser = require(\"../../../core/utils/browser\");\r\nvar _browser2 = _interopRequireDefault(_browser);\r\nvar _svg = require(\"../../../core/utils/svg\");\r\nvar _animation = require(\"./animation\");\r\nvar _animation2 = _interopRequireDefault(_animation);\r\nvar _utils = require(\"../utils\");\r\nvar _type = require(\"../../../core/utils/type\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _slicedToArray(arr, i) {\r\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest()\r\n}\r\n\r\nfunction _nonIterableRest() {\r\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")\r\n}\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) {\r\n    if (!o) {\r\n        return\r\n    }\r\n    if (\"string\" === typeof o) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n    var n = Object.prototype.toString.call(o).slice(8, -1);\r\n    if (\"Object\" === n && o.constructor) {\r\n        n = o.constructor.name\r\n    }\r\n    if (\"Map\" === n || \"Set\" === n) {\r\n        return Array.from(n)\r\n    }\r\n    if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n}\r\n\r\nfunction _arrayLikeToArray(arr, len) {\r\n    if (null == len || len > arr.length) {\r\n        len = arr.length\r\n    }\r\n    for (var i = 0, arr2 = new Array(len); i < len; i++) {\r\n        arr2[i] = arr[i]\r\n    }\r\n    return arr2\r\n}\r\n\r\nfunction _iterableToArrayLimit(arr, i) {\r\n    if (\"undefined\" === typeof Symbol || !(Symbol.iterator in Object(arr))) {\r\n        return\r\n    }\r\n    var _arr = [];\r\n    var _n = true;\r\n    var _d = false;\r\n    var _e = void 0;\r\n    try {\r\n        for (var _s, _i = arr[Symbol.iterator](); !(_n = (_s = _i.next()).done); _n = true) {\r\n            _arr.push(_s.value);\r\n            if (i && _arr.length === i) {\r\n                break\r\n            }\r\n        }\r\n    } catch (err) {\r\n        _d = true;\r\n        _e = err\r\n    } finally {\r\n        try {\r\n            if (!_n && null != _i.return) {\r\n                _i.return()\r\n            }\r\n        } finally {\r\n            if (_d) {\r\n                throw _e\r\n            }\r\n        }\r\n    }\r\n    return _arr\r\n}\r\n\r\nfunction _arrayWithHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        return arr\r\n    }\r\n}\r\nvar window = _window2.default.getWindow();\r\nvar max = Math.max,\r\n    min = Math.min,\r\n    floor = Math.floor,\r\n    round = Math.round,\r\n    sin = Math.sin,\r\n    cos = Math.cos,\r\n    abs = Math.abs,\r\n    PI = Math.PI;\r\nvar PI_DIV_180 = PI / 180;\r\nvar SHARPING_CORRECTION = .5;\r\nvar ARC_COORD_PREC = 5;\r\nvar pxAddingExceptions = {\r\n    \"column-count\": true,\r\n    \"fill-opacity\": true,\r\n    \"flex-grow\": true,\r\n    \"flex-shrink\": true,\r\n    \"font-weight\": true,\r\n    \"line-height\": true,\r\n    opacity: true,\r\n    order: true,\r\n    orphans: true,\r\n    widows: true,\r\n    \"z-index\": true,\r\n    zoom: true\r\n};\r\nvar KEY_TEXT = \"text\";\r\nvar KEY_STROKE = \"stroke\";\r\nvar KEY_STROKE_WIDTH = \"stroke-width\";\r\nvar KEY_STROKE_OPACITY = \"stroke-opacity\";\r\nvar KEY_FONT_SIZE = \"font-size\";\r\nvar KEY_FONT_STYLE = \"font-style\";\r\nvar KEY_FONT_WEIGHT = \"font-weight\";\r\nvar KEY_TEXT_DECORATION = \"text-decoration\";\r\nvar KEY_TEXTS_ALIGNMENT = \"textsAlignment\";\r\nvar NONE = \"none\";\r\nvar DEFAULT_FONT_SIZE = 12;\r\nvar ELLIPSIS = \"...\";\r\nvar objectCreate = function() {\r\n    if (!Object.create) {\r\n        return function(proto) {\r\n            var F = function() {};\r\n            F.prototype = proto;\r\n            return new F\r\n        }\r\n    } else {\r\n        return function(proto) {\r\n            return Object.create(proto)\r\n        }\r\n    }\r\n}();\r\nvar DEFAULTS = {\r\n    scaleX: 1,\r\n    scaleY: 1,\r\n    \"pointer-events\": null\r\n};\r\nvar getBackup = (0, _call_once2.default)(function() {\r\n    var backupContainer = _dom_adapter2.default.createElement(\"div\");\r\n    var backupCounter = 0;\r\n    backupContainer.style.left = \"-9999px\";\r\n    backupContainer.style.position = \"absolute\";\r\n    return {\r\n        backupContainer: backupContainer,\r\n        backupCounter: backupCounter\r\n    }\r\n});\r\n\r\nfunction backupRoot(root) {\r\n    if (0 === getBackup().backupCounter) {\r\n        _dom_adapter2.default.getBody().appendChild(getBackup().backupContainer)\r\n    }++getBackup().backupCounter;\r\n    root.append({\r\n        element: getBackup().backupContainer\r\n    })\r\n}\r\n\r\nfunction restoreRoot(root, container) {\r\n    root.append({\r\n        element: container\r\n    });\r\n    --getBackup().backupCounter;\r\n    if (0 === getBackup().backupCounter) {\r\n        _dom_adapter2.default.getBody().removeChild(getBackup().backupContainer)\r\n    }\r\n}\r\nvar getNextDefsSvgId = function() {\r\n    var numDefsSvgElements = 1;\r\n    return function() {\r\n        return \"DevExpress_\" + numDefsSvgElements++\r\n    }\r\n}();\r\n\r\nfunction isObjectArgument(value) {\r\n    return value && \"string\" !== typeof value\r\n}\r\n\r\nfunction createElement(tagName) {\r\n    return _dom_adapter2.default.createElementNS(\"http://www.w3.org/2000/svg\", tagName)\r\n}\r\n\r\nfunction getFuncIri(id, pathModified) {\r\n    return null !== id ? \"url(\" + (pathModified ? window.location.href.split(\"#\")[0] : \"\") + \"#\" + id + \")\" : id\r\n}\r\nmodule.exports.getFuncIri = getFuncIri;\r\n\r\nfunction extend(target, source) {\r\n    var key;\r\n    for (key in source) {\r\n        target[key] = source[key]\r\n    }\r\n    return target\r\n}\r\n\r\nfunction roundValue(value, exp) {\r\n    value = value.toString().split(\"e\");\r\n    value = round(+(value[0] + \"e\" + (value[1] ? +value[1] + exp : exp)));\r\n    value = value.toString().split(\"e\");\r\n    return +(value[0] + \"e\" + (value[1] ? +value[1] - exp : -exp))\r\n}\r\n\r\nfunction getBoundingClientRect(element) {\r\n    var box;\r\n    try {\r\n        box = element.getBoundingClientRect()\r\n    } catch (e) {}\r\n    return box || {\r\n        left: 0,\r\n        top: 0\r\n    }\r\n}\r\nvar preserveAspectRatioMap = {\r\n    full: NONE,\r\n    lefttop: \"xMinYMin\",\r\n    leftcenter: \"xMinYMid\",\r\n    leftbottom: \"xMinYMax\",\r\n    centertop: \"xMidYMin\",\r\n    center: \"xMidYMid\",\r\n    centerbottom: \"xMidYMax\",\r\n    righttop: \"xMaxYMin\",\r\n    rightcenter: \"xMaxYMid\",\r\n    rightbottom: \"xMaxYMax\"\r\n};\r\n\r\nfunction processHatchingAttrs(element, attrs) {\r\n    if (attrs.hatching && \"none\" !== (0, _utils.normalizeEnum)(attrs.hatching.direction)) {\r\n        attrs = extend({}, attrs);\r\n        attrs.fill = element._hatching = element.renderer.lockHatching(attrs.fill, attrs.hatching, element._hatching);\r\n        delete attrs.hatching\r\n    } else {\r\n        if (element._hatching) {\r\n            element.renderer.releaseHatching(element._hatching);\r\n            element._hatching = null\r\n        }\r\n    }\r\n    return attrs\r\n}\r\nmodule.exports.processHatchingAttrs = processHatchingAttrs;\r\n\r\nfunction normalizeArcParams(x, y, innerR, outerR, startAngle, endAngle) {\r\n    var isCircle;\r\n    var noArc = true;\r\n    var angleDiff = roundValue(endAngle, 3) - roundValue(startAngle, 3);\r\n    if (angleDiff) {\r\n        if (abs(angleDiff) % 360 === 0) {\r\n            startAngle = 0;\r\n            endAngle = 360;\r\n            isCircle = true;\r\n            endAngle -= .01\r\n        }\r\n        if (startAngle > 360) {\r\n            startAngle %= 360\r\n        }\r\n        if (endAngle > 360) {\r\n            endAngle %= 360\r\n        }\r\n        if (startAngle > endAngle) {\r\n            startAngle -= 360\r\n        }\r\n        noArc = false\r\n    }\r\n    startAngle *= PI_DIV_180;\r\n    endAngle *= PI_DIV_180;\r\n    return [x, y, min(outerR, innerR), max(outerR, innerR), cos(startAngle), sin(startAngle), cos(endAngle), sin(endAngle), isCircle, floor(abs(endAngle - startAngle) / PI) % 2 ? \"1\" : \"0\", noArc]\r\n}\r\nvar buildArcPath = function(x, y, innerR, outerR, startAngleCos, startAngleSin, endAngleCos, endAngleSin, isCircle, longFlag) {\r\n    return [\"M\", (x + outerR * startAngleCos).toFixed(ARC_COORD_PREC), (y - outerR * startAngleSin).toFixed(ARC_COORD_PREC), \"A\", outerR.toFixed(ARC_COORD_PREC), outerR.toFixed(ARC_COORD_PREC), 0, longFlag, 0, (x + outerR * endAngleCos).toFixed(ARC_COORD_PREC), (y - outerR * endAngleSin).toFixed(ARC_COORD_PREC), isCircle ? \"M\" : \"L\", (x + innerR * endAngleCos).toFixed(5), (y - innerR * endAngleSin).toFixed(ARC_COORD_PREC), \"A\", innerR.toFixed(ARC_COORD_PREC), innerR.toFixed(ARC_COORD_PREC), 0, longFlag, 1, (x + innerR * startAngleCos).toFixed(ARC_COORD_PREC), (y - innerR * startAngleSin).toFixed(ARC_COORD_PREC), \"Z\"].join(\" \")\r\n};\r\n\r\nfunction buildPathSegments(points, type) {\r\n    var list = [\r\n        [\"M\", 0, 0]\r\n    ];\r\n    switch (type) {\r\n        case \"line\":\r\n            list = buildLineSegments(points);\r\n            break;\r\n        case \"area\":\r\n            list = buildLineSegments(points, true);\r\n            break;\r\n        case \"bezier\":\r\n            list = buildCurveSegments(points);\r\n            break;\r\n        case \"bezierarea\":\r\n            list = buildCurveSegments(points, true)\r\n    }\r\n    return list\r\n}\r\n\r\nfunction buildLineSegments(points, close) {\r\n    return buildSegments(points, buildSimpleLineSegment, close)\r\n}\r\n\r\nfunction buildCurveSegments(points, close) {\r\n    return buildSegments(points, buildSimpleCurveSegment, close)\r\n}\r\n\r\nfunction buildSegments(points, buildSimpleSegment, close) {\r\n    var i;\r\n    var ii;\r\n    var list = [];\r\n    if (points[0] && points[0].length) {\r\n        for (i = 0, ii = points.length; i < ii; ++i) {\r\n            buildSimpleSegment(points[i], close, list)\r\n        }\r\n    } else {\r\n        buildSimpleSegment(points, close, list)\r\n    }\r\n    return list\r\n}\r\n\r\nfunction buildSimpleLineSegment(points, close, list) {\r\n    var i = 0;\r\n    var k0 = list.length;\r\n    var k = k0;\r\n    var ii = (points || []).length;\r\n    if (ii) {\r\n        if (void 0 !== points[0].x) {\r\n            for (; i < ii;) {\r\n                list[k++] = [\"L\", points[i].x, points[i++].y]\r\n            }\r\n        } else {\r\n            for (; i < ii;) {\r\n                list[k++] = [\"L\", points[i++], points[i++]]\r\n            }\r\n        }\r\n        list[k0][0] = \"M\"\r\n    } else {\r\n        list[k] = [\"M\", 0, 0]\r\n    }\r\n    close && list.push([\"Z\"]);\r\n    return list\r\n}\r\n\r\nfunction buildSimpleCurveSegment(points, close, list) {\r\n    var i;\r\n    var k = list.length;\r\n    var ii = (points || []).length;\r\n    if (ii) {\r\n        if (void 0 !== points[0].x) {\r\n            list[k++] = [\"M\", points[0].x, points[0].y];\r\n            for (i = 1; i < ii;) {\r\n                list[k++] = [\"C\", points[i].x, points[i++].y, points[i].x, points[i++].y, points[i].x, points[i++].y]\r\n            }\r\n        } else {\r\n            list[k++] = [\"M\", points[0], points[1]];\r\n            for (i = 2; i < ii;) {\r\n                list[k++] = [\"C\", points[i++], points[i++], points[i++], points[i++], points[i++], points[i++]]\r\n            }\r\n        }\r\n    } else {\r\n        list[k] = [\"M\", 0, 0]\r\n    }\r\n    close && list.push([\"Z\"]);\r\n    return list\r\n}\r\n\r\nfunction combinePathParam(segments) {\r\n    var d = [];\r\n    var k = 0;\r\n    var i;\r\n    var ii = segments.length;\r\n    var segment;\r\n    var j;\r\n    var jj;\r\n    for (i = 0; i < ii; ++i) {\r\n        segment = segments[i];\r\n        for (j = 0, jj = segment.length; j < jj; ++j) {\r\n            d[k++] = segment[j]\r\n        }\r\n    }\r\n    return d.join(\" \")\r\n}\r\n\r\nfunction compensateSegments(oldSegments, newSegments, type) {\r\n    var oldLength = oldSegments.length;\r\n    var newLength = newSegments.length;\r\n    var i;\r\n    var originalNewSegments;\r\n    var makeEqualSegments = type.indexOf(\"area\") !== -1 ? makeEqualAreaSegments : makeEqualLineSegments;\r\n    if (0 === oldLength) {\r\n        for (i = 0; i < newLength; i++) {\r\n            oldSegments.push(newSegments[i].slice(0))\r\n        }\r\n    } else {\r\n        if (oldLength < newLength) {\r\n            makeEqualSegments(oldSegments, newSegments, type)\r\n        } else {\r\n            if (oldLength > newLength) {\r\n                originalNewSegments = newSegments.slice(0);\r\n                makeEqualSegments(newSegments, oldSegments, type)\r\n            }\r\n        }\r\n    }\r\n    return originalNewSegments\r\n}\r\n\r\nfunction prepareConstSegment(constSeg, type) {\r\n    var x = constSeg[constSeg.length - 2];\r\n    var y = constSeg[constSeg.length - 1];\r\n    switch (type) {\r\n        case \"line\":\r\n        case \"area\":\r\n            constSeg[0] = \"L\";\r\n            break;\r\n        case \"bezier\":\r\n        case \"bezierarea\":\r\n            constSeg[0] = \"C\";\r\n            constSeg[1] = constSeg[3] = constSeg[5] = x;\r\n            constSeg[2] = constSeg[4] = constSeg[6] = y\r\n    }\r\n}\r\n\r\nfunction makeEqualLineSegments(short, long, type) {\r\n    var constSeg = short[short.length - 1].slice();\r\n    var i = short.length;\r\n    prepareConstSegment(constSeg, type);\r\n    for (; i < long.length; i++) {\r\n        short[i] = constSeg.slice(0)\r\n    }\r\n}\r\n\r\nfunction makeEqualAreaSegments(short, long, type) {\r\n    var i;\r\n    var head;\r\n    var shortLength = short.length;\r\n    var longLength = long.length;\r\n    var constsSeg1;\r\n    var constsSeg2;\r\n    if ((shortLength - 1) % 2 === 0 && (longLength - 1) % 2 === 0) {\r\n        i = (shortLength - 1) / 2 - 1;\r\n        head = short.slice(0, i + 1);\r\n        constsSeg1 = head[head.length - 1].slice(0);\r\n        constsSeg2 = short.slice(i + 1)[0].slice(0);\r\n        prepareConstSegment(constsSeg1, type);\r\n        prepareConstSegment(constsSeg2, type);\r\n        for (var j = i; j < (longLength - 1) / 2 - 1; j++) {\r\n            short.splice(j + 1, 0, constsSeg1);\r\n            short.splice(j + 3, 0, constsSeg2)\r\n        }\r\n    }\r\n}\r\n\r\nfunction baseCss(that, styles) {\r\n    var elemStyles = that._styles;\r\n    var str = \"\";\r\n    var key;\r\n    var value;\r\n    styles = styles || {};\r\n    for (key in styles) {\r\n        value = styles[key];\r\n        if ((0, _type.isDefined)(value)) {\r\n            value += \"number\" === typeof value && !pxAddingExceptions[key] ? \"px\" : \"\";\r\n            elemStyles[key] = \"\" !== value ? value : null\r\n        }\r\n    }\r\n    for (key in elemStyles) {\r\n        value = elemStyles[key];\r\n        if (value) {\r\n            str += key + \":\" + value + \";\"\r\n        }\r\n    }\r\n    str && that.element.setAttribute(\"style\", str);\r\n    return that\r\n}\r\n\r\nfunction fixFuncIri(wrapper, attribute) {\r\n    var element = wrapper.element;\r\n    var id = wrapper.attr(attribute);\r\n    if (id && id.indexOf(\"DevExpress\") !== -1) {\r\n        element.removeAttribute(attribute);\r\n        element.setAttribute(attribute, getFuncIri(id, wrapper.renderer.pathModified))\r\n    }\r\n}\r\n\r\nfunction baseAttr(that, attrs) {\r\n    attrs = attrs || {};\r\n    var settings = that._settings;\r\n    var attributes = {};\r\n    var key;\r\n    var value;\r\n    var elem = that.element;\r\n    var renderer = that.renderer;\r\n    var rtl = renderer.rtl;\r\n    var hasTransformations;\r\n    var recalculateDashStyle;\r\n    var sw;\r\n    var i;\r\n    if (!isObjectArgument(attrs)) {\r\n        if (attrs in settings) {\r\n            return settings[attrs]\r\n        }\r\n        if (attrs in DEFAULTS) {\r\n            return DEFAULTS[attrs]\r\n        }\r\n        return 0\r\n    }\r\n    extend(attributes, attrs);\r\n    for (key in attributes) {\r\n        value = attributes[key];\r\n        if (void 0 === value) {\r\n            continue\r\n        }\r\n        settings[key] = value;\r\n        if (\"align\" === key) {\r\n            key = \"text-anchor\";\r\n            value = {\r\n                left: rtl ? \"end\" : \"start\",\r\n                center: \"middle\",\r\n                right: rtl ? \"start\" : \"end\"\r\n            } [value] || null\r\n        } else {\r\n            if (\"dashStyle\" === key) {\r\n                recalculateDashStyle = true;\r\n                continue\r\n            } else {\r\n                if (key === KEY_STROKE_WIDTH) {\r\n                    recalculateDashStyle = true\r\n                } else {\r\n                    if (value && (\"fill\" === key || \"clip-path\" === key || \"filter\" === key) && 0 === value.indexOf(\"DevExpress\")) {\r\n                        that._addFixIRICallback();\r\n                        value = getFuncIri(value, renderer.pathModified)\r\n                    } else {\r\n                        if (/^(translate(X|Y)|rotate[XY]?|scale(X|Y)|sharp|sharpDirection)$/i.test(key)) {\r\n                            hasTransformations = true;\r\n                            continue\r\n                        } else {\r\n                            if (/^(x|y|d)$/i.test(key)) {\r\n                                hasTransformations = true\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (null === value) {\r\n            elem.removeAttribute(key)\r\n        } else {\r\n            elem.setAttribute(key, value)\r\n        }\r\n    }\r\n    if (recalculateDashStyle && \"dashStyle\" in settings) {\r\n        value = settings.dashStyle;\r\n        sw = (\"_originalSW\" in that ? that._originalSW : settings[KEY_STROKE_WIDTH]) || 1;\r\n        key = \"stroke-dasharray\";\r\n        value = null === value ? \"\" : (0, _utils.normalizeEnum)(value);\r\n        if (\"\" === value || \"solid\" === value || value === NONE) {\r\n            that.element.removeAttribute(key)\r\n        } else {\r\n            value = value.replace(/longdash/g, \"8,3,\").replace(/dash/g, \"4,3,\").replace(/dot/g, \"1,3,\").replace(/,$/, \"\").split(\",\");\r\n            i = value.length;\r\n            while (i--) {\r\n                value[i] = parseInt(value[i]) * sw\r\n            }\r\n            that.element.setAttribute(key, value.join(\",\"))\r\n        }\r\n    }\r\n    if (hasTransformations) {\r\n        that._applyTransformation()\r\n    }\r\n    return that\r\n}\r\n\r\nfunction pathAttr(attrs) {\r\n    var that = this;\r\n    var segments;\r\n    if (isObjectArgument(attrs)) {\r\n        attrs = extend({}, attrs);\r\n        segments = attrs.segments;\r\n        if (\"points\" in attrs) {\r\n            segments = buildPathSegments(attrs.points, that.type);\r\n            delete attrs.points\r\n        }\r\n        if (segments) {\r\n            attrs.d = combinePathParam(segments);\r\n            that.segments = segments;\r\n            delete attrs.segments\r\n        }\r\n    }\r\n    return baseAttr(that, attrs)\r\n}\r\n\r\nfunction arcAttr(attrs) {\r\n    var settings = this._settings;\r\n    var x;\r\n    var y;\r\n    var innerRadius;\r\n    var outerRadius;\r\n    var startAngle;\r\n    var endAngle;\r\n    if (isObjectArgument(attrs)) {\r\n        attrs = extend({}, attrs);\r\n        if (\"x\" in attrs || \"y\" in attrs || \"innerRadius\" in attrs || \"outerRadius\" in attrs || \"startAngle\" in attrs || \"endAngle\" in attrs) {\r\n            settings.x = x = \"x\" in attrs ? attrs.x : settings.x;\r\n            delete attrs.x;\r\n            settings.y = y = \"y\" in attrs ? attrs.y : settings.y;\r\n            delete attrs.y;\r\n            settings.innerRadius = innerRadius = \"innerRadius\" in attrs ? attrs.innerRadius : settings.innerRadius;\r\n            delete attrs.innerRadius;\r\n            settings.outerRadius = outerRadius = \"outerRadius\" in attrs ? attrs.outerRadius : settings.outerRadius;\r\n            delete attrs.outerRadius;\r\n            settings.startAngle = startAngle = \"startAngle\" in attrs ? attrs.startAngle : settings.startAngle;\r\n            delete attrs.startAngle;\r\n            settings.endAngle = endAngle = \"endAngle\" in attrs ? attrs.endAngle : settings.endAngle;\r\n            delete attrs.endAngle;\r\n            attrs.d = buildArcPath.apply(null, normalizeArcParams(x, y, innerRadius, outerRadius, startAngle, endAngle))\r\n        }\r\n    }\r\n    return baseAttr(this, attrs)\r\n}\r\n\r\nfunction rectAttr(attrs) {\r\n    var that = this;\r\n    var x;\r\n    var y;\r\n    var width;\r\n    var height;\r\n    var sw;\r\n    var maxSW;\r\n    var newSW;\r\n    if (isObjectArgument(attrs)) {\r\n        attrs = extend({}, attrs);\r\n        if (void 0 !== attrs.x || void 0 !== attrs.y || void 0 !== attrs.width || void 0 !== attrs.height || void 0 !== attrs[KEY_STROKE_WIDTH]) {\r\n            void 0 !== attrs.x ? x = that._originalX = attrs.x : x = that._originalX || 0;\r\n            void 0 !== attrs.y ? y = that._originalY = attrs.y : y = that._originalY || 0;\r\n            void 0 !== attrs.width ? width = that._originalWidth = attrs.width : width = that._originalWidth || 0;\r\n            void 0 !== attrs.height ? height = that._originalHeight = attrs.height : height = that._originalHeight || 0;\r\n            void 0 !== attrs[KEY_STROKE_WIDTH] ? sw = that._originalSW = attrs[KEY_STROKE_WIDTH] : sw = that._originalSW;\r\n            maxSW = ~~((width < height ? width : height) / 2);\r\n            newSW = (sw || 0) < maxSW ? sw || 0 : maxSW;\r\n            attrs.x = x + newSW / 2;\r\n            attrs.y = y + newSW / 2;\r\n            attrs.width = width - newSW;\r\n            attrs.height = height - newSW;\r\n            ((sw || 0) !== newSW || !(0 === newSW && void 0 === sw)) && (attrs[KEY_STROKE_WIDTH] = newSW)\r\n        }\r\n        if (\"sharp\" in attrs) {\r\n            delete attrs.sharp\r\n        }\r\n    }\r\n    return baseAttr(that, attrs)\r\n}\r\n\r\nfunction textAttr(attrs) {\r\n    var that = this;\r\n    var settings;\r\n    var isResetRequired;\r\n    var wasStroked;\r\n    var isStroked;\r\n    if (!isObjectArgument(attrs)) {\r\n        return baseAttr(that, attrs)\r\n    }\r\n    attrs = extend({}, attrs);\r\n    settings = that._settings;\r\n    wasStroked = (0, _type.isDefined)(settings[KEY_STROKE]) && (0, _type.isDefined)(settings[KEY_STROKE_WIDTH]);\r\n    if (void 0 !== attrs[KEY_TEXT]) {\r\n        settings[KEY_TEXT] = attrs[KEY_TEXT];\r\n        delete attrs[KEY_TEXT];\r\n        isResetRequired = true\r\n    }\r\n    if (void 0 !== attrs[KEY_STROKE]) {\r\n        settings[KEY_STROKE] = attrs[KEY_STROKE];\r\n        delete attrs[KEY_STROKE]\r\n    }\r\n    if (void 0 !== attrs[KEY_STROKE_WIDTH]) {\r\n        settings[KEY_STROKE_WIDTH] = attrs[KEY_STROKE_WIDTH];\r\n        delete attrs[KEY_STROKE_WIDTH]\r\n    }\r\n    if (void 0 !== attrs[KEY_STROKE_OPACITY]) {\r\n        settings[KEY_STROKE_OPACITY] = attrs[KEY_STROKE_OPACITY];\r\n        delete attrs[KEY_STROKE_OPACITY]\r\n    }\r\n    if (void 0 !== attrs[KEY_TEXTS_ALIGNMENT]) {\r\n        alignTextNodes(that, attrs[KEY_TEXTS_ALIGNMENT]);\r\n        delete attrs[KEY_TEXTS_ALIGNMENT]\r\n    }\r\n    isStroked = (0, _type.isDefined)(settings[KEY_STROKE]) && (0, _type.isDefined)(settings[KEY_STROKE_WIDTH]);\r\n    baseAttr(that, attrs);\r\n    isResetRequired = isResetRequired || isStroked !== wasStroked && settings[KEY_TEXT];\r\n    if (isResetRequired) {\r\n        createTextNodes(that, settings.text, isStroked);\r\n        that._hasEllipsis = false\r\n    }\r\n    if (isResetRequired || void 0 !== attrs.x || void 0 !== attrs.y) {\r\n        locateTextNodes(that)\r\n    }\r\n    if (isStroked) {\r\n        strokeTextNodes(that)\r\n    }\r\n    return that\r\n}\r\n\r\nfunction textCss(styles) {\r\n    styles = styles || {};\r\n    baseCss(this, styles);\r\n    if (KEY_FONT_SIZE in styles) {\r\n        locateTextNodes(this)\r\n    }\r\n    return this\r\n}\r\n\r\nfunction orderHtmlTree(list, line, node, parentStyle, parentClassName) {\r\n    var style;\r\n    var realStyle;\r\n    var i;\r\n    var ii;\r\n    var nodes;\r\n    if (void 0 !== node.wholeText) {\r\n        list.push({\r\n            value: node.wholeText,\r\n            style: parentStyle,\r\n            className: parentClassName,\r\n            line: line,\r\n            height: parentStyle[KEY_FONT_SIZE] || 0\r\n        })\r\n    } else {\r\n        if (\"BR\" === node.tagName) {\r\n            ++line\r\n        } else {\r\n            if (_dom_adapter2.default.isElementNode(node)) {\r\n                extend(style = {}, parentStyle);\r\n                switch (node.tagName) {\r\n                    case \"B\":\r\n                    case \"STRONG\":\r\n                        style[KEY_FONT_WEIGHT] = \"bold\";\r\n                        break;\r\n                    case \"I\":\r\n                    case \"EM\":\r\n                        style[KEY_FONT_STYLE] = \"italic\";\r\n                        break;\r\n                    case \"U\":\r\n                        style[KEY_TEXT_DECORATION] = \"underline\"\r\n                }\r\n                realStyle = node.style;\r\n                realStyle.color && (style.fill = realStyle.color);\r\n                realStyle.fontSize && (style[KEY_FONT_SIZE] = realStyle.fontSize);\r\n                realStyle.fontStyle && (style[KEY_FONT_STYLE] = realStyle.fontStyle);\r\n                realStyle.fontWeight && (style[KEY_FONT_WEIGHT] = realStyle.fontWeight);\r\n                realStyle.textDecoration && (style[KEY_TEXT_DECORATION] = realStyle.textDecoration);\r\n                for (i = 0, nodes = node.childNodes, ii = nodes.length; i < ii; ++i) {\r\n                    line = orderHtmlTree(list, line, nodes[i], style, node.className || parentClassName)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return line\r\n}\r\n\r\nfunction adjustLineHeights(items) {\r\n    var i;\r\n    var ii;\r\n    var currentItem = items[0];\r\n    var item;\r\n    for (i = 1, ii = items.length; i < ii; ++i) {\r\n        item = items[i];\r\n        if (item.line === currentItem.line) {\r\n            currentItem.height = maxLengthFontSize(currentItem.height, item.height);\r\n            currentItem.inherits = currentItem.inherits || 0 === parseFloat(item.height);\r\n            item.height = NaN\r\n        } else {\r\n            currentItem = item\r\n        }\r\n    }\r\n}\r\n\r\nfunction removeExtraAttrs(html) {\r\n    var findTagAttrs = /(?:(<[a-z0-9]+\\s*))([\\s\\S]*?)(>|\\/>)/gi;\r\n    var findStyleAndClassAttrs = /(style|class)\\s*=\\s*([\"'])(?:(?!\\2).)*\\2\\s?/gi;\r\n    return html.replace(findTagAttrs, function(allTagAttrs, p1, p2, p3) {\r\n        p2 = (p2 && p2.match(findStyleAndClassAttrs) || []).map(function(str) {\r\n            return str\r\n        }).join(\" \");\r\n        return p1 + p2 + p3\r\n    })\r\n}\r\n\r\nfunction parseHTML(text) {\r\n    var items = [];\r\n    var div = _dom_adapter2.default.createElement(\"div\");\r\n    div.innerHTML = text.replace(/\\r/g, \"\").replace(/\\n/g, \"<br/>\");\r\n    orderHtmlTree(items, 0, div, {}, \"\");\r\n    adjustLineHeights(items);\r\n    return items\r\n}\r\n\r\nfunction parseMultiline(text) {\r\n    var texts = text.replace(/\\r/g, \"\").split(/\\n/g);\r\n    var i = 0;\r\n    var items = [];\r\n    for (; i < texts.length; i++) {\r\n        items.push({\r\n            value: texts[i].trim(),\r\n            height: 0,\r\n            line: i\r\n        })\r\n    }\r\n    return items\r\n}\r\n\r\nfunction createTspans(items, element, fieldName) {\r\n    var i;\r\n    var ii;\r\n    var item;\r\n    for (i = 0, ii = items.length; i < ii; ++i) {\r\n        item = items[i];\r\n        item[fieldName] = createElement(\"tspan\");\r\n        item[fieldName].appendChild(_dom_adapter2.default.createTextNode(item.value));\r\n        item.style && baseCss({\r\n            element: item[fieldName],\r\n            _styles: {}\r\n        }, item.style);\r\n        item.className && item[fieldName].setAttribute(\"class\", item.className);\r\n        element.appendChild(item[fieldName])\r\n    }\r\n}\r\n\r\nfunction restoreText() {\r\n    if (this._hasEllipsis) {\r\n        this.attr({\r\n            text: this._settings.text\r\n        })\r\n    }\r\n}\r\n\r\nfunction applyEllipsis(maxWidth) {\r\n    var that = this;\r\n    var lines;\r\n    var hasEllipsis = false;\r\n    var i;\r\n    var ii;\r\n    var lineParts;\r\n    var j;\r\n    var jj;\r\n    var text;\r\n    var ellipsis;\r\n    var ellipsisWidth;\r\n    restoreText.call(that);\r\n    ellipsis = that.renderer.text(ELLIPSIS).attr(that._styles).append(that.renderer.root);\r\n    ellipsisWidth = ellipsis.getBBox().width;\r\n    if (that._getElementBBox().width > maxWidth) {\r\n        if (maxWidth - ellipsisWidth < 0) {\r\n            maxWidth = 0\r\n        } else {\r\n            maxWidth -= ellipsisWidth\r\n        }\r\n        lines = prepareLines(that.element, that._texts, maxWidth);\r\n        for (i = 0, ii = lines.length; i < ii; ++i) {\r\n            lineParts = lines[i].parts;\r\n            if (1 === lines[i].commonLength) {\r\n                continue\r\n            }\r\n            for (j = 0, jj = lineParts.length; j < jj; ++j) {\r\n                text = lineParts[j];\r\n                if ((0, _type.isDefined)(text.endIndex)) {\r\n                    setNewText(text, text.endIndex);\r\n                    hasEllipsis = true\r\n                } else {\r\n                    if (text.startBox > maxWidth) {\r\n                        removeTextSpan(text)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ellipsis.remove();\r\n    that._hasEllipsis = hasEllipsis;\r\n    return hasEllipsis\r\n}\r\n\r\nfunction cloneAndRemoveAttrs(node) {\r\n    var clone;\r\n    if (node) {\r\n        clone = node.cloneNode();\r\n        clone.removeAttribute(\"y\");\r\n        clone.removeAttribute(\"x\")\r\n    }\r\n    return clone || node\r\n}\r\n\r\nfunction detachAndStoreTitleElements(element) {\r\n    var titleElements = _dom_adapter2.default.querySelectorAll(element, \"title\");\r\n    for (var i = 0; i < titleElements.length; i++) {\r\n        element.removeChild(titleElements[i])\r\n    }\r\n    return function() {\r\n        for (var _i = 0; _i < titleElements.length; _i++) {\r\n            element.appendChild(titleElements[_i])\r\n        }\r\n    }\r\n}\r\n\r\nfunction setMaxSize(maxWidth, maxHeight) {\r\n    var options = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\r\n    var that = this;\r\n    var lines = [];\r\n    var textChanged = false;\r\n    var textIsEmpty = false;\r\n    var ellipsis;\r\n    var ellipsisWidth;\r\n    var ellipsisMaxWidth = maxWidth;\r\n    restoreText.call(that);\r\n    var restoreTitleElement = detachAndStoreTitleElements(this.element);\r\n    ellipsis = that.renderer.text(ELLIPSIS).attr(that._styles).append(that.renderer.root);\r\n    ellipsisWidth = ellipsis.getBBox().width;\r\n    var _that$_getElementBBox = that._getElementBBox(),\r\n        width = _that$_getElementBBox.width,\r\n        height = _that$_getElementBBox.height;\r\n    if ((width || height) && (width > maxWidth || maxHeight && height > maxHeight)) {\r\n        if (maxWidth - ellipsisWidth < 0) {\r\n            ellipsisMaxWidth = 0\r\n        } else {\r\n            ellipsisMaxWidth -= ellipsisWidth\r\n        }\r\n        lines = applyOverflowRules(that.element, that._texts, maxWidth, ellipsisMaxWidth, options, maxHeight);\r\n        lines = setMaxHeight(lines, ellipsisMaxWidth, options, maxHeight, parseFloat(this._getLineHeight()));\r\n        this._texts = lines.reduce(function(texts, line) {\r\n            return texts.concat(line.parts)\r\n        }, []).filter(function(t) {\r\n            return \"\" !== t.value\r\n        }).map(function(t) {\r\n            t.stroke && t.tspan.parentNode.appendChild(t.stroke);\r\n            return t\r\n        }).map(function(t) {\r\n            t.tspan.parentNode.appendChild(t.tspan);\r\n            return t\r\n        });\r\n        !this._texts.length && (this._texts = null);\r\n        textChanged = true;\r\n        if (this._texts) {\r\n            locateTextNodes(this)\r\n        } else {\r\n            this.element.textContent = \"\";\r\n            textIsEmpty = true\r\n        }\r\n    }\r\n    ellipsis.remove();\r\n    that._hasEllipsis = textChanged;\r\n    restoreTitleElement();\r\n    return {\r\n        rowCount: lines.length,\r\n        textChanged: textChanged,\r\n        textIsEmpty: textIsEmpty\r\n    }\r\n}\r\n\r\nfunction getIndexForEllipsis(text, maxWidth, startBox, endBox) {\r\n    var k;\r\n    var kk;\r\n    if (startBox <= maxWidth && endBox > maxWidth) {\r\n        for (k = 1, kk = text.value.length; k <= kk; ++k) {\r\n            if (startBox + text.tspan.getSubStringLength(0, k) > maxWidth) {\r\n                return k - 1\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction getTextWidth(text) {\r\n    return text.value.length ? text.tspan.getSubStringLength(0, text.value.length) : 0\r\n}\r\n\r\nfunction prepareLines(element, texts, maxWidth) {\r\n    var lines = [];\r\n    var i;\r\n    var ii;\r\n    var text;\r\n    var startBox;\r\n    var endBox;\r\n    if (texts) {\r\n        for (i = 0, ii = texts.length; i < ii; ++i) {\r\n            text = texts[i];\r\n            if (!lines[text.line]) {\r\n                text.startBox = startBox = 0;\r\n                lines.push({\r\n                    commonLength: text.value.length,\r\n                    parts: [text]\r\n                })\r\n            } else {\r\n                text.startBox = startBox;\r\n                lines[text.line].parts.push(text);\r\n                lines[text.line].commonLength += text.value.length\r\n            }\r\n            endBox = startBox + text.tspan.getSubStringLength(0, text.value.length);\r\n            text.endIndex = getIndexForEllipsis(text, maxWidth, startBox, endBox);\r\n            startBox = endBox\r\n        }\r\n    } else {\r\n        text = {\r\n            value: element.textContent,\r\n            tspan: element\r\n        };\r\n        text.startBox = startBox = 0;\r\n        endBox = startBox + getTextWidth(text);\r\n        text.endIndex = getIndexForEllipsis(text, maxWidth, startBox, endBox);\r\n        lines = [{\r\n            commonLength: element.textContent.length,\r\n            parts: [text]\r\n        }]\r\n    }\r\n    return lines\r\n}\r\n\r\nfunction getSpaceBreakIndex(text, maxWidth) {\r\n    var initialIndices = text.startBox > 0 ? [0] : [];\r\n    var spaceIndices = text.value.split(\"\").reduce(function(indices, char, index) {\r\n        if (\" \" === char) {\r\n            indices.push(index)\r\n        }\r\n        return indices\r\n    }, initialIndices);\r\n    var spaceIndex = 0;\r\n    while (void 0 !== spaceIndices[spaceIndex + 1] && text.startBox + text.tspan.getSubStringLength(0, spaceIndices[spaceIndex + 1]) < maxWidth) {\r\n        spaceIndex++\r\n    }\r\n    return spaceIndices[spaceIndex]\r\n}\r\n\r\nfunction getWordBreakIndex(text, maxWidth) {\r\n    for (var i = 0; i < text.value.length - 1; i++) {\r\n        if (text.startBox + text.tspan.getSubStringLength(0, i + 1) > maxWidth) {\r\n            return i\r\n        }\r\n    }\r\n}\r\n\r\nfunction getEllipsisString(ellipsisMaxWidth, _ref) {\r\n    var hideOverflowEllipsis = _ref.hideOverflowEllipsis;\r\n    return hideOverflowEllipsis && 0 === ellipsisMaxWidth ? \"\" : ELLIPSIS\r\n}\r\n\r\nfunction setEllipsis(text, ellipsisMaxWidth, options) {\r\n    var ellipsis = getEllipsisString(ellipsisMaxWidth, options);\r\n    if (text.value.length && text.tspan.parentNode) {\r\n        for (var i = text.value.length - 1; i >= 1; i--) {\r\n            if (text.startBox + text.tspan.getSubStringLength(0, i) < ellipsisMaxWidth) {\r\n                setNewText(text, i, ellipsis);\r\n                break\r\n            } else {\r\n                if (1 === i) {\r\n                    setNewText(text, 0, ellipsis)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction wordWrap(text, maxWidth, ellipsisMaxWidth, options) {\r\n    var wholeText = text.value;\r\n    var breakIndex;\r\n    if (\"none\" !== options.wordWrap) {\r\n        breakIndex = \"normal\" === options.wordWrap ? getSpaceBreakIndex(text, maxWidth) : getWordBreakIndex(text, maxWidth)\r\n    }\r\n    var restLines = [];\r\n    var restText;\r\n    if (isFinite(breakIndex)) {\r\n        setNewText(text, breakIndex, \"\");\r\n        var newTextOffset = \" \" === wholeText[breakIndex] ? 1 : 0;\r\n        var restString = wholeText.slice(breakIndex + newTextOffset);\r\n        if (restString.length) {\r\n            var restTspan = cloneAndRemoveAttrs(text.tspan);\r\n            restTspan.textContent = restString;\r\n            text.tspan.parentNode.appendChild(restTspan);\r\n            restText = extend(extend({}, text), {\r\n                value: restString,\r\n                startBox: 0,\r\n                height: 0,\r\n                tspan: restTspan,\r\n                stroke: cloneAndRemoveAttrs(text.stroke),\r\n                endBox: restTspan.getSubStringLength(0, restString.length)\r\n            });\r\n            restText.stroke && (restText.stroke.textContent = restString);\r\n            if (restText.endBox > maxWidth) {\r\n                restLines = wordWrap(restText, maxWidth, ellipsisMaxWidth, options);\r\n                if (!restLines.length) {\r\n                    return []\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (text.value.length) {\r\n        if (\"ellipsis\" === options.textOverflow && text.tspan.getSubStringLength(0, text.value.length) > maxWidth) {\r\n            setEllipsis(text, ellipsisMaxWidth, options)\r\n        }\r\n        if (\"hide\" === options.textOverflow && text.tspan.getSubStringLength(0, text.value.length) > maxWidth) {\r\n            return []\r\n        }\r\n    } else {\r\n        text.tspan.parentNode.removeChild(text.tspan)\r\n    }\r\n    var parts = [];\r\n    if (restText) {\r\n        parts.push(restText)\r\n    }\r\n    return [{\r\n        commonLength: wholeText.length,\r\n        parts: parts\r\n    }].concat(restLines)\r\n}\r\n\r\nfunction calculateLineHeight(line, lineHeight) {\r\n    return line.parts.reduce(function(height, text) {\r\n        return max(height, getItemLineHeight(text, lineHeight))\r\n    }, 0)\r\n}\r\n\r\nfunction setMaxHeight(lines, ellipsisMaxWidth, options, maxHeight, lineHeight) {\r\n    var textOverflow = options.textOverflow;\r\n    if (!isFinite(maxHeight) || 0 === Number(maxHeight) || \"none\" === textOverflow) {\r\n        return lines\r\n    }\r\n    var result = lines.reduce(function(_ref2, l, index, arr) {\r\n        var _ref3 = _slicedToArray(_ref2, 2),\r\n            lines = _ref3[0],\r\n            commonHeight = _ref3[1];\r\n        var height = calculateLineHeight(l, lineHeight);\r\n        commonHeight += height;\r\n        if (commonHeight < maxHeight) {\r\n            lines.push(l)\r\n        } else {\r\n            l.parts.forEach(function(item) {\r\n                removeTextSpan(item)\r\n            });\r\n            if (\"ellipsis\" === textOverflow) {\r\n                var prevLine = arr[index - 1];\r\n                if (prevLine) {\r\n                    var text = prevLine.parts[prevLine.parts.length - 1];\r\n                    if (!text.hasEllipsis) {\r\n                        if (0 === ellipsisMaxWidth || text.endBox < ellipsisMaxWidth) {\r\n                            setNewText(text, text.value.length, getEllipsisString(ellipsisMaxWidth, options))\r\n                        } else {\r\n                            setEllipsis(text, ellipsisMaxWidth, options)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return [lines, commonHeight]\r\n    }, [\r\n        [], 0\r\n    ]);\r\n    if (\"hide\" === textOverflow && result[1] > maxHeight) {\r\n        result[0].forEach(function(l) {\r\n            l.parts.forEach(function(item) {\r\n                removeTextSpan(item)\r\n            })\r\n        });\r\n        return []\r\n    }\r\n    return result[0]\r\n}\r\n\r\nfunction applyOverflowRules(element, texts, maxWidth, ellipsisMaxWidth, options) {\r\n    if (!texts) {\r\n        var textValue = element.textContent;\r\n        var text = {\r\n            value: textValue,\r\n            height: 0,\r\n            line: 0\r\n        };\r\n        element.textContent = \"\";\r\n        createTspans([text], element, \"tspan\");\r\n        texts = [text]\r\n    }\r\n    return texts.reduce(function(_ref4, text) {\r\n        var _ref5 = _slicedToArray(_ref4, 5),\r\n            lines = _ref5[0],\r\n            startBox = _ref5[1],\r\n            endBox = _ref5[2],\r\n            stop = _ref5[3],\r\n            lineNumber = _ref5[4];\r\n        var line = lines[lines.length - 1];\r\n        if (stop) {\r\n            return [lines, startBox, endBox, stop]\r\n        }\r\n        if (!line || text.line !== lineNumber) {\r\n            text.startBox = startBox = 0;\r\n            lines.push({\r\n                commonLength: text.value.length,\r\n                parts: [text]\r\n            })\r\n        } else {\r\n            text.startBox = startBox;\r\n            if (startBox > ellipsisMaxWidth && \"none\" === options.wordWrap && \"ellipsis\" === options.textOverflow) {\r\n                removeTextSpan(text);\r\n                return [lines, startBox, endBox, stop, lineNumber]\r\n            }\r\n            line.parts.push(text);\r\n            line.commonLength += text.value.length\r\n        }\r\n        text.endBox = endBox = startBox + getTextWidth(text);\r\n        startBox = endBox;\r\n        if ((0, _type.isDefined)(maxWidth) && endBox > maxWidth) {\r\n            var wordWrapLines = wordWrap(text, maxWidth, ellipsisMaxWidth, options);\r\n            if (!wordWrapLines.length) {\r\n                lines = [];\r\n                stop = true\r\n            } else {\r\n                lines = lines.concat(wordWrapLines.filter(function(l) {\r\n                    return l.parts.length > 0\r\n                }))\r\n            }\r\n        }\r\n        return [lines, startBox, endBox, stop, text.line]\r\n    }, [\r\n        [], 0, 0, false, 0\r\n    ])[0]\r\n}\r\n\r\nfunction setNewText(text, index) {\r\n    var insertString = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : ELLIPSIS;\r\n    var newText = text.value.substr(0, index) + insertString;\r\n    text.value = text.tspan.textContent = newText;\r\n    text.stroke && (text.stroke.textContent = newText);\r\n    if (insertString === ELLIPSIS) {\r\n        text.hasEllipsis = true\r\n    }\r\n}\r\n\r\nfunction removeTextSpan(text) {\r\n    text.tspan.parentNode && text.tspan.parentNode.removeChild(text.tspan);\r\n    text.stroke && text.stroke.parentNode && text.stroke.parentNode.removeChild(text.stroke)\r\n}\r\n\r\nfunction createTextNodes(wrapper, text, isStroked) {\r\n    var items;\r\n    var parsedHtml;\r\n    wrapper._texts = null;\r\n    wrapper.clear();\r\n    if (null === text) {\r\n        return\r\n    }\r\n    text = \"\" + text;\r\n    if (!wrapper.renderer.encodeHtml && (/<[a-z][\\s\\S]*>/i.test(text) || text.indexOf(\"&\") !== -1)) {\r\n        parsedHtml = removeExtraAttrs(text);\r\n        items = parseHTML(parsedHtml)\r\n    } else {\r\n        if (/\\n/g.test(text)) {\r\n            items = parseMultiline(text)\r\n        } else {\r\n            if (isStroked) {\r\n                items = [{\r\n                    value: text.trim(),\r\n                    height: 0\r\n                }]\r\n            }\r\n        }\r\n    }\r\n    if (items) {\r\n        if (items.length) {\r\n            wrapper._texts = items;\r\n            if (isStroked) {\r\n                createTspans(items, wrapper.element, KEY_STROKE)\r\n            }\r\n            createTspans(items, wrapper.element, \"tspan\")\r\n        }\r\n    } else {\r\n        wrapper.element.appendChild(_dom_adapter2.default.createTextNode(text))\r\n    }\r\n}\r\n\r\nfunction setTextNodeAttribute(item, name, value) {\r\n    item.tspan.setAttribute(name, value);\r\n    item.stroke && item.stroke.setAttribute(name, value)\r\n}\r\n\r\nfunction getItemLineHeight(item, defaultValue) {\r\n    return item.inherits ? maxLengthFontSize(item.height, defaultValue) : item.height || defaultValue\r\n}\r\n\r\nfunction locateTextNodes(wrapper) {\r\n    if (!wrapper._texts) {\r\n        return\r\n    }\r\n    var items = wrapper._texts;\r\n    var x = wrapper._settings.x;\r\n    var lineHeight = wrapper._getLineHeight();\r\n    var i;\r\n    var ii;\r\n    var item = items[0];\r\n    setTextNodeAttribute(item, \"x\", x);\r\n    setTextNodeAttribute(item, \"y\", wrapper._settings.y);\r\n    for (i = 1, ii = items.length; i < ii; ++i) {\r\n        item = items[i];\r\n        if (parseFloat(item.height) >= 0) {\r\n            setTextNodeAttribute(item, \"x\", x);\r\n            var height = getItemLineHeight(item, lineHeight);\r\n            setTextNodeAttribute(item, \"dy\", height)\r\n        }\r\n    }\r\n}\r\n\r\nfunction alignTextNodes(wrapper, alignment) {\r\n    if (!wrapper._texts || \"center\" === alignment) {\r\n        return\r\n    }\r\n    var items = wrapper._texts;\r\n    var direction = \"left\" === alignment ? -1 : 1;\r\n    var maxTextWidth = Math.max.apply(Math, items.map(function(t) {\r\n        return getTextWidth(t)\r\n    }));\r\n    for (var i = 0; i < items.length; i++) {\r\n        var item = items[i];\r\n        var textWidth = getTextWidth(item);\r\n        if (0 !== maxTextWidth && maxTextWidth !== textWidth) {\r\n            setTextNodeAttribute(item, \"dx\", direction * round((maxTextWidth - textWidth) / 2 * 10) / 10)\r\n        }\r\n    }\r\n}\r\n\r\nfunction maxLengthFontSize(fontSize1, fontSize2) {\r\n    var parsedHeight1 = parseFloat(fontSize1);\r\n    var parsedHeight2 = parseFloat(fontSize2);\r\n    var height1 = parsedHeight1 || DEFAULT_FONT_SIZE;\r\n    var height2 = parsedHeight2 || DEFAULT_FONT_SIZE;\r\n    return height1 > height2 ? !isNaN(parsedHeight1) ? fontSize1 : height1 : !isNaN(parsedHeight2) ? fontSize2 : height2\r\n}\r\n\r\nfunction strokeTextNodes(wrapper) {\r\n    if (!wrapper._texts) {\r\n        return\r\n    }\r\n    var items = wrapper._texts;\r\n    var stroke = wrapper._settings[KEY_STROKE];\r\n    var strokeWidth = wrapper._settings[KEY_STROKE_WIDTH];\r\n    var strokeOpacity = wrapper._settings[KEY_STROKE_OPACITY] || 1;\r\n    var tspan;\r\n    var i;\r\n    var ii;\r\n    for (i = 0, ii = items.length; i < ii; ++i) {\r\n        tspan = items[i].stroke;\r\n        tspan.setAttribute(KEY_STROKE, stroke);\r\n        tspan.setAttribute(KEY_STROKE_WIDTH, strokeWidth);\r\n        tspan.setAttribute(KEY_STROKE_OPACITY, strokeOpacity);\r\n        tspan.setAttribute(\"stroke-linejoin\", \"round\")\r\n    }\r\n}\r\n\r\nfunction baseAnimate(that, params, options, complete) {\r\n    options = options || {};\r\n    var key;\r\n    var value;\r\n    var renderer = that.renderer;\r\n    var settings = that._settings;\r\n    var animationParams = {};\r\n    var defaults = {\r\n        translateX: 0,\r\n        translateY: 0,\r\n        scaleX: 1,\r\n        scaleY: 1,\r\n        rotate: 0,\r\n        rotateX: 0,\r\n        rotateY: 0\r\n    };\r\n    if (complete) {\r\n        options.complete = complete\r\n    }\r\n    if (renderer.animationEnabled()) {\r\n        for (key in params) {\r\n            value = params[key];\r\n            if (/^(translate(X|Y)|rotate[XY]?|scale(X|Y))$/i.test(key)) {\r\n                animationParams.transform = animationParams.transform || {\r\n                    from: {},\r\n                    to: {}\r\n                };\r\n                animationParams.transform.from[key] = key in settings ? Number(settings[key].toFixed(3)) : defaults[key];\r\n                animationParams.transform.to[key] = value\r\n            } else {\r\n                if (\"arc\" === key || \"segments\" === key) {\r\n                    animationParams[key] = value\r\n                } else {\r\n                    animationParams[key] = {\r\n                        from: key in settings ? settings[key] : parseFloat(that.element.getAttribute(key) || 0),\r\n                        to: value\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        renderer.animateElement(that, animationParams, extend(extend({}, renderer._animation), options))\r\n    } else {\r\n        options.step && options.step.call(that, 1, 1);\r\n        options.complete && options.complete.call(that);\r\n        that.attr(params)\r\n    }\r\n    return that\r\n}\r\n\r\nfunction pathAnimate(params, options, complete) {\r\n    var that = this;\r\n    var curSegments = that.segments || [];\r\n    var newSegments;\r\n    var endSegments;\r\n    if (that.renderer.animationEnabled() && \"points\" in params) {\r\n        newSegments = buildPathSegments(params.points, that.type);\r\n        endSegments = compensateSegments(curSegments, newSegments, that.type);\r\n        params.segments = {\r\n            from: curSegments,\r\n            to: newSegments,\r\n            end: endSegments\r\n        };\r\n        delete params.points\r\n    }\r\n    return baseAnimate(that, params, options, complete)\r\n}\r\n\r\nfunction arcAnimate(params, options, complete) {\r\n    var that = this;\r\n    var settings = that._settings;\r\n    var arcParams = {\r\n        from: {},\r\n        to: {}\r\n    };\r\n    if (that.renderer.animationEnabled() && (\"x\" in params || \"y\" in params || \"innerRadius\" in params || \"outerRadius\" in params || \"startAngle\" in params || \"endAngle\" in params)) {\r\n        arcParams.from.x = settings.x || 0;\r\n        arcParams.from.y = settings.y || 0;\r\n        arcParams.from.innerRadius = settings.innerRadius || 0;\r\n        arcParams.from.outerRadius = settings.outerRadius || 0;\r\n        arcParams.from.startAngle = settings.startAngle || 0;\r\n        arcParams.from.endAngle = settings.endAngle || 0;\r\n        arcParams.to.x = \"x\" in params ? params.x : settings.x;\r\n        delete params.x;\r\n        arcParams.to.y = \"y\" in params ? params.y : settings.y;\r\n        delete params.y;\r\n        arcParams.to.innerRadius = \"innerRadius\" in params ? params.innerRadius : settings.innerRadius;\r\n        delete params.innerRadius;\r\n        arcParams.to.outerRadius = \"outerRadius\" in params ? params.outerRadius : settings.outerRadius;\r\n        delete params.outerRadius;\r\n        arcParams.to.startAngle = \"startAngle\" in params ? params.startAngle : settings.startAngle;\r\n        delete params.startAngle;\r\n        arcParams.to.endAngle = \"endAngle\" in params ? params.endAngle : settings.endAngle;\r\n        delete params.endAngle;\r\n        params.arc = arcParams\r\n    }\r\n    return baseAnimate(that, params, options, complete)\r\n}\r\n\r\nfunction buildLink(target, parameters) {\r\n    var obj = {\r\n        is: false,\r\n        name: parameters.name || parameters,\r\n        after: parameters.after\r\n    };\r\n    if (target) {\r\n        obj.to = target\r\n    } else {\r\n        obj.virtual = true\r\n    }\r\n    return obj\r\n}\r\n\r\nfunction SvgElement(renderer, tagName, type) {\r\n    var that = this;\r\n    that.renderer = renderer;\r\n    that.element = createElement(tagName);\r\n    that._settings = {};\r\n    that._styles = {};\r\n    if (\"path\" === tagName) {\r\n        that.type = type || \"line\"\r\n    }\r\n}\r\n\r\nfunction removeFuncIriCallback(callback) {\r\n    fixFuncIriCallbacks.remove(callback)\r\n}\r\nexports.SvgElement = SvgElement;\r\nSvgElement.prototype = {\r\n    constructor: SvgElement,\r\n    _getJQElement: function() {\r\n        return this._$element || (this._$element = (0, _renderer2.default)(this.element))\r\n    },\r\n    _addFixIRICallback: function() {\r\n        var that = this;\r\n        var fn = function() {\r\n            fixFuncIri(that, \"fill\");\r\n            fixFuncIri(that, \"clip-path\");\r\n            fixFuncIri(that, \"filter\")\r\n        };\r\n        that.element._fixFuncIri = fn;\r\n        fn.renderer = that.renderer;\r\n        fixFuncIriCallbacks.add(fn);\r\n        that._addFixIRICallback = function() {}\r\n    },\r\n    _clearChildrenFuncIri: function() {\r\n        var clearChildren = function clearChildren(element) {\r\n            var i;\r\n            for (i = 0; i < element.childNodes.length; i++) {\r\n                removeFuncIriCallback(element.childNodes[i]._fixFuncIri);\r\n                clearChildren(element.childNodes[i])\r\n            }\r\n        };\r\n        clearChildren(this.element)\r\n    },\r\n    dispose: function() {\r\n        removeFuncIriCallback(this.element._fixFuncIri);\r\n        this._clearChildrenFuncIri();\r\n        this._getJQElement().remove();\r\n        return this\r\n    },\r\n    append: function(parent) {\r\n        (parent || this.renderer.root).element.appendChild(this.element);\r\n        return this\r\n    },\r\n    remove: function() {\r\n        var element = this.element;\r\n        element.parentNode && element.parentNode.removeChild(element);\r\n        return this\r\n    },\r\n    enableLinks: function() {\r\n        this._links = [];\r\n        return this\r\n    },\r\n    virtualLink: function(parameters) {\r\n        linkItem({\r\n            _link: buildLink(null, parameters)\r\n        }, this);\r\n        return this\r\n    },\r\n    linkAfter: function(name) {\r\n        this._linkAfter = name;\r\n        return this\r\n    },\r\n    linkOn: function(target, parameters) {\r\n        this._link = buildLink(target, parameters);\r\n        linkItem(this, target);\r\n        return this\r\n    },\r\n    linkOff: function() {\r\n        unlinkItem(this);\r\n        this._link = null;\r\n        return this\r\n    },\r\n    linkAppend: function() {\r\n        var link = this._link;\r\n        var items = link.to._links;\r\n        var i;\r\n        var next;\r\n        for (i = link.i + 1;\r\n            (next = items[i]) && !next._link.is; ++i) {}\r\n        this._insert(link.to, next);\r\n        link.is = true;\r\n        return this\r\n    },\r\n    _insert: function(parent, next) {\r\n        parent.element.insertBefore(this.element, next ? next.element : null)\r\n    },\r\n    linkRemove: function() {\r\n        this.remove();\r\n        this._link.is = false;\r\n        return this\r\n    },\r\n    clear: function() {\r\n        this._clearChildrenFuncIri();\r\n        this._getJQElement().empty();\r\n        return this\r\n    },\r\n    toBackground: function() {\r\n        var elem = this.element;\r\n        var parent = elem.parentNode;\r\n        parent && parent.insertBefore(elem, parent.firstChild);\r\n        return this\r\n    },\r\n    toForeground: function() {\r\n        var elem = this.element;\r\n        var parent = elem.parentNode;\r\n        parent && parent.appendChild(elem);\r\n        return this\r\n    },\r\n    attr: function(attrs) {\r\n        return baseAttr(this, attrs)\r\n    },\r\n    smartAttr: function(attrs) {\r\n        return this.attr(processHatchingAttrs(this, attrs))\r\n    },\r\n    css: function(styles) {\r\n        return baseCss(this, styles)\r\n    },\r\n    animate: function(params, options, complete) {\r\n        return baseAnimate(this, params, options, complete)\r\n    },\r\n    sharp: function(pos, sharpDirection) {\r\n        return this.attr({\r\n            sharp: pos || true,\r\n            sharpDirection: sharpDirection\r\n        })\r\n    },\r\n    _applyTransformation: function() {\r\n        var tr = this._settings;\r\n        var scaleXDefined;\r\n        var scaleYDefined;\r\n        var rotateX;\r\n        var rotateY;\r\n        var transformations = [];\r\n        var sharpMode = tr.sharp;\r\n        var trDirection = tr.sharpDirection || 1;\r\n        var strokeOdd = tr[KEY_STROKE_WIDTH] % 2;\r\n        var correctionX = strokeOdd && (\"h\" === sharpMode || true === sharpMode) ? SHARPING_CORRECTION * trDirection : 0;\r\n        var correctionY = strokeOdd && (\"v\" === sharpMode || true === sharpMode) ? SHARPING_CORRECTION * trDirection : 0;\r\n        transformations.push(\"translate(\" + ((tr.translateX || 0) + correctionX) + \",\" + ((tr.translateY || 0) + correctionY) + \")\");\r\n        if (tr.rotate) {\r\n            if (\"rotateX\" in tr) {\r\n                rotateX = tr.rotateX\r\n            } else {\r\n                rotateX = tr.x\r\n            }\r\n            if (\"rotateY\" in tr) {\r\n                rotateY = tr.rotateY\r\n            } else {\r\n                rotateY = tr.y\r\n            }\r\n            transformations.push(\"rotate(\" + tr.rotate + \",\" + (rotateX || 0) + \",\" + (rotateY || 0) + \")\")\r\n        }\r\n        scaleXDefined = (0, _type.isDefined)(tr.scaleX);\r\n        scaleYDefined = (0, _type.isDefined)(tr.scaleY);\r\n        if (scaleXDefined || scaleYDefined) {\r\n            transformations.push(\"scale(\" + (scaleXDefined ? tr.scaleX : 1) + \",\" + (scaleYDefined ? tr.scaleY : 1) + \")\")\r\n        }\r\n        if (transformations.length) {\r\n            this.element.setAttribute(\"transform\", transformations.join(\" \"))\r\n        }\r\n    },\r\n    move: function(x, y, animate, animOptions) {\r\n        var obj = {};\r\n        (0, _type.isDefined)(x) && (obj.translateX = x);\r\n        (0, _type.isDefined)(y) && (obj.translateY = y);\r\n        if (!animate) {\r\n            this.attr(obj)\r\n        } else {\r\n            this.animate(obj, animOptions)\r\n        }\r\n        return this\r\n    },\r\n    rotate: function(angle, x, y, animate, animOptions) {\r\n        var obj = {\r\n            rotate: angle || 0\r\n        };\r\n        (0, _type.isDefined)(x) && (obj.rotateX = x);\r\n        (0, _type.isDefined)(y) && (obj.rotateY = y);\r\n        if (!animate) {\r\n            this.attr(obj)\r\n        } else {\r\n            this.animate(obj, animOptions)\r\n        }\r\n        return this\r\n    },\r\n    _getElementBBox: function() {\r\n        var elem = this.element;\r\n        var bBox;\r\n        try {\r\n            bBox = elem.getBBox && elem.getBBox()\r\n        } catch (e) {}\r\n        return bBox || {\r\n            x: 0,\r\n            y: 0,\r\n            width: elem.offsetWidth || 0,\r\n            height: elem.offsetHeight || 0\r\n        }\r\n    },\r\n    getBBox: function() {\r\n        var transformation = this._settings;\r\n        var bBox = this._getElementBBox();\r\n        if (transformation.rotate) {\r\n            bBox = (0, _utils.rotateBBox)(bBox, [(\"rotateX\" in transformation ? transformation.rotateX : transformation.x) || 0, (\"rotateY\" in transformation ? transformation.rotateY : transformation.y) || 0], -transformation.rotate)\r\n        } else {\r\n            bBox = (0, _utils.normalizeBBox)(bBox)\r\n        }\r\n        return bBox\r\n    },\r\n    markup: function() {\r\n        return (0, _svg.getSvgMarkup)(this.element)\r\n    },\r\n    getOffset: function() {\r\n        return this._getJQElement().offset()\r\n    },\r\n    stopAnimation: function(disableComplete) {\r\n        var animation = this.animation;\r\n        animation && animation.stop(disableComplete);\r\n        return this\r\n    },\r\n    setTitle: function(text) {\r\n        var titleElem = createElement(\"title\");\r\n        titleElem.textContent = text || \"\";\r\n        this.element.appendChild(titleElem)\r\n    },\r\n    data: function(obj, val) {\r\n        var elem = this.element;\r\n        var key;\r\n        if (void 0 !== val) {\r\n            elem[obj] = val\r\n        } else {\r\n            for (key in obj) {\r\n                elem[key] = obj[key]\r\n            }\r\n        }\r\n        return this\r\n    },\r\n    on: function() {\r\n        var args = [this._getJQElement()];\r\n        args.push.apply(args, arguments);\r\n        _events_engine2.default.on.apply(_events_engine2.default, args);\r\n        return this\r\n    },\r\n    off: function() {\r\n        var args = [this._getJQElement()];\r\n        args.push.apply(args, arguments);\r\n        _events_engine2.default.off.apply(_events_engine2.default, args);\r\n        return this\r\n    },\r\n    trigger: function() {\r\n        var args = [this._getJQElement()];\r\n        args.push.apply(args, arguments);\r\n        _events_engine2.default.trigger.apply(_events_engine2.default, args);\r\n        return this\r\n    }\r\n};\r\n\r\nfunction PathSvgElement(renderer, type) {\r\n    SvgElement.call(this, renderer, \"path\", type)\r\n}\r\nexports.PathSvgElement = PathSvgElement;\r\nPathSvgElement.prototype = objectCreate(SvgElement.prototype);\r\nextend(PathSvgElement.prototype, {\r\n    constructor: PathSvgElement,\r\n    attr: pathAttr,\r\n    animate: pathAnimate\r\n});\r\n\r\nfunction ArcSvgElement(renderer) {\r\n    SvgElement.call(this, renderer, \"path\", \"arc\")\r\n}\r\nexports.ArcSvgElement = ArcSvgElement;\r\nArcSvgElement.prototype = objectCreate(SvgElement.prototype);\r\nextend(ArcSvgElement.prototype, {\r\n    constructor: ArcSvgElement,\r\n    attr: arcAttr,\r\n    animate: arcAnimate\r\n});\r\n\r\nfunction RectSvgElement(renderer) {\r\n    SvgElement.call(this, renderer, \"rect\")\r\n}\r\nexports.RectSvgElement = RectSvgElement;\r\nRectSvgElement.prototype = objectCreate(SvgElement.prototype);\r\nextend(RectSvgElement.prototype, {\r\n    constructor: RectSvgElement,\r\n    attr: rectAttr\r\n});\r\n\r\nfunction TextSvgElement(renderer) {\r\n    SvgElement.call(this, renderer, \"text\");\r\n    this.css({\r\n        \"white-space\": \"pre\"\r\n    })\r\n}\r\nexports.TextSvgElement = TextSvgElement;\r\nTextSvgElement.prototype = objectCreate(SvgElement.prototype);\r\nextend(TextSvgElement.prototype, {\r\n    constructor: TextSvgElement,\r\n    attr: textAttr,\r\n    css: textCss,\r\n    applyEllipsis: applyEllipsis,\r\n    setMaxSize: setMaxSize,\r\n    restoreText: restoreText,\r\n    _getLineHeight: function() {\r\n        return !isNaN(parseFloat(this._styles[KEY_FONT_SIZE])) ? this._styles[KEY_FONT_SIZE] : DEFAULT_FONT_SIZE\r\n    }\r\n});\r\n\r\nfunction updateIndexes(items, k) {\r\n    var i;\r\n    var item;\r\n    for (i = k; item = items[i]; ++i) {\r\n        item._link.i = i\r\n    }\r\n}\r\n\r\nfunction linkItem(target, container) {\r\n    var items = container._links;\r\n    var key = target._link.after = target._link.after || container._linkAfter;\r\n    var i;\r\n    var item;\r\n    if (key) {\r\n        for (i = 0;\r\n            (item = items[i]) && item._link.name !== key; ++i) {}\r\n        if (item) {\r\n            for (++i;\r\n                (item = items[i]) && item._link.after === key; ++i) {}\r\n        }\r\n    } else {\r\n        i = items.length\r\n    }\r\n    items.splice(i, 0, target);\r\n    updateIndexes(items, i)\r\n}\r\n\r\nfunction unlinkItem(target) {\r\n    var i;\r\n    var items = target._link.to._links;\r\n    for (i = 0; items[i] !== target; ++i) {}\r\n    items.splice(i, 1);\r\n    updateIndexes(items, i)\r\n}\r\n\r\nfunction Renderer(options) {\r\n    var that = this;\r\n    that.root = that._createElement(\"svg\", {\r\n        xmlns: \"http://www.w3.org/2000/svg\",\r\n        version: \"1.1\",\r\n        fill: NONE,\r\n        stroke: NONE,\r\n        \"stroke-width\": 0\r\n    }).attr({\r\n        \"class\": options.cssClass\r\n    }).css({\r\n        \"line-height\": \"normal\",\r\n        \"-ms-user-select\": NONE,\r\n        \"-moz-user-select\": NONE,\r\n        \"-webkit-user-select\": NONE,\r\n        \"-webkit-tap-highlight-color\": \"rgba(0, 0, 0, 0)\",\r\n        display: \"block\",\r\n        overflow: \"hidden\"\r\n    });\r\n    that._init();\r\n    that.pathModified = !!options.pathModified;\r\n    that._$container = (0, _renderer2.default)(options.container);\r\n    that.root.append({\r\n        element: options.container\r\n    });\r\n    that.fixPlacement();\r\n    that._locker = 0;\r\n    that._backed = false\r\n}\r\nexports.Renderer = Renderer;\r\nRenderer.prototype = {\r\n    constructor: Renderer,\r\n    _init: function() {\r\n        var that = this;\r\n        that._defs = that._createElement(\"defs\").append(that.root);\r\n        that._animationController = new _animation2.default.AnimationController(that.root.element);\r\n        that._animation = {\r\n            enabled: true,\r\n            duration: 1e3,\r\n            easing: \"easeOutCubic\"\r\n        }\r\n    },\r\n    fixPlacement: function() {\r\n        if (!_browser2.default.mozilla && !_browser2.default.msie) {\r\n            return\r\n        }\r\n        var box = getBoundingClientRect(this._$container.get(0));\r\n        var dx = roundValue(box.left % 1, 2);\r\n        var dy = roundValue(box.top % 1, 2);\r\n        if (_browser2.default.msie) {\r\n            this.root.css({\r\n                transform: \"translate(\" + -dx + \"px,\" + -dy + \"px)\"\r\n            })\r\n        } else {\r\n            if (_browser2.default.mozilla) {\r\n                this.root.move(-dx, -dy)\r\n            }\r\n        }\r\n    },\r\n    removePlacementFix: function() {\r\n        if (!_browser2.default.mozilla && !_browser2.default.msie) {\r\n            return\r\n        }\r\n        if (_browser2.default.msie) {\r\n            this.root.css({\r\n                transform: \"\"\r\n            })\r\n        } else {\r\n            if (_browser2.default.mozilla) {\r\n                this.root.attr({\r\n                    transform: null\r\n                })\r\n            }\r\n        }\r\n    },\r\n    setOptions: function(options) {\r\n        var that = this;\r\n        that.rtl = !!options.rtl;\r\n        that.encodeHtml = !!options.encodeHtml;\r\n        that.updateAnimationOptions(options.animation || {});\r\n        that.root.attr({\r\n            direction: that.rtl ? \"rtl\" : \"ltr\"\r\n        });\r\n        return that\r\n    },\r\n    _createElement: function(tagName, attr, type) {\r\n        var elem = new exports.SvgElement(this, tagName, type);\r\n        attr && elem.attr(attr);\r\n        return elem\r\n    },\r\n    lock: function() {\r\n        var that = this;\r\n        if (0 === that._locker) {\r\n            that._backed = !that._$container.is(\":visible\");\r\n            if (that._backed) {\r\n                backupRoot(that.root)\r\n            }\r\n        }++that._locker;\r\n        return that\r\n    },\r\n    unlock: function() {\r\n        var that = this;\r\n        --that._locker;\r\n        if (0 === that._locker) {\r\n            if (that._backed) {\r\n                restoreRoot(that.root, that._$container[0]);\r\n                that.fixPlacement()\r\n            }\r\n            that._backed = false\r\n        }\r\n        return that\r\n    },\r\n    resize: function(width, height) {\r\n        if (width >= 0 && height >= 0) {\r\n            this.root.attr({\r\n                width: width,\r\n                height: height\r\n            })\r\n        }\r\n        return this\r\n    },\r\n    dispose: function() {\r\n        var that = this;\r\n        var key;\r\n        that.root.dispose();\r\n        that._defs.dispose();\r\n        that._animationController.dispose();\r\n        fixFuncIriCallbacks.removeByRenderer(that);\r\n        for (key in that) {\r\n            that[key] = null\r\n        }\r\n        return that\r\n    },\r\n    animationEnabled: function() {\r\n        return !!this._animation.enabled\r\n    },\r\n    updateAnimationOptions: function(newOptions) {\r\n        extend(this._animation, newOptions);\r\n        return this\r\n    },\r\n    stopAllAnimations: function(lock) {\r\n        this._animationController[lock ? \"lock\" : \"stop\"]();\r\n        return this\r\n    },\r\n    animateElement: function(element, params, options) {\r\n        this._animationController.animateElement(element, params, options);\r\n        return this\r\n    },\r\n    svg: function() {\r\n        this.removePlacementFix();\r\n        var markup = this.root.markup();\r\n        this.fixPlacement();\r\n        return markup\r\n    },\r\n    getRootOffset: function() {\r\n        return this.root.getOffset()\r\n    },\r\n    onEndAnimation: function(endAnimation) {\r\n        this._animationController.onEndAnimation(endAnimation)\r\n    },\r\n    rect: function(x, y, width, height) {\r\n        var elem = new exports.RectSvgElement(this);\r\n        return elem.attr({\r\n            x: x || 0,\r\n            y: y || 0,\r\n            width: width || 0,\r\n            height: height || 0\r\n        })\r\n    },\r\n    simpleRect: function() {\r\n        return this._createElement(\"rect\")\r\n    },\r\n    circle: function(x, y, r) {\r\n        return this._createElement(\"circle\", {\r\n            cx: x || 0,\r\n            cy: y || 0,\r\n            r: r || 0\r\n        })\r\n    },\r\n    g: function() {\r\n        return this._createElement(\"g\")\r\n    },\r\n    image: function image(x, y, w, h, href, location) {\r\n        var image = this._createElement(\"image\", {\r\n            x: x || 0,\r\n            y: y || 0,\r\n            width: w || 0,\r\n            height: h || 0,\r\n            preserveAspectRatio: preserveAspectRatioMap[(0, _utils.normalizeEnum)(location)] || NONE\r\n        });\r\n        image.element.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", href || \"\");\r\n        return image\r\n    },\r\n    path: function(points, type) {\r\n        var elem = new exports.PathSvgElement(this, type);\r\n        return elem.attr({\r\n            points: points || []\r\n        })\r\n    },\r\n    arc: function(x, y, innerRadius, outerRadius, startAngle, endAngle) {\r\n        var elem = new exports.ArcSvgElement(this);\r\n        return elem.attr({\r\n            x: x || 0,\r\n            y: y || 0,\r\n            innerRadius: innerRadius || 0,\r\n            outerRadius: outerRadius || 0,\r\n            startAngle: startAngle || 0,\r\n            endAngle: endAngle || 0\r\n        })\r\n    },\r\n    text: function(_text, x, y) {\r\n        var elem = new exports.TextSvgElement(this);\r\n        return elem.attr({\r\n            text: _text,\r\n            x: x || 0,\r\n            y: y || 0\r\n        })\r\n    },\r\n    linearGradient: function(stops) {\r\n        var gradient;\r\n        var id = getNextDefsSvgId();\r\n        var that = this;\r\n        gradient = that._createElement(\"linearGradient\", {\r\n            id: id\r\n        }).append(that._defs);\r\n        gradient.id = id;\r\n        stops.forEach(function(stop) {\r\n            that._createElement(\"stop\", {\r\n                offset: stop.offset,\r\n                \"stop-color\": stop[\"stop-color\"]\r\n            }).append(gradient)\r\n        });\r\n        return gradient\r\n    },\r\n    pattern: function pattern(color, hatching, _id) {\r\n        hatching = hatching || {};\r\n        var that = this;\r\n        var id;\r\n        var d;\r\n        var pattern;\r\n        var rect;\r\n        var path;\r\n        var step = hatching.step || 6;\r\n        var stepTo2 = step / 2;\r\n        var stepBy15 = 1.5 * step;\r\n        id = _id || getNextDefsSvgId();\r\n        d = \"right\" === (0, _utils.normalizeEnum)(hatching.direction) ? \"M \" + stepTo2 + \" \" + -stepTo2 + \" L \" + -stepTo2 + \" \" + stepTo2 + \" M 0 \" + step + \" L \" + step + \" 0 M \" + stepBy15 + \" \" + stepTo2 + \" L \" + stepTo2 + \" \" + stepBy15 : \"M 0 0 L \" + step + \" \" + step + \" M \" + -stepTo2 + \" \" + stepTo2 + \" L \" + stepTo2 + \" \" + stepBy15 + \" M \" + stepTo2 + \" \" + -stepTo2 + \" L \" + stepBy15 + \" \" + stepTo2;\r\n        pattern = that._createElement(\"pattern\", {\r\n            id: id,\r\n            width: step,\r\n            height: step,\r\n            patternUnits: \"userSpaceOnUse\"\r\n        }).append(that._defs);\r\n        pattern.id = id;\r\n        rect = that.rect(0, 0, step, step).attr({\r\n            fill: color,\r\n            opacity: hatching.opacity\r\n        }).append(pattern);\r\n        path = new exports.PathSvgElement(this).attr({\r\n            d: d,\r\n            \"stroke-width\": hatching.width || 1,\r\n            stroke: color\r\n        }).append(pattern);\r\n        return pattern\r\n    },\r\n    _getPointsWithYOffset: function(points, offset) {\r\n        return points.map(function(point, index) {\r\n            if (index % 2 !== 0) {\r\n                return point + offset\r\n            }\r\n            return point\r\n        })\r\n    },\r\n    clipShape: function(method, methodArgs) {\r\n        var that = this;\r\n        var id = getNextDefsSvgId();\r\n        var clipPath = that._createElement(\"clipPath\", {\r\n            id: id\r\n        }).append(that._defs);\r\n        var shape = method.apply(that, methodArgs).append(clipPath);\r\n        shape.id = id;\r\n        shape.remove = function() {\r\n            throw \"Not implemented\"\r\n        };\r\n        shape.dispose = function() {\r\n            clipPath.dispose();\r\n            clipPath = null;\r\n            return this\r\n        };\r\n        return shape\r\n    },\r\n    clipRect: function(x, y, width, height) {\r\n        return this.clipShape(this.rect, arguments)\r\n    },\r\n    clipCircle: function(x, y, radius) {\r\n        return this.clipShape(this.circle, arguments)\r\n    },\r\n    shadowFilter: function(x, y, width, height, offsetX, offsetY, blur, color, opacity) {\r\n        var that = this;\r\n        var id = getNextDefsSvgId();\r\n        var filter = that._createElement(\"filter\", {\r\n            id: id,\r\n            x: x || 0,\r\n            y: y || 0,\r\n            width: width || 0,\r\n            height: height || 0\r\n        }).append(that._defs);\r\n        var gaussianBlur = that._createElement(\"feGaussianBlur\", {\r\n            \"in\": \"SourceGraphic\",\r\n            result: \"gaussianBlurResult\",\r\n            stdDeviation: blur || 0\r\n        }).append(filter);\r\n        var offset = that._createElement(\"feOffset\", {\r\n            \"in\": \"gaussianBlurResult\",\r\n            result: \"offsetResult\",\r\n            dx: offsetX || 0,\r\n            dy: offsetY || 0\r\n        }).append(filter);\r\n        var flood = that._createElement(\"feFlood\", {\r\n            result: \"floodResult\",\r\n            \"flood-color\": color || \"\",\r\n            \"flood-opacity\": opacity\r\n        }).append(filter);\r\n        var composite = that._createElement(\"feComposite\", {\r\n            \"in\": \"floodResult\",\r\n            in2: \"offsetResult\",\r\n            operator: \"in\",\r\n            result: \"compositeResult\"\r\n        }).append(filter);\r\n        var finalComposite = that._createElement(\"feComposite\", {\r\n            \"in\": \"SourceGraphic\",\r\n            in2: \"compositeResult\",\r\n            operator: \"over\"\r\n        }).append(filter);\r\n        filter.id = id;\r\n        filter.gaussianBlur = gaussianBlur;\r\n        filter.offset = offset;\r\n        filter.flood = flood;\r\n        filter.composite = composite;\r\n        filter.finalComposite = finalComposite;\r\n        filter.attr = function(attrs) {\r\n            var that = this;\r\n            var filterAttrs = {};\r\n            var offsetAttrs = {};\r\n            var floodAttrs = {};\r\n            \"x\" in attrs && (filterAttrs.x = attrs.x);\r\n            \"y\" in attrs && (filterAttrs.y = attrs.y);\r\n            \"width\" in attrs && (filterAttrs.width = attrs.width);\r\n            \"height\" in attrs && (filterAttrs.height = attrs.height);\r\n            baseAttr(that, filterAttrs);\r\n            \"blur\" in attrs && that.gaussianBlur.attr({\r\n                stdDeviation: attrs.blur\r\n            });\r\n            \"offsetX\" in attrs && (offsetAttrs.dx = attrs.offsetX);\r\n            \"offsetY\" in attrs && (offsetAttrs.dy = attrs.offsetY);\r\n            that.offset.attr(offsetAttrs);\r\n            \"color\" in attrs && (floodAttrs[\"flood-color\"] = attrs.color);\r\n            \"opacity\" in attrs && (floodAttrs[\"flood-opacity\"] = attrs.opacity);\r\n            that.flood.attr(floodAttrs);\r\n            return that\r\n        };\r\n        return filter\r\n    },\r\n    brightFilter: function(type, slope) {\r\n        var that = this;\r\n        var id = getNextDefsSvgId();\r\n        var filter = that._createElement(\"filter\", {\r\n            id: id\r\n        }).append(that._defs);\r\n        var componentTransferElement = that._createElement(\"feComponentTransfer\").append(filter);\r\n        var attrs = {\r\n            type: type,\r\n            slope: slope\r\n        };\r\n        filter.id = id;\r\n        that._createElement(\"feFuncR\", attrs).append(componentTransferElement);\r\n        that._createElement(\"feFuncG\", attrs).append(componentTransferElement);\r\n        that._createElement(\"feFuncB\", attrs).append(componentTransferElement);\r\n        return filter\r\n    },\r\n    getGrayScaleFilter: function() {\r\n        if (this._grayScaleFilter) {\r\n            return this._grayScaleFilter\r\n        }\r\n        var that = this;\r\n        var id = getNextDefsSvgId();\r\n        var filter = that._createElement(\"filter\", {\r\n            id: id\r\n        }).append(that._defs);\r\n        that._createElement(\"feColorMatrix\").attr({\r\n            type: \"matrix\",\r\n            values: \"0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 0.6 0\"\r\n        }).append(filter);\r\n        filter.id = id;\r\n        that._grayScaleFilter = filter;\r\n        return filter\r\n    },\r\n    initHatching: function() {\r\n        var storage = this._hatchingStorage = this._hatchingStorage || {\r\n            byHash: {},\r\n            baseId: getNextDefsSvgId()\r\n        };\r\n        var byHash = storage.byHash;\r\n        var name;\r\n        for (name in byHash) {\r\n            byHash[name].pattern.dispose()\r\n        }\r\n        storage.byHash = {};\r\n        storage.refToHash = {};\r\n        storage.nextId = 0\r\n    },\r\n    lockHatching: function(color, hatching, ref) {\r\n        var storage = this._hatchingStorage;\r\n        var hash = getHatchingHash(color, hatching);\r\n        var storageItem;\r\n        var pattern;\r\n        if (storage.refToHash[ref] !== hash) {\r\n            if (ref) {\r\n                this.releaseHatching(ref)\r\n            }\r\n            storageItem = storage.byHash[hash];\r\n            if (!storageItem) {\r\n                pattern = this.pattern(color, hatching, storage.baseId + \"-hatching-\" + storage.nextId++);\r\n                storageItem = storage.byHash[hash] = {\r\n                    pattern: pattern,\r\n                    count: 0\r\n                };\r\n                storage.refToHash[pattern.id] = hash\r\n            }++storageItem.count;\r\n            ref = storageItem.pattern.id\r\n        }\r\n        return ref\r\n    },\r\n    releaseHatching: function(ref) {\r\n        var storage = this._hatchingStorage;\r\n        var hash = storage.refToHash[ref];\r\n        var storageItem = storage.byHash[hash];\r\n        if (storageItem && 0 === --storageItem.count) {\r\n            storageItem.pattern.dispose();\r\n            delete storage.byHash[hash];\r\n            delete storage.refToHash[ref]\r\n        }\r\n    }\r\n};\r\n\r\nfunction getHatchingHash(color, hatching) {\r\n    return \"@\" + color + \"::\" + hatching.step + \":\" + hatching.width + \":\" + hatching.opacity + \":\" + hatching.direction\r\n}\r\nvar fixFuncIriCallbacks = function() {\r\n    var callbacks = [];\r\n    return {\r\n        add: function(fn) {\r\n            callbacks.push(fn)\r\n        },\r\n        remove: function(fn) {\r\n            callbacks = callbacks.filter(function(el) {\r\n                return el !== fn\r\n            })\r\n        },\r\n        removeByRenderer: function(renderer) {\r\n            callbacks = callbacks.filter(function(el) {\r\n                return el.renderer !== renderer\r\n            })\r\n        },\r\n        fire: function() {\r\n            callbacks.forEach(function(fn) {\r\n                fn()\r\n            })\r\n        }\r\n    }\r\n}();\r\nexports.refreshPaths = function() {\r\n    fixFuncIriCallbacks.fire()\r\n};\r\n"]},"metadata":{},"sourceType":"script"}