{"ast":null,"code":"/**\r\n * DevExtreme (ui/validation_engine.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _class = require(\"../core/class\");\n\nvar _class2 = _interopRequireDefault(_class);\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _array = require(\"../core/utils/array\");\n\nvar _iterator = require(\"../core/utils/iterator\");\n\nvar _events_mixin = require(\"../core/events_mixin\");\n\nvar _events_mixin2 = _interopRequireDefault(_events_mixin);\n\nvar _errors = require(\"../core/errors\");\n\nvar _errors2 = _interopRequireDefault(_errors);\n\nvar _common = require(\"../core/utils/common\");\n\nvar _type = require(\"../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _number = require(\"../localization/number\");\n\nvar _number2 = _interopRequireDefault(_number);\n\nvar _message = require(\"../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _promise = require(\"../core/polyfills/promise\");\n\nvar _promise2 = _interopRequireDefault(_promise);\n\nvar _deferred = require(\"../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _createSuper(Derived) {\n  return function () {\n    var result,\n        Super = _getPrototypeOf(Derived);\n\n    if (_isNativeReflectConstruct()) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (void 0 === self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (\"undefined\" === typeof Reflect || !Reflect.construct) {\n    return false;\n  }\n\n  if (Reflect.construct.sham) {\n    return false;\n  }\n\n  if (\"function\" === typeof Proxy) {\n    return true;\n  }\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (\"function\" !== typeof superClass && null !== superClass) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (superClass) {\n    _setPrototypeOf(subClass, superClass);\n  }\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar STATUS = {\n  valid: \"valid\",\n  invalid: \"invalid\",\n  pending: \"pending\"\n};\n\nvar BaseRuleValidator = function () {\n  function BaseRuleValidator() {\n    _classCallCheck(this, BaseRuleValidator);\n\n    this.NAME = \"base\";\n  }\n\n  _createClass(BaseRuleValidator, [{\n    key: \"defaultMessage\",\n    value: function value(_value) {\n      return _message2.default.getFormatter(\"validation-\".concat(this.NAME))(_value);\n    }\n  }, {\n    key: \"defaultFormattedMessage\",\n    value: function value(_value2) {\n      return _message2.default.getFormatter(\"validation-\".concat(this.NAME, \"-formatted\"))(_value2);\n    }\n  }, {\n    key: \"_isValueEmpty\",\n    value: function value(_value3) {\n      return !rulesValidators.required.validate(_value3, {});\n    }\n  }, {\n    key: \"validate\",\n    value: function value(_value4, rule) {\n      var _this = this;\n\n      var valueArray = Array.isArray(_value4) ? _value4 : [_value4];\n      var result = true;\n\n      if (valueArray.length) {\n        valueArray.every(function (itemValue) {\n          result = _this._validate(itemValue, rule);\n          return result;\n        });\n      } else {\n        result = this._validate(null, rule);\n      }\n\n      return result;\n    }\n  }]);\n\n  return BaseRuleValidator;\n}();\n\nvar RequiredRuleValidator = function (_BaseRuleValidator) {\n  _inherits(RequiredRuleValidator, _BaseRuleValidator);\n\n  var _super = _createSuper(RequiredRuleValidator);\n\n  function RequiredRuleValidator() {\n    var _this2;\n\n    _classCallCheck(this, RequiredRuleValidator);\n\n    _this2 = _super.call(this);\n    _this2.NAME = \"required\";\n    return _this2;\n  }\n\n  _createClass(RequiredRuleValidator, [{\n    key: \"_validate\",\n    value: function value(_value5, rule) {\n      if (!_type2.default.isDefined(_value5)) {\n        return false;\n      }\n\n      if (false === _value5) {\n        return false;\n      }\n\n      _value5 = String(_value5);\n\n      if (rule.trim || !_type2.default.isDefined(rule.trim)) {\n        _value5 = _value5.trim();\n      }\n\n      return \"\" !== _value5;\n    }\n  }]);\n\n  return RequiredRuleValidator;\n}(BaseRuleValidator);\n\nvar NumericRuleValidator = function (_BaseRuleValidator2) {\n  _inherits(NumericRuleValidator, _BaseRuleValidator2);\n\n  var _super2 = _createSuper(NumericRuleValidator);\n\n  function NumericRuleValidator() {\n    var _this3;\n\n    _classCallCheck(this, NumericRuleValidator);\n\n    _this3 = _super2.call(this);\n    _this3.NAME = \"numeric\";\n    return _this3;\n  }\n\n  _createClass(NumericRuleValidator, [{\n    key: \"_validate\",\n    value: function value(_value6, rule) {\n      if (false !== rule.ignoreEmptyValue && this._isValueEmpty(_value6)) {\n        return true;\n      }\n\n      if (rule.useCultureSettings && _type2.default.isString(_value6)) {\n        return !isNaN(_number2.default.parse(_value6));\n      } else {\n        return _type2.default.isNumeric(_value6);\n      }\n    }\n  }]);\n\n  return NumericRuleValidator;\n}(BaseRuleValidator);\n\nvar RangeRuleValidator = function (_BaseRuleValidator3) {\n  _inherits(RangeRuleValidator, _BaseRuleValidator3);\n\n  var _super3 = _createSuper(RangeRuleValidator);\n\n  function RangeRuleValidator() {\n    var _this4;\n\n    _classCallCheck(this, RangeRuleValidator);\n\n    _this4 = _super3.call(this);\n    _this4.NAME = \"range\";\n    return _this4;\n  }\n\n  _createClass(RangeRuleValidator, [{\n    key: \"_validate\",\n    value: function value(_value7, rule) {\n      if (false !== rule.ignoreEmptyValue && this._isValueEmpty(_value7)) {\n        return true;\n      }\n\n      var validNumber = rulesValidators.numeric.validate(_value7, rule);\n\n      var validValue = _type2.default.isDefined(_value7) && \"\" !== _value7;\n\n      var number = validNumber ? parseFloat(_value7) : validValue && _value7.valueOf();\n      var min = rule.min;\n      var max = rule.max;\n\n      if (!(validNumber || _type2.default.isDate(_value7)) && !validValue) {\n        return false;\n      }\n\n      if (_type2.default.isDefined(min)) {\n        if (_type2.default.isDefined(max)) {\n          return number >= min && number <= max;\n        }\n\n        return number >= min;\n      } else {\n        if (_type2.default.isDefined(max)) {\n          return number <= max;\n        } else {\n          throw _errors2.default.Error(\"E0101\");\n        }\n      }\n    }\n  }]);\n\n  return RangeRuleValidator;\n}(BaseRuleValidator);\n\nvar StringLengthRuleValidator = function (_BaseRuleValidator4) {\n  _inherits(StringLengthRuleValidator, _BaseRuleValidator4);\n\n  var _super4 = _createSuper(StringLengthRuleValidator);\n\n  function StringLengthRuleValidator() {\n    var _this5;\n\n    _classCallCheck(this, StringLengthRuleValidator);\n\n    _this5 = _super4.call(this);\n    _this5.NAME = \"stringLength\";\n    return _this5;\n  }\n\n  _createClass(StringLengthRuleValidator, [{\n    key: \"_validate\",\n    value: function value(_value8, rule) {\n      _value8 = _type2.default.isDefined(_value8) ? String(_value8) : \"\";\n\n      if (rule.trim || !_type2.default.isDefined(rule.trim)) {\n        _value8 = _value8.trim();\n      }\n\n      if (rule.ignoreEmptyValue && this._isValueEmpty(_value8)) {\n        return true;\n      }\n\n      return rulesValidators.range.validate(_value8.length, (0, _extend.extend)({}, rule));\n    }\n  }]);\n\n  return StringLengthRuleValidator;\n}(BaseRuleValidator);\n\nvar CustomRuleValidator = function (_BaseRuleValidator5) {\n  _inherits(CustomRuleValidator, _BaseRuleValidator5);\n\n  var _super5 = _createSuper(CustomRuleValidator);\n\n  function CustomRuleValidator() {\n    var _this6;\n\n    _classCallCheck(this, CustomRuleValidator);\n\n    _this6 = _super5.call(this);\n    _this6.NAME = \"custom\";\n    return _this6;\n  }\n\n  _createClass(CustomRuleValidator, [{\n    key: \"validate\",\n    value: function value(_value9, rule) {\n      if (rule.ignoreEmptyValue && this._isValueEmpty(_value9)) {\n        return true;\n      }\n\n      var validator = rule.validator;\n      var dataGetter = validator && _type2.default.isFunction(validator.option) && validator.option(\"dataGetter\");\n      var extraParams = _type2.default.isFunction(dataGetter) && dataGetter();\n      var params = {\n        value: _value9,\n        validator: validator,\n        rule: rule\n      };\n\n      if (extraParams) {\n        (0, _extend.extend)(params, extraParams);\n      }\n\n      return rule.validationCallback(params);\n    }\n  }]);\n\n  return CustomRuleValidator;\n}(BaseRuleValidator);\n\nvar AsyncRuleValidator = function (_CustomRuleValidator) {\n  _inherits(AsyncRuleValidator, _CustomRuleValidator);\n\n  var _super6 = _createSuper(AsyncRuleValidator);\n\n  function AsyncRuleValidator() {\n    var _this7;\n\n    _classCallCheck(this, AsyncRuleValidator);\n\n    _this7 = _super6.call(this);\n    _this7.NAME = \"async\";\n    return _this7;\n  }\n\n  _createClass(AsyncRuleValidator, [{\n    key: \"validate\",\n    value: function value(_value10, rule) {\n      if (!_type2.default.isDefined(rule.reevaluate)) {\n        (0, _extend.extend)(rule, {\n          reevaluate: true\n        });\n      }\n\n      if (rule.ignoreEmptyValue && this._isValueEmpty(_value10)) {\n        return true;\n      }\n\n      var validator = rule.validator;\n      var dataGetter = validator && _type2.default.isFunction(validator.option) && validator.option(\"dataGetter\");\n      var extraParams = _type2.default.isFunction(dataGetter) && dataGetter();\n      var params = {\n        value: _value10,\n        validator: validator,\n        rule: rule\n      };\n\n      if (extraParams) {\n        (0, _extend.extend)(params, extraParams);\n      }\n\n      var callbackResult = rule.validationCallback(params);\n\n      if (!_type2.default.isPromise(callbackResult)) {\n        throw _errors2.default.Error(\"E0103\");\n      }\n\n      return this._getWrappedPromise((0, _deferred.fromPromise)(callbackResult).promise());\n    }\n  }, {\n    key: \"_getWrappedPromise\",\n    value: function value(promise) {\n      var deferred = new _deferred.Deferred();\n      promise.then(function (res) {\n        deferred.resolve(res);\n      }, function (err) {\n        var res = {\n          isValid: false\n        };\n\n        if (_type2.default.isDefined(err)) {\n          if (_type2.default.isString(err)) {\n            res.message = err;\n          } else {\n            if (_type2.default.isObject(err) && _type2.default.isDefined(err.message) && _type2.default.isString(err.message)) {\n              res.message = err.message;\n            }\n          }\n        }\n\n        deferred.resolve(res);\n      });\n      return deferred.promise();\n    }\n  }]);\n\n  return AsyncRuleValidator;\n}(CustomRuleValidator);\n\nvar CompareRuleValidator = function (_BaseRuleValidator6) {\n  _inherits(CompareRuleValidator, _BaseRuleValidator6);\n\n  var _super7 = _createSuper(CompareRuleValidator);\n\n  function CompareRuleValidator() {\n    var _this8;\n\n    _classCallCheck(this, CompareRuleValidator);\n\n    _this8 = _super7.call(this);\n    _this8.NAME = \"compare\";\n    return _this8;\n  }\n\n  _createClass(CompareRuleValidator, [{\n    key: \"_validate\",\n    value: function value(_value11, rule) {\n      if (!rule.comparisonTarget) {\n        throw _errors2.default.Error(\"E0102\");\n      }\n\n      if (rule.ignoreEmptyValue && this._isValueEmpty(_value11)) {\n        return true;\n      }\n\n      (0, _extend.extend)(rule, {\n        reevaluate: true\n      });\n      var otherValue = rule.comparisonTarget();\n      var type = rule.comparisonType || \"==\";\n\n      switch (type) {\n        case \"==\":\n          return _value11 == otherValue;\n\n        case \"!=\":\n          return _value11 != otherValue;\n\n        case \"===\":\n          return _value11 === otherValue;\n\n        case \"!==\":\n          return _value11 !== otherValue;\n\n        case \">\":\n          return _value11 > otherValue;\n\n        case \">=\":\n          return _value11 >= otherValue;\n\n        case \"<\":\n          return _value11 < otherValue;\n\n        case \"<=\":\n          return _value11 <= otherValue;\n      }\n    }\n  }]);\n\n  return CompareRuleValidator;\n}(BaseRuleValidator);\n\nvar PatternRuleValidator = function (_BaseRuleValidator7) {\n  _inherits(PatternRuleValidator, _BaseRuleValidator7);\n\n  var _super8 = _createSuper(PatternRuleValidator);\n\n  function PatternRuleValidator() {\n    var _this9;\n\n    _classCallCheck(this, PatternRuleValidator);\n\n    _this9 = _super8.call(this);\n    _this9.NAME = \"pattern\";\n    return _this9;\n  }\n\n  _createClass(PatternRuleValidator, [{\n    key: \"_validate\",\n    value: function value(_value12, rule) {\n      if (false !== rule.ignoreEmptyValue && this._isValueEmpty(_value12)) {\n        return true;\n      }\n\n      var pattern = rule.pattern;\n\n      if (_type2.default.isString(pattern)) {\n        pattern = new RegExp(pattern);\n      }\n\n      return pattern.test(_value12);\n    }\n  }]);\n\n  return PatternRuleValidator;\n}(BaseRuleValidator);\n\nvar EmailRuleValidator = function (_BaseRuleValidator8) {\n  _inherits(EmailRuleValidator, _BaseRuleValidator8);\n\n  var _super9 = _createSuper(EmailRuleValidator);\n\n  function EmailRuleValidator() {\n    var _this10;\n\n    _classCallCheck(this, EmailRuleValidator);\n\n    _this10 = _super9.call(this);\n    _this10.NAME = \"email\";\n    return _this10;\n  }\n\n  _createClass(EmailRuleValidator, [{\n    key: \"_validate\",\n    value: function value(_value13, rule) {\n      if (false !== rule.ignoreEmptyValue && this._isValueEmpty(_value13)) {\n        return true;\n      }\n\n      return rulesValidators.pattern.validate(_value13, (0, _extend.extend)({}, rule, {\n        pattern: /^[\\d\\w._-]+@([\\d\\w._-]+\\.)+[\\w]+$/i\n      }));\n    }\n  }]);\n\n  return EmailRuleValidator;\n}(BaseRuleValidator);\n\nvar rulesValidators = {\n  required: new RequiredRuleValidator(),\n  numeric: new NumericRuleValidator(),\n  range: new RangeRuleValidator(),\n  stringLength: new StringLengthRuleValidator(),\n  custom: new CustomRuleValidator(),\n  async: new AsyncRuleValidator(),\n  compare: new CompareRuleValidator(),\n  pattern: new PatternRuleValidator(),\n  email: new EmailRuleValidator()\n};\n\nvar GroupConfig = _class2.default.inherit({\n  ctor: function ctor(group) {\n    this.group = group;\n    this.validators = [];\n    this._pendingValidators = [];\n    this._onValidatorStatusChanged = this._onValidatorStatusChanged.bind(this);\n\n    this._resetValidationInfo();\n  },\n  validate: function validate() {\n    var _this11 = this;\n\n    var result = {\n      isValid: true,\n      brokenRules: [],\n      validators: [],\n      status: STATUS.valid,\n      complete: null\n    };\n\n    this._unsubscribeFromAllChangeEvents();\n\n    this._pendingValidators = [];\n\n    this._resetValidationInfo();\n\n    (0, _iterator.each)(this.validators, function (_, validator) {\n      var validatorResult = validator.validate();\n      result.isValid = result.isValid && validatorResult.isValid;\n\n      if (validatorResult.brokenRules) {\n        result.brokenRules = result.brokenRules.concat(validatorResult.brokenRules);\n      }\n\n      result.validators.push(validator);\n\n      if (validatorResult.status === STATUS.pending) {\n        _this11._addPendingValidator(validator);\n      }\n\n      _this11._subscribeToChangeEvents(validator);\n    });\n\n    if (this._pendingValidators.length) {\n      result.status = STATUS.pending;\n    } else {\n      result.status = result.isValid ? STATUS.valid : STATUS.invalid;\n\n      this._unsubscribeFromAllChangeEvents();\n\n      this._raiseValidatedEvent(result);\n    }\n\n    this._updateValidationInfo(result);\n\n    return (0, _extend.extend)({}, this._validationInfo.result);\n  },\n  _subscribeToChangeEvents: function _subscribeToChangeEvents(validator) {\n    validator.on(\"validating\", this._onValidatorStatusChanged);\n    validator.on(\"validated\", this._onValidatorStatusChanged);\n  },\n  _unsubscribeFromChangeEvents: function _unsubscribeFromChangeEvents(validator) {\n    validator.off(\"validating\", this._onValidatorStatusChanged);\n    validator.off(\"validated\", this._onValidatorStatusChanged);\n  },\n  _unsubscribeFromAllChangeEvents: function _unsubscribeFromAllChangeEvents() {\n    var _this12 = this;\n\n    (0, _iterator.each)(this.validators, function (_, validator) {\n      _this12._unsubscribeFromChangeEvents(validator);\n    });\n  },\n  _updateValidationInfo: function _updateValidationInfo(result) {\n    this._validationInfo.result = result;\n\n    if (result.status !== STATUS.pending) {\n      return;\n    }\n\n    if (!this._validationInfo.deferred) {\n      this._validationInfo.deferred = new _deferred.Deferred();\n      this._validationInfo.result.complete = this._validationInfo.deferred.promise();\n    }\n  },\n  _addPendingValidator: function _addPendingValidator(validator) {\n    var foundValidator = (0, _common.grep)(this._pendingValidators, function (val) {\n      return val === validator;\n    })[0];\n\n    if (!foundValidator) {\n      this._pendingValidators.push(validator);\n    }\n  },\n  _removePendingValidator: function _removePendingValidator(validator) {\n    var index = (0, _array.inArray)(validator, this._pendingValidators);\n\n    if (index >= 0) {\n      this._pendingValidators.splice(index, 1);\n    }\n  },\n  _orderBrokenRules: function _orderBrokenRules(brokenRules) {\n    var orderedRules = [];\n    (0, _iterator.each)(this.validators, function (_, validator) {\n      var foundRules = (0, _common.grep)(brokenRules, function (rule) {\n        return rule.validator === validator;\n      });\n\n      if (foundRules.length) {\n        orderedRules = orderedRules.concat(foundRules);\n      }\n    });\n    return orderedRules;\n  },\n  _updateBrokenRules: function _updateBrokenRules(result) {\n    if (!this._validationInfo.result) {\n      return;\n    }\n\n    var brokenRules = this._validationInfo.result.brokenRules;\n    var rules = (0, _common.grep)(brokenRules, function (rule) {\n      return rule.validator !== result.validator;\n    });\n\n    if (result.brokenRules) {\n      brokenRules = rules.concat(result.brokenRules);\n    }\n\n    this._validationInfo.result.brokenRules = this._orderBrokenRules(brokenRules);\n  },\n  _onValidatorStatusChanged: function _onValidatorStatusChanged(result) {\n    if (result.status === STATUS.pending) {\n      this._addPendingValidator(result.validator);\n\n      return;\n    }\n\n    this._resolveIfComplete(result);\n  },\n  _resolveIfComplete: function _resolveIfComplete(result) {\n    this._removePendingValidator(result.validator);\n\n    this._updateBrokenRules(result);\n\n    if (!this._pendingValidators.length) {\n      this._unsubscribeFromAllChangeEvents();\n\n      if (!this._validationInfo.result) {\n        return;\n      }\n\n      this._validationInfo.result.status = 0 === this._validationInfo.result.brokenRules.length ? STATUS.valid : STATUS.invalid;\n      this._validationInfo.result.isValid = this._validationInfo.result.status === STATUS.valid;\n      var res = (0, _extend.extend)({}, this._validationInfo.result, {\n        complete: null\n      });\n      var deferred = this._validationInfo.deferred;\n\n      this._resetValidationInfo();\n\n      this._raiseValidatedEvent(res);\n\n      deferred && setTimeout(function () {\n        deferred.resolve(res);\n      });\n    }\n  },\n  _raiseValidatedEvent: function _raiseValidatedEvent(result) {\n    this.fireEvent(\"validated\", [result]);\n  },\n  _resetValidationInfo: function _resetValidationInfo() {\n    this._validationInfo = {\n      result: null,\n      deferred: null\n    };\n  },\n  _synchronizeValidationInfo: function _synchronizeValidationInfo() {\n    if (this._validationInfo.result) {\n      this._validationInfo.result.validators = this.validators;\n    }\n  },\n  removeRegisteredValidator: function removeRegisteredValidator(validator) {\n    var index = (0, _array.inArray)(validator, this.validators);\n\n    if (index > -1) {\n      this.validators.splice(index, 1);\n\n      this._synchronizeValidationInfo();\n\n      this._resolveIfComplete({\n        validator: validator\n      });\n    }\n  },\n  registerValidator: function registerValidator(validator) {\n    if ((0, _array.inArray)(validator, this.validators) < 0) {\n      this.validators.push(validator);\n\n      this._synchronizeValidationInfo();\n    }\n  },\n  reset: function reset() {\n    (0, _iterator.each)(this.validators, function (_, validator) {\n      validator.reset();\n    });\n    this._pendingValidators = [];\n\n    this._resetValidationInfo();\n  }\n}).include(_events_mixin2.default);\n\nvar ValidationEngine = {\n  groups: [],\n  getGroupConfig: function getGroupConfig(group) {\n    var result = (0, _common.grep)(this.groups, function (config) {\n      return config.group === group;\n    });\n\n    if (result.length) {\n      return result[0];\n    }\n  },\n  findGroup: function findGroup($element, model) {\n    var $dxGroup = $element.parents(\".dx-validationgroup\").first();\n\n    if ($dxGroup.length) {\n      return $dxGroup.dxValidationGroup(\"instance\");\n    }\n\n    return model;\n  },\n  initGroups: function initGroups() {\n    this.groups = [];\n    this.addGroup();\n  },\n  addGroup: function addGroup(group) {\n    var config = this.getGroupConfig(group);\n\n    if (!config) {\n      config = new GroupConfig(group);\n      this.groups.push(config);\n    }\n\n    return config;\n  },\n  removeGroup: function removeGroup(group) {\n    var config = this.getGroupConfig(group);\n    var index = (0, _array.inArray)(config, this.groups);\n\n    if (index > -1) {\n      this.groups.splice(index, 1);\n    }\n\n    return config;\n  },\n  _setDefaultMessage: function _setDefaultMessage(info) {\n    var rule = info.rule,\n        validator = info.validator,\n        name = info.name;\n\n    if (!_type2.default.isDefined(rule.message)) {\n      if (validator.defaultFormattedMessage && _type2.default.isDefined(name)) {\n        rule.message = validator.defaultFormattedMessage(name);\n      } else {\n        rule.message = validator.defaultMessage();\n      }\n    }\n  },\n  _addBrokenRule: function _addBrokenRule(info) {\n    var result = info.result,\n        rule = info.rule;\n\n    if (!result.brokenRule) {\n      result.brokenRule = rule;\n    }\n\n    if (!result.brokenRules) {\n      result.brokenRules = [];\n    }\n\n    result.brokenRules.push(rule);\n  },\n  validate: function validate(value, rules, name) {\n    var _this13 = this;\n\n    var result = {\n      name: name,\n      value: value,\n      brokenRule: null,\n      brokenRules: null,\n      isValid: true,\n      validationRules: rules,\n      pendingRules: null,\n      status: STATUS.valid,\n      complete: null\n    };\n    var asyncRuleItems = [];\n    (0, _iterator.each)(rules || [], function (_, rule) {\n      var ruleValidator = rulesValidators[rule.type];\n      var ruleValidationResult;\n\n      if (ruleValidator) {\n        if (_type2.default.isDefined(rule.isValid) && rule.value === value && !rule.reevaluate) {\n          if (!rule.isValid) {\n            result.isValid = false;\n\n            _this13._addBrokenRule({\n              result: result,\n              rule: rule\n            });\n\n            return false;\n          }\n\n          return true;\n        }\n\n        rule.value = value;\n\n        if (\"async\" === rule.type) {\n          asyncRuleItems.push({\n            rule: rule,\n            ruleValidator: ruleValidator\n          });\n          return true;\n        }\n\n        ruleValidationResult = ruleValidator.validate(value, rule);\n        rule.isValid = ruleValidationResult;\n\n        if (!ruleValidationResult) {\n          result.isValid = false;\n\n          _this13._setDefaultMessage({\n            rule: rule,\n            validator: ruleValidator,\n            name: name\n          });\n\n          _this13._addBrokenRule({\n            result: result,\n            rule: rule\n          });\n        }\n\n        if (!rule.isValid) {\n          return false;\n        }\n      } else {\n        throw _errors2.default.Error(\"E0100\");\n      }\n    });\n\n    if (result.isValid && !result.brokenRules && asyncRuleItems.length) {\n      result = this._validateAsyncRules({\n        value: value,\n        items: asyncRuleItems,\n        result: result,\n        name: name\n      });\n    }\n\n    result.status = result.pendingRules ? STATUS.pending : result.isValid ? STATUS.valid : STATUS.invalid;\n    return result;\n  },\n  _validateAsyncRules: function _validateAsyncRules(_ref) {\n    var _this14 = this;\n\n    var result = _ref.result,\n        value = _ref.value,\n        items = _ref.items,\n        name = _ref.name;\n    var asyncResults = [];\n    (0, _iterator.each)(items, function (_, item) {\n      var validateResult = item.ruleValidator.validate(value, item.rule);\n\n      if (!_type2.default.isPromise(validateResult)) {\n        _this14._updateRuleConfig({\n          rule: item.rule,\n          ruleResult: _this14._getPatchedRuleResult(validateResult),\n          validator: item.ruleValidator,\n          name: name\n        });\n      } else {\n        if (!result.pendingRules) {\n          result.pendingRules = [];\n        }\n\n        result.pendingRules.push(item.rule);\n        var asyncResult = validateResult.then(function (res) {\n          var ruleResult = _this14._getPatchedRuleResult(res);\n\n          _this14._updateRuleConfig({\n            rule: item.rule,\n            ruleResult: ruleResult,\n            validator: item.ruleValidator,\n            name: name\n          });\n\n          return ruleResult;\n        });\n        asyncResults.push(asyncResult);\n      }\n    });\n\n    if (asyncResults.length) {\n      result.complete = _promise2.default.all(asyncResults).then(function (values) {\n        return _this14._getAsyncRulesResult({\n          result: result,\n          values: values\n        });\n      });\n    }\n\n    return result;\n  },\n  _updateRuleConfig: function _updateRuleConfig(_ref2) {\n    var rule = _ref2.rule,\n        ruleResult = _ref2.ruleResult,\n        validator = _ref2.validator,\n        name = _ref2.name;\n    rule.isValid = ruleResult.isValid;\n\n    if (!ruleResult.isValid) {\n      if (_type2.default.isDefined(ruleResult.message) && _type2.default.isString(ruleResult.message) && ruleResult.message.length) {\n        rule.message = ruleResult.message;\n      } else {\n        this._setDefaultMessage({\n          rule: rule,\n          validator: validator,\n          name: name\n        });\n      }\n    }\n  },\n  _getPatchedRuleResult: function _getPatchedRuleResult(ruleResult) {\n    var result;\n    var isValid = true;\n\n    if (_type2.default.isObject(ruleResult)) {\n      result = (0, _extend.extend)({}, ruleResult);\n\n      if (!_type2.default.isDefined(result.isValid)) {\n        result.isValid = isValid;\n      }\n    } else {\n      result = {\n        isValid: _type2.default.isBoolean(ruleResult) ? ruleResult : isValid\n      };\n    }\n\n    return result;\n  },\n  _getAsyncRulesResult: function _getAsyncRulesResult(_ref3) {\n    var _this15 = this;\n\n    var values = _ref3.values,\n        result = _ref3.result;\n    (0, _iterator.each)(values, function (index, val) {\n      if (false === val.isValid) {\n        result.isValid = val.isValid;\n        var rule = result.pendingRules[index];\n\n        _this15._addBrokenRule({\n          result: result,\n          rule: rule\n        });\n      }\n    });\n    result.pendingRules = null;\n    result.complete = null;\n    result.status = result.isValid ? STATUS.valid : STATUS.invalid;\n    return result;\n  },\n  registerValidatorInGroup: function registerValidatorInGroup(group, validator) {\n    var groupConfig = ValidationEngine.addGroup(group);\n    groupConfig.registerValidator.call(groupConfig, validator);\n  },\n  _shouldRemoveGroup: function _shouldRemoveGroup(group, validatorsInGroup) {\n    var isDefaultGroup = void 0 === group;\n    var isValidationGroupInstance = group && \"dxValidationGroup\" === group.NAME;\n    return !isDefaultGroup && !isValidationGroupInstance && !validatorsInGroup.length;\n  },\n  removeRegisteredValidator: function removeRegisteredValidator(group, validator) {\n    var config = ValidationEngine.getGroupConfig(group);\n\n    if (config) {\n      config.removeRegisteredValidator.call(config, validator);\n      var validatorsInGroup = config.validators;\n\n      if (this._shouldRemoveGroup(group, validatorsInGroup)) {\n        this.removeGroup(group);\n      }\n    }\n  },\n  initValidationOptions: function initValidationOptions(options) {\n    var _this16 = this;\n\n    var initedOptions = {};\n\n    if (options) {\n      var syncOptions = [\"isValid\", \"validationStatus\", \"validationError\", \"validationErrors\"];\n      syncOptions.forEach(function (prop) {\n        if (prop in options) {\n          (0, _extend.extend)(initedOptions, _this16.synchronizeValidationOptions({\n            name: prop,\n            value: options[prop]\n          }, options));\n        }\n      });\n    }\n\n    return initedOptions;\n  },\n  synchronizeValidationOptions: function synchronizeValidationOptions(_ref4, options) {\n    var name = _ref4.name,\n        value = _ref4.value;\n\n    switch (name) {\n      case \"validationStatus\":\n        var isValid = value === STATUS.valid || value === STATUS.pending;\n        return options.isValid !== isValid ? {\n          isValid: isValid\n        } : {};\n\n      case \"isValid\":\n        var validationStatus = options.validationStatus;\n        var newStatus = validationStatus;\n\n        if (value && validationStatus === STATUS.invalid) {\n          newStatus = STATUS.valid;\n        } else {\n          if (!value && validationStatus !== STATUS.invalid) {\n            newStatus = STATUS.invalid;\n          }\n        }\n\n        return newStatus !== validationStatus ? {\n          validationStatus: newStatus\n        } : {};\n\n      case \"validationErrors\":\n        var validationError = !value || !value.length ? null : value[0];\n        return options.validationError !== validationError ? {\n          validationError: validationError\n        } : {};\n\n      case \"validationError\":\n        var validationErrors = options.validationErrors;\n\n        if (!value && validationErrors) {\n          return {\n            validationErrors: null\n          };\n        } else {\n          if (value && !validationErrors) {\n            return {\n              validationErrors: [value]\n            };\n          } else {\n            if (value && validationErrors && value !== validationErrors[0]) {\n              validationErrors[0] = value;\n              return {\n                validationErrors: validationErrors.slice()\n              };\n            }\n          }\n        }\n\n    }\n\n    return {};\n  },\n  validateGroup: function validateGroup(group) {\n    var groupConfig = ValidationEngine.getGroupConfig(group);\n\n    if (!groupConfig) {\n      throw _errors2.default.Error(\"E0110\");\n    }\n\n    return groupConfig.validate();\n  },\n  resetGroup: function resetGroup(group) {\n    var groupConfig = ValidationEngine.getGroupConfig(group);\n\n    if (!groupConfig) {\n      throw _errors2.default.Error(\"E0110\");\n    }\n\n    return groupConfig.reset();\n  }\n};\nValidationEngine.initGroups();\nmodule.exports = ValidationEngine;\nmodule.exports.default = module.exports;","map":{"version":3,"sources":["C:/Users/va112/Documents/Webdev/React/Corona/node_modules/devextreme/ui/validation_engine.js"],"names":["_class","require","_class2","_interopRequireDefault","_extend","_array","_iterator","_events_mixin","_events_mixin2","_errors","_errors2","_common","_type","_type2","_number","_number2","_message","_message2","_promise","_promise2","_deferred","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","_createSuper","Derived","result","Super","_getPrototypeOf","_isNativeReflectConstruct","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","o","Object","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","TypeError","create","value","writable","configurable","_setPrototypeOf","p","_classCallCheck","instance","Constructor","_defineProperties","target","props","i","length","descriptor","enumerable","defineProperty","key","_createClass","protoProps","staticProps","STATUS","valid","invalid","pending","BaseRuleValidator","NAME","default","getFormatter","concat","rulesValidators","required","validate","rule","_this","valueArray","Array","isArray","every","itemValue","_validate","RequiredRuleValidator","_BaseRuleValidator","_super","_this2","isDefined","String","trim","NumericRuleValidator","_BaseRuleValidator2","_super2","_this3","ignoreEmptyValue","_isValueEmpty","useCultureSettings","isString","isNaN","parse","isNumeric","RangeRuleValidator","_BaseRuleValidator3","_super3","_this4","validNumber","numeric","validValue","number","parseFloat","valueOf","min","max","isDate","Error","StringLengthRuleValidator","_BaseRuleValidator4","_super4","_this5","range","extend","CustomRuleValidator","_BaseRuleValidator5","_super5","_this6","validator","dataGetter","isFunction","option","extraParams","params","validationCallback","AsyncRuleValidator","_CustomRuleValidator","_super6","_this7","reevaluate","callbackResult","isPromise","_getWrappedPromise","fromPromise","promise","deferred","Deferred","then","res","resolve","err","isValid","message","isObject","CompareRuleValidator","_BaseRuleValidator6","_super7","_this8","comparisonTarget","otherValue","type","comparisonType","PatternRuleValidator","_BaseRuleValidator7","_super8","_this9","pattern","RegExp","test","EmailRuleValidator","_BaseRuleValidator8","_super9","_this10","stringLength","custom","async","compare","email","GroupConfig","inherit","ctor","group","validators","_pendingValidators","_onValidatorStatusChanged","bind","_resetValidationInfo","_this11","brokenRules","status","complete","_unsubscribeFromAllChangeEvents","each","_","validatorResult","push","_addPendingValidator","_subscribeToChangeEvents","_raiseValidatedEvent","_updateValidationInfo","_validationInfo","on","_unsubscribeFromChangeEvents","off","_this12","foundValidator","grep","val","_removePendingValidator","index","inArray","splice","_orderBrokenRules","orderedRules","foundRules","_updateBrokenRules","rules","_resolveIfComplete","setTimeout","fireEvent","_synchronizeValidationInfo","removeRegisteredValidator","registerValidator","reset","include","ValidationEngine","groups","getGroupConfig","config","findGroup","$element","model","$dxGroup","parents","first","dxValidationGroup","initGroups","addGroup","removeGroup","_setDefaultMessage","info","name","defaultFormattedMessage","defaultMessage","_addBrokenRule","brokenRule","_this13","validationRules","pendingRules","asyncRuleItems","ruleValidator","ruleValidationResult","_validateAsyncRules","items","_ref","_this14","asyncResults","item","validateResult","_updateRuleConfig","ruleResult","_getPatchedRuleResult","asyncResult","all","values","_getAsyncRulesResult","_ref2","isBoolean","_ref3","_this15","registerValidatorInGroup","groupConfig","_shouldRemoveGroup","validatorsInGroup","isDefaultGroup","isValidationGroupInstance","initValidationOptions","options","_this16","initedOptions","syncOptions","forEach","prop","synchronizeValidationOptions","_ref4","validationStatus","newStatus","validationError","validationErrors","slice","validateGroup","resetGroup","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/validation_engine.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _class = require(\"../core/class\");\r\nvar _class2 = _interopRequireDefault(_class);\r\nvar _extend = require(\"../core/utils/extend\");\r\nvar _array = require(\"../core/utils/array\");\r\nvar _iterator = require(\"../core/utils/iterator\");\r\nvar _events_mixin = require(\"../core/events_mixin\");\r\nvar _events_mixin2 = _interopRequireDefault(_events_mixin);\r\nvar _errors = require(\"../core/errors\");\r\nvar _errors2 = _interopRequireDefault(_errors);\r\nvar _common = require(\"../core/utils/common\");\r\nvar _type = require(\"../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _number = require(\"../localization/number\");\r\nvar _number2 = _interopRequireDefault(_number);\r\nvar _message = require(\"../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _promise = require(\"../core/polyfills/promise\");\r\nvar _promise2 = _interopRequireDefault(_promise);\r\nvar _deferred = require(\"../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _typeof(obj) {\r\n    \"@babel/helpers - typeof\";\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\n\r\nfunction _createSuper(Derived) {\r\n    return function() {\r\n        var result, Super = _getPrototypeOf(Derived);\r\n        if (_isNativeReflectConstruct()) {\r\n            var NewTarget = _getPrototypeOf(this).constructor;\r\n            result = Reflect.construct(Super, arguments, NewTarget)\r\n        } else {\r\n            result = Super.apply(this, arguments)\r\n        }\r\n        return _possibleConstructorReturn(this, result)\r\n    }\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n    if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\r\n        return call\r\n    }\r\n    return _assertThisInitialized(self)\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n    if (void 0 === self) {\r\n        throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\")\r\n    }\r\n    return self\r\n}\r\n\r\nfunction _isNativeReflectConstruct() {\r\n    if (\"undefined\" === typeof Reflect || !Reflect.construct) {\r\n        return false\r\n    }\r\n    if (Reflect.construct.sham) {\r\n        return false\r\n    }\r\n    if (\"function\" === typeof Proxy) {\r\n        return true\r\n    }\r\n    try {\r\n        Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\r\n        return true\r\n    } catch (e) {\r\n        return false\r\n    }\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function(o) {\r\n        return o.__proto__ || Object.getPrototypeOf(o)\r\n    };\r\n    return _getPrototypeOf(o)\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n    if (\"function\" !== typeof superClass && null !== superClass) {\r\n        throw new TypeError(\"Super expression must either be null or a function\")\r\n    }\r\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n        constructor: {\r\n            value: subClass,\r\n            writable: true,\r\n            configurable: true\r\n        }\r\n    });\r\n    if (superClass) {\r\n        _setPrototypeOf(subClass, superClass)\r\n    }\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n    _setPrototypeOf = Object.setPrototypeOf || function(o, p) {\r\n        o.__proto__ = p;\r\n        return o\r\n    };\r\n    return _setPrototypeOf(o, p)\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar STATUS = {\r\n    valid: \"valid\",\r\n    invalid: \"invalid\",\r\n    pending: \"pending\"\r\n};\r\nvar BaseRuleValidator = function() {\r\n    function BaseRuleValidator() {\r\n        _classCallCheck(this, BaseRuleValidator);\r\n        this.NAME = \"base\"\r\n    }\r\n    _createClass(BaseRuleValidator, [{\r\n        key: \"defaultMessage\",\r\n        value: function(value) {\r\n            return _message2.default.getFormatter(\"validation-\".concat(this.NAME))(value)\r\n        }\r\n    }, {\r\n        key: \"defaultFormattedMessage\",\r\n        value: function(value) {\r\n            return _message2.default.getFormatter(\"validation-\".concat(this.NAME, \"-formatted\"))(value)\r\n        }\r\n    }, {\r\n        key: \"_isValueEmpty\",\r\n        value: function(value) {\r\n            return !rulesValidators.required.validate(value, {})\r\n        }\r\n    }, {\r\n        key: \"validate\",\r\n        value: function(value, rule) {\r\n            var _this = this;\r\n            var valueArray = Array.isArray(value) ? value : [value];\r\n            var result = true;\r\n            if (valueArray.length) {\r\n                valueArray.every(function(itemValue) {\r\n                    result = _this._validate(itemValue, rule);\r\n                    return result\r\n                })\r\n            } else {\r\n                result = this._validate(null, rule)\r\n            }\r\n            return result\r\n        }\r\n    }]);\r\n    return BaseRuleValidator\r\n}();\r\nvar RequiredRuleValidator = function(_BaseRuleValidator) {\r\n    _inherits(RequiredRuleValidator, _BaseRuleValidator);\r\n    var _super = _createSuper(RequiredRuleValidator);\r\n\r\n    function RequiredRuleValidator() {\r\n        var _this2;\r\n        _classCallCheck(this, RequiredRuleValidator);\r\n        _this2 = _super.call(this);\r\n        _this2.NAME = \"required\";\r\n        return _this2\r\n    }\r\n    _createClass(RequiredRuleValidator, [{\r\n        key: \"_validate\",\r\n        value: function(value, rule) {\r\n            if (!_type2.default.isDefined(value)) {\r\n                return false\r\n            }\r\n            if (false === value) {\r\n                return false\r\n            }\r\n            value = String(value);\r\n            if (rule.trim || !_type2.default.isDefined(rule.trim)) {\r\n                value = value.trim()\r\n            }\r\n            return \"\" !== value\r\n        }\r\n    }]);\r\n    return RequiredRuleValidator\r\n}(BaseRuleValidator);\r\nvar NumericRuleValidator = function(_BaseRuleValidator2) {\r\n    _inherits(NumericRuleValidator, _BaseRuleValidator2);\r\n    var _super2 = _createSuper(NumericRuleValidator);\r\n\r\n    function NumericRuleValidator() {\r\n        var _this3;\r\n        _classCallCheck(this, NumericRuleValidator);\r\n        _this3 = _super2.call(this);\r\n        _this3.NAME = \"numeric\";\r\n        return _this3\r\n    }\r\n    _createClass(NumericRuleValidator, [{\r\n        key: \"_validate\",\r\n        value: function(value, rule) {\r\n            if (false !== rule.ignoreEmptyValue && this._isValueEmpty(value)) {\r\n                return true\r\n            }\r\n            if (rule.useCultureSettings && _type2.default.isString(value)) {\r\n                return !isNaN(_number2.default.parse(value))\r\n            } else {\r\n                return _type2.default.isNumeric(value)\r\n            }\r\n        }\r\n    }]);\r\n    return NumericRuleValidator\r\n}(BaseRuleValidator);\r\nvar RangeRuleValidator = function(_BaseRuleValidator3) {\r\n    _inherits(RangeRuleValidator, _BaseRuleValidator3);\r\n    var _super3 = _createSuper(RangeRuleValidator);\r\n\r\n    function RangeRuleValidator() {\r\n        var _this4;\r\n        _classCallCheck(this, RangeRuleValidator);\r\n        _this4 = _super3.call(this);\r\n        _this4.NAME = \"range\";\r\n        return _this4\r\n    }\r\n    _createClass(RangeRuleValidator, [{\r\n        key: \"_validate\",\r\n        value: function(value, rule) {\r\n            if (false !== rule.ignoreEmptyValue && this._isValueEmpty(value)) {\r\n                return true\r\n            }\r\n            var validNumber = rulesValidators.numeric.validate(value, rule);\r\n            var validValue = _type2.default.isDefined(value) && \"\" !== value;\r\n            var number = validNumber ? parseFloat(value) : validValue && value.valueOf();\r\n            var min = rule.min;\r\n            var max = rule.max;\r\n            if (!(validNumber || _type2.default.isDate(value)) && !validValue) {\r\n                return false\r\n            }\r\n            if (_type2.default.isDefined(min)) {\r\n                if (_type2.default.isDefined(max)) {\r\n                    return number >= min && number <= max\r\n                }\r\n                return number >= min\r\n            } else {\r\n                if (_type2.default.isDefined(max)) {\r\n                    return number <= max\r\n                } else {\r\n                    throw _errors2.default.Error(\"E0101\")\r\n                }\r\n            }\r\n        }\r\n    }]);\r\n    return RangeRuleValidator\r\n}(BaseRuleValidator);\r\nvar StringLengthRuleValidator = function(_BaseRuleValidator4) {\r\n    _inherits(StringLengthRuleValidator, _BaseRuleValidator4);\r\n    var _super4 = _createSuper(StringLengthRuleValidator);\r\n\r\n    function StringLengthRuleValidator() {\r\n        var _this5;\r\n        _classCallCheck(this, StringLengthRuleValidator);\r\n        _this5 = _super4.call(this);\r\n        _this5.NAME = \"stringLength\";\r\n        return _this5\r\n    }\r\n    _createClass(StringLengthRuleValidator, [{\r\n        key: \"_validate\",\r\n        value: function(value, rule) {\r\n            value = _type2.default.isDefined(value) ? String(value) : \"\";\r\n            if (rule.trim || !_type2.default.isDefined(rule.trim)) {\r\n                value = value.trim()\r\n            }\r\n            if (rule.ignoreEmptyValue && this._isValueEmpty(value)) {\r\n                return true\r\n            }\r\n            return rulesValidators.range.validate(value.length, (0, _extend.extend)({}, rule))\r\n        }\r\n    }]);\r\n    return StringLengthRuleValidator\r\n}(BaseRuleValidator);\r\nvar CustomRuleValidator = function(_BaseRuleValidator5) {\r\n    _inherits(CustomRuleValidator, _BaseRuleValidator5);\r\n    var _super5 = _createSuper(CustomRuleValidator);\r\n\r\n    function CustomRuleValidator() {\r\n        var _this6;\r\n        _classCallCheck(this, CustomRuleValidator);\r\n        _this6 = _super5.call(this);\r\n        _this6.NAME = \"custom\";\r\n        return _this6\r\n    }\r\n    _createClass(CustomRuleValidator, [{\r\n        key: \"validate\",\r\n        value: function(value, rule) {\r\n            if (rule.ignoreEmptyValue && this._isValueEmpty(value)) {\r\n                return true\r\n            }\r\n            var validator = rule.validator;\r\n            var dataGetter = validator && _type2.default.isFunction(validator.option) && validator.option(\"dataGetter\");\r\n            var extraParams = _type2.default.isFunction(dataGetter) && dataGetter();\r\n            var params = {\r\n                value: value,\r\n                validator: validator,\r\n                rule: rule\r\n            };\r\n            if (extraParams) {\r\n                (0, _extend.extend)(params, extraParams)\r\n            }\r\n            return rule.validationCallback(params)\r\n        }\r\n    }]);\r\n    return CustomRuleValidator\r\n}(BaseRuleValidator);\r\nvar AsyncRuleValidator = function(_CustomRuleValidator) {\r\n    _inherits(AsyncRuleValidator, _CustomRuleValidator);\r\n    var _super6 = _createSuper(AsyncRuleValidator);\r\n\r\n    function AsyncRuleValidator() {\r\n        var _this7;\r\n        _classCallCheck(this, AsyncRuleValidator);\r\n        _this7 = _super6.call(this);\r\n        _this7.NAME = \"async\";\r\n        return _this7\r\n    }\r\n    _createClass(AsyncRuleValidator, [{\r\n        key: \"validate\",\r\n        value: function(value, rule) {\r\n            if (!_type2.default.isDefined(rule.reevaluate)) {\r\n                (0, _extend.extend)(rule, {\r\n                    reevaluate: true\r\n                })\r\n            }\r\n            if (rule.ignoreEmptyValue && this._isValueEmpty(value)) {\r\n                return true\r\n            }\r\n            var validator = rule.validator;\r\n            var dataGetter = validator && _type2.default.isFunction(validator.option) && validator.option(\"dataGetter\");\r\n            var extraParams = _type2.default.isFunction(dataGetter) && dataGetter();\r\n            var params = {\r\n                value: value,\r\n                validator: validator,\r\n                rule: rule\r\n            };\r\n            if (extraParams) {\r\n                (0, _extend.extend)(params, extraParams)\r\n            }\r\n            var callbackResult = rule.validationCallback(params);\r\n            if (!_type2.default.isPromise(callbackResult)) {\r\n                throw _errors2.default.Error(\"E0103\")\r\n            }\r\n            return this._getWrappedPromise((0, _deferred.fromPromise)(callbackResult).promise())\r\n        }\r\n    }, {\r\n        key: \"_getWrappedPromise\",\r\n        value: function(promise) {\r\n            var deferred = new _deferred.Deferred;\r\n            promise.then(function(res) {\r\n                deferred.resolve(res)\r\n            }, function(err) {\r\n                var res = {\r\n                    isValid: false\r\n                };\r\n                if (_type2.default.isDefined(err)) {\r\n                    if (_type2.default.isString(err)) {\r\n                        res.message = err\r\n                    } else {\r\n                        if (_type2.default.isObject(err) && _type2.default.isDefined(err.message) && _type2.default.isString(err.message)) {\r\n                            res.message = err.message\r\n                        }\r\n                    }\r\n                }\r\n                deferred.resolve(res)\r\n            });\r\n            return deferred.promise()\r\n        }\r\n    }]);\r\n    return AsyncRuleValidator\r\n}(CustomRuleValidator);\r\nvar CompareRuleValidator = function(_BaseRuleValidator6) {\r\n    _inherits(CompareRuleValidator, _BaseRuleValidator6);\r\n    var _super7 = _createSuper(CompareRuleValidator);\r\n\r\n    function CompareRuleValidator() {\r\n        var _this8;\r\n        _classCallCheck(this, CompareRuleValidator);\r\n        _this8 = _super7.call(this);\r\n        _this8.NAME = \"compare\";\r\n        return _this8\r\n    }\r\n    _createClass(CompareRuleValidator, [{\r\n        key: \"_validate\",\r\n        value: function(value, rule) {\r\n            if (!rule.comparisonTarget) {\r\n                throw _errors2.default.Error(\"E0102\")\r\n            }\r\n            if (rule.ignoreEmptyValue && this._isValueEmpty(value)) {\r\n                return true\r\n            }(0, _extend.extend)(rule, {\r\n                reevaluate: true\r\n            });\r\n            var otherValue = rule.comparisonTarget();\r\n            var type = rule.comparisonType || \"==\";\r\n            switch (type) {\r\n                case \"==\":\r\n                    return value == otherValue;\r\n                case \"!=\":\r\n                    return value != otherValue;\r\n                case \"===\":\r\n                    return value === otherValue;\r\n                case \"!==\":\r\n                    return value !== otherValue;\r\n                case \">\":\r\n                    return value > otherValue;\r\n                case \">=\":\r\n                    return value >= otherValue;\r\n                case \"<\":\r\n                    return value < otherValue;\r\n                case \"<=\":\r\n                    return value <= otherValue\r\n            }\r\n        }\r\n    }]);\r\n    return CompareRuleValidator\r\n}(BaseRuleValidator);\r\nvar PatternRuleValidator = function(_BaseRuleValidator7) {\r\n    _inherits(PatternRuleValidator, _BaseRuleValidator7);\r\n    var _super8 = _createSuper(PatternRuleValidator);\r\n\r\n    function PatternRuleValidator() {\r\n        var _this9;\r\n        _classCallCheck(this, PatternRuleValidator);\r\n        _this9 = _super8.call(this);\r\n        _this9.NAME = \"pattern\";\r\n        return _this9\r\n    }\r\n    _createClass(PatternRuleValidator, [{\r\n        key: \"_validate\",\r\n        value: function(value, rule) {\r\n            if (false !== rule.ignoreEmptyValue && this._isValueEmpty(value)) {\r\n                return true\r\n            }\r\n            var pattern = rule.pattern;\r\n            if (_type2.default.isString(pattern)) {\r\n                pattern = new RegExp(pattern)\r\n            }\r\n            return pattern.test(value)\r\n        }\r\n    }]);\r\n    return PatternRuleValidator\r\n}(BaseRuleValidator);\r\nvar EmailRuleValidator = function(_BaseRuleValidator8) {\r\n    _inherits(EmailRuleValidator, _BaseRuleValidator8);\r\n    var _super9 = _createSuper(EmailRuleValidator);\r\n\r\n    function EmailRuleValidator() {\r\n        var _this10;\r\n        _classCallCheck(this, EmailRuleValidator);\r\n        _this10 = _super9.call(this);\r\n        _this10.NAME = \"email\";\r\n        return _this10\r\n    }\r\n    _createClass(EmailRuleValidator, [{\r\n        key: \"_validate\",\r\n        value: function(value, rule) {\r\n            if (false !== rule.ignoreEmptyValue && this._isValueEmpty(value)) {\r\n                return true\r\n            }\r\n            return rulesValidators.pattern.validate(value, (0, _extend.extend)({}, rule, {\r\n                pattern: /^[\\d\\w._-]+@([\\d\\w._-]+\\.)+[\\w]+$/i\r\n            }))\r\n        }\r\n    }]);\r\n    return EmailRuleValidator\r\n}(BaseRuleValidator);\r\nvar rulesValidators = {\r\n    required: new RequiredRuleValidator,\r\n    numeric: new NumericRuleValidator,\r\n    range: new RangeRuleValidator,\r\n    stringLength: new StringLengthRuleValidator,\r\n    custom: new CustomRuleValidator,\r\n    async: new AsyncRuleValidator,\r\n    compare: new CompareRuleValidator,\r\n    pattern: new PatternRuleValidator,\r\n    email: new EmailRuleValidator\r\n};\r\nvar GroupConfig = _class2.default.inherit({\r\n    ctor: function(group) {\r\n        this.group = group;\r\n        this.validators = [];\r\n        this._pendingValidators = [];\r\n        this._onValidatorStatusChanged = this._onValidatorStatusChanged.bind(this);\r\n        this._resetValidationInfo()\r\n    },\r\n    validate: function() {\r\n        var _this11 = this;\r\n        var result = {\r\n            isValid: true,\r\n            brokenRules: [],\r\n            validators: [],\r\n            status: STATUS.valid,\r\n            complete: null\r\n        };\r\n        this._unsubscribeFromAllChangeEvents();\r\n        this._pendingValidators = [];\r\n        this._resetValidationInfo();\r\n        (0, _iterator.each)(this.validators, function(_, validator) {\r\n            var validatorResult = validator.validate();\r\n            result.isValid = result.isValid && validatorResult.isValid;\r\n            if (validatorResult.brokenRules) {\r\n                result.brokenRules = result.brokenRules.concat(validatorResult.brokenRules)\r\n            }\r\n            result.validators.push(validator);\r\n            if (validatorResult.status === STATUS.pending) {\r\n                _this11._addPendingValidator(validator)\r\n            }\r\n            _this11._subscribeToChangeEvents(validator)\r\n        });\r\n        if (this._pendingValidators.length) {\r\n            result.status = STATUS.pending\r\n        } else {\r\n            result.status = result.isValid ? STATUS.valid : STATUS.invalid;\r\n            this._unsubscribeFromAllChangeEvents();\r\n            this._raiseValidatedEvent(result)\r\n        }\r\n        this._updateValidationInfo(result);\r\n        return (0, _extend.extend)({}, this._validationInfo.result)\r\n    },\r\n    _subscribeToChangeEvents: function(validator) {\r\n        validator.on(\"validating\", this._onValidatorStatusChanged);\r\n        validator.on(\"validated\", this._onValidatorStatusChanged)\r\n    },\r\n    _unsubscribeFromChangeEvents: function(validator) {\r\n        validator.off(\"validating\", this._onValidatorStatusChanged);\r\n        validator.off(\"validated\", this._onValidatorStatusChanged)\r\n    },\r\n    _unsubscribeFromAllChangeEvents: function() {\r\n        var _this12 = this;\r\n        (0, _iterator.each)(this.validators, function(_, validator) {\r\n            _this12._unsubscribeFromChangeEvents(validator)\r\n        })\r\n    },\r\n    _updateValidationInfo: function(result) {\r\n        this._validationInfo.result = result;\r\n        if (result.status !== STATUS.pending) {\r\n            return\r\n        }\r\n        if (!this._validationInfo.deferred) {\r\n            this._validationInfo.deferred = new _deferred.Deferred;\r\n            this._validationInfo.result.complete = this._validationInfo.deferred.promise()\r\n        }\r\n    },\r\n    _addPendingValidator: function(validator) {\r\n        var foundValidator = (0, _common.grep)(this._pendingValidators, function(val) {\r\n            return val === validator\r\n        })[0];\r\n        if (!foundValidator) {\r\n            this._pendingValidators.push(validator)\r\n        }\r\n    },\r\n    _removePendingValidator: function(validator) {\r\n        var index = (0, _array.inArray)(validator, this._pendingValidators);\r\n        if (index >= 0) {\r\n            this._pendingValidators.splice(index, 1)\r\n        }\r\n    },\r\n    _orderBrokenRules: function(brokenRules) {\r\n        var orderedRules = [];\r\n        (0, _iterator.each)(this.validators, function(_, validator) {\r\n            var foundRules = (0, _common.grep)(brokenRules, function(rule) {\r\n                return rule.validator === validator\r\n            });\r\n            if (foundRules.length) {\r\n                orderedRules = orderedRules.concat(foundRules)\r\n            }\r\n        });\r\n        return orderedRules\r\n    },\r\n    _updateBrokenRules: function(result) {\r\n        if (!this._validationInfo.result) {\r\n            return\r\n        }\r\n        var brokenRules = this._validationInfo.result.brokenRules;\r\n        var rules = (0, _common.grep)(brokenRules, function(rule) {\r\n            return rule.validator !== result.validator\r\n        });\r\n        if (result.brokenRules) {\r\n            brokenRules = rules.concat(result.brokenRules)\r\n        }\r\n        this._validationInfo.result.brokenRules = this._orderBrokenRules(brokenRules)\r\n    },\r\n    _onValidatorStatusChanged: function(result) {\r\n        if (result.status === STATUS.pending) {\r\n            this._addPendingValidator(result.validator);\r\n            return\r\n        }\r\n        this._resolveIfComplete(result)\r\n    },\r\n    _resolveIfComplete: function(result) {\r\n        this._removePendingValidator(result.validator);\r\n        this._updateBrokenRules(result);\r\n        if (!this._pendingValidators.length) {\r\n            this._unsubscribeFromAllChangeEvents();\r\n            if (!this._validationInfo.result) {\r\n                return\r\n            }\r\n            this._validationInfo.result.status = 0 === this._validationInfo.result.brokenRules.length ? STATUS.valid : STATUS.invalid;\r\n            this._validationInfo.result.isValid = this._validationInfo.result.status === STATUS.valid;\r\n            var res = (0, _extend.extend)({}, this._validationInfo.result, {\r\n                complete: null\r\n            });\r\n            var deferred = this._validationInfo.deferred;\r\n            this._resetValidationInfo();\r\n            this._raiseValidatedEvent(res);\r\n            deferred && setTimeout(function() {\r\n                deferred.resolve(res)\r\n            })\r\n        }\r\n    },\r\n    _raiseValidatedEvent: function(result) {\r\n        this.fireEvent(\"validated\", [result])\r\n    },\r\n    _resetValidationInfo: function() {\r\n        this._validationInfo = {\r\n            result: null,\r\n            deferred: null\r\n        }\r\n    },\r\n    _synchronizeValidationInfo: function() {\r\n        if (this._validationInfo.result) {\r\n            this._validationInfo.result.validators = this.validators\r\n        }\r\n    },\r\n    removeRegisteredValidator: function(validator) {\r\n        var index = (0, _array.inArray)(validator, this.validators);\r\n        if (index > -1) {\r\n            this.validators.splice(index, 1);\r\n            this._synchronizeValidationInfo();\r\n            this._resolveIfComplete({\r\n                validator: validator\r\n            })\r\n        }\r\n    },\r\n    registerValidator: function(validator) {\r\n        if ((0, _array.inArray)(validator, this.validators) < 0) {\r\n            this.validators.push(validator);\r\n            this._synchronizeValidationInfo()\r\n        }\r\n    },\r\n    reset: function() {\r\n        (0, _iterator.each)(this.validators, function(_, validator) {\r\n            validator.reset()\r\n        });\r\n        this._pendingValidators = [];\r\n        this._resetValidationInfo()\r\n    }\r\n}).include(_events_mixin2.default);\r\nvar ValidationEngine = {\r\n    groups: [],\r\n    getGroupConfig: function(group) {\r\n        var result = (0, _common.grep)(this.groups, function(config) {\r\n            return config.group === group\r\n        });\r\n        if (result.length) {\r\n            return result[0]\r\n        }\r\n    },\r\n    findGroup: function($element, model) {\r\n        var $dxGroup = $element.parents(\".dx-validationgroup\").first();\r\n        if ($dxGroup.length) {\r\n            return $dxGroup.dxValidationGroup(\"instance\")\r\n        }\r\n        return model\r\n    },\r\n    initGroups: function() {\r\n        this.groups = [];\r\n        this.addGroup()\r\n    },\r\n    addGroup: function(group) {\r\n        var config = this.getGroupConfig(group);\r\n        if (!config) {\r\n            config = new GroupConfig(group);\r\n            this.groups.push(config)\r\n        }\r\n        return config\r\n    },\r\n    removeGroup: function(group) {\r\n        var config = this.getGroupConfig(group);\r\n        var index = (0, _array.inArray)(config, this.groups);\r\n        if (index > -1) {\r\n            this.groups.splice(index, 1)\r\n        }\r\n        return config\r\n    },\r\n    _setDefaultMessage: function(info) {\r\n        var rule = info.rule,\r\n            validator = info.validator,\r\n            name = info.name;\r\n        if (!_type2.default.isDefined(rule.message)) {\r\n            if (validator.defaultFormattedMessage && _type2.default.isDefined(name)) {\r\n                rule.message = validator.defaultFormattedMessage(name)\r\n            } else {\r\n                rule.message = validator.defaultMessage()\r\n            }\r\n        }\r\n    },\r\n    _addBrokenRule: function(info) {\r\n        var result = info.result,\r\n            rule = info.rule;\r\n        if (!result.brokenRule) {\r\n            result.brokenRule = rule\r\n        }\r\n        if (!result.brokenRules) {\r\n            result.brokenRules = []\r\n        }\r\n        result.brokenRules.push(rule)\r\n    },\r\n    validate: function(value, rules, name) {\r\n        var _this13 = this;\r\n        var result = {\r\n            name: name,\r\n            value: value,\r\n            brokenRule: null,\r\n            brokenRules: null,\r\n            isValid: true,\r\n            validationRules: rules,\r\n            pendingRules: null,\r\n            status: STATUS.valid,\r\n            complete: null\r\n        };\r\n        var asyncRuleItems = [];\r\n        (0, _iterator.each)(rules || [], function(_, rule) {\r\n            var ruleValidator = rulesValidators[rule.type];\r\n            var ruleValidationResult;\r\n            if (ruleValidator) {\r\n                if (_type2.default.isDefined(rule.isValid) && rule.value === value && !rule.reevaluate) {\r\n                    if (!rule.isValid) {\r\n                        result.isValid = false;\r\n                        _this13._addBrokenRule({\r\n                            result: result,\r\n                            rule: rule\r\n                        });\r\n                        return false\r\n                    }\r\n                    return true\r\n                }\r\n                rule.value = value;\r\n                if (\"async\" === rule.type) {\r\n                    asyncRuleItems.push({\r\n                        rule: rule,\r\n                        ruleValidator: ruleValidator\r\n                    });\r\n                    return true\r\n                }\r\n                ruleValidationResult = ruleValidator.validate(value, rule);\r\n                rule.isValid = ruleValidationResult;\r\n                if (!ruleValidationResult) {\r\n                    result.isValid = false;\r\n                    _this13._setDefaultMessage({\r\n                        rule: rule,\r\n                        validator: ruleValidator,\r\n                        name: name\r\n                    });\r\n                    _this13._addBrokenRule({\r\n                        result: result,\r\n                        rule: rule\r\n                    })\r\n                }\r\n                if (!rule.isValid) {\r\n                    return false\r\n                }\r\n            } else {\r\n                throw _errors2.default.Error(\"E0100\")\r\n            }\r\n        });\r\n        if (result.isValid && !result.brokenRules && asyncRuleItems.length) {\r\n            result = this._validateAsyncRules({\r\n                value: value,\r\n                items: asyncRuleItems,\r\n                result: result,\r\n                name: name\r\n            })\r\n        }\r\n        result.status = result.pendingRules ? STATUS.pending : result.isValid ? STATUS.valid : STATUS.invalid;\r\n        return result\r\n    },\r\n    _validateAsyncRules: function(_ref) {\r\n        var _this14 = this;\r\n        var result = _ref.result,\r\n            value = _ref.value,\r\n            items = _ref.items,\r\n            name = _ref.name;\r\n        var asyncResults = [];\r\n        (0, _iterator.each)(items, function(_, item) {\r\n            var validateResult = item.ruleValidator.validate(value, item.rule);\r\n            if (!_type2.default.isPromise(validateResult)) {\r\n                _this14._updateRuleConfig({\r\n                    rule: item.rule,\r\n                    ruleResult: _this14._getPatchedRuleResult(validateResult),\r\n                    validator: item.ruleValidator,\r\n                    name: name\r\n                })\r\n            } else {\r\n                if (!result.pendingRules) {\r\n                    result.pendingRules = []\r\n                }\r\n                result.pendingRules.push(item.rule);\r\n                var asyncResult = validateResult.then(function(res) {\r\n                    var ruleResult = _this14._getPatchedRuleResult(res);\r\n                    _this14._updateRuleConfig({\r\n                        rule: item.rule,\r\n                        ruleResult: ruleResult,\r\n                        validator: item.ruleValidator,\r\n                        name: name\r\n                    });\r\n                    return ruleResult\r\n                });\r\n                asyncResults.push(asyncResult)\r\n            }\r\n        });\r\n        if (asyncResults.length) {\r\n            result.complete = _promise2.default.all(asyncResults).then(function(values) {\r\n                return _this14._getAsyncRulesResult({\r\n                    result: result,\r\n                    values: values\r\n                })\r\n            })\r\n        }\r\n        return result\r\n    },\r\n    _updateRuleConfig: function(_ref2) {\r\n        var rule = _ref2.rule,\r\n            ruleResult = _ref2.ruleResult,\r\n            validator = _ref2.validator,\r\n            name = _ref2.name;\r\n        rule.isValid = ruleResult.isValid;\r\n        if (!ruleResult.isValid) {\r\n            if (_type2.default.isDefined(ruleResult.message) && _type2.default.isString(ruleResult.message) && ruleResult.message.length) {\r\n                rule.message = ruleResult.message\r\n            } else {\r\n                this._setDefaultMessage({\r\n                    rule: rule,\r\n                    validator: validator,\r\n                    name: name\r\n                })\r\n            }\r\n        }\r\n    },\r\n    _getPatchedRuleResult: function(ruleResult) {\r\n        var result;\r\n        var isValid = true;\r\n        if (_type2.default.isObject(ruleResult)) {\r\n            result = (0, _extend.extend)({}, ruleResult);\r\n            if (!_type2.default.isDefined(result.isValid)) {\r\n                result.isValid = isValid\r\n            }\r\n        } else {\r\n            result = {\r\n                isValid: _type2.default.isBoolean(ruleResult) ? ruleResult : isValid\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    _getAsyncRulesResult: function(_ref3) {\r\n        var _this15 = this;\r\n        var values = _ref3.values,\r\n            result = _ref3.result;\r\n        (0, _iterator.each)(values, function(index, val) {\r\n            if (false === val.isValid) {\r\n                result.isValid = val.isValid;\r\n                var rule = result.pendingRules[index];\r\n                _this15._addBrokenRule({\r\n                    result: result,\r\n                    rule: rule\r\n                })\r\n            }\r\n        });\r\n        result.pendingRules = null;\r\n        result.complete = null;\r\n        result.status = result.isValid ? STATUS.valid : STATUS.invalid;\r\n        return result\r\n    },\r\n    registerValidatorInGroup: function(group, validator) {\r\n        var groupConfig = ValidationEngine.addGroup(group);\r\n        groupConfig.registerValidator.call(groupConfig, validator)\r\n    },\r\n    _shouldRemoveGroup: function(group, validatorsInGroup) {\r\n        var isDefaultGroup = void 0 === group;\r\n        var isValidationGroupInstance = group && \"dxValidationGroup\" === group.NAME;\r\n        return !isDefaultGroup && !isValidationGroupInstance && !validatorsInGroup.length\r\n    },\r\n    removeRegisteredValidator: function(group, validator) {\r\n        var config = ValidationEngine.getGroupConfig(group);\r\n        if (config) {\r\n            config.removeRegisteredValidator.call(config, validator);\r\n            var validatorsInGroup = config.validators;\r\n            if (this._shouldRemoveGroup(group, validatorsInGroup)) {\r\n                this.removeGroup(group)\r\n            }\r\n        }\r\n    },\r\n    initValidationOptions: function(options) {\r\n        var _this16 = this;\r\n        var initedOptions = {};\r\n        if (options) {\r\n            var syncOptions = [\"isValid\", \"validationStatus\", \"validationError\", \"validationErrors\"];\r\n            syncOptions.forEach(function(prop) {\r\n                if (prop in options) {\r\n                    (0, _extend.extend)(initedOptions, _this16.synchronizeValidationOptions({\r\n                        name: prop,\r\n                        value: options[prop]\r\n                    }, options))\r\n                }\r\n            })\r\n        }\r\n        return initedOptions\r\n    },\r\n    synchronizeValidationOptions: function(_ref4, options) {\r\n        var name = _ref4.name,\r\n            value = _ref4.value;\r\n        switch (name) {\r\n            case \"validationStatus\":\r\n                var isValid = value === STATUS.valid || value === STATUS.pending;\r\n                return options.isValid !== isValid ? {\r\n                    isValid: isValid\r\n                } : {};\r\n            case \"isValid\":\r\n                var validationStatus = options.validationStatus;\r\n                var newStatus = validationStatus;\r\n                if (value && validationStatus === STATUS.invalid) {\r\n                    newStatus = STATUS.valid\r\n                } else {\r\n                    if (!value && validationStatus !== STATUS.invalid) {\r\n                        newStatus = STATUS.invalid\r\n                    }\r\n                }\r\n                return newStatus !== validationStatus ? {\r\n                    validationStatus: newStatus\r\n                } : {};\r\n            case \"validationErrors\":\r\n                var validationError = !value || !value.length ? null : value[0];\r\n                return options.validationError !== validationError ? {\r\n                    validationError: validationError\r\n                } : {};\r\n            case \"validationError\":\r\n                var validationErrors = options.validationErrors;\r\n                if (!value && validationErrors) {\r\n                    return {\r\n                        validationErrors: null\r\n                    }\r\n                } else {\r\n                    if (value && !validationErrors) {\r\n                        return {\r\n                            validationErrors: [value]\r\n                        }\r\n                    } else {\r\n                        if (value && validationErrors && value !== validationErrors[0]) {\r\n                            validationErrors[0] = value;\r\n                            return {\r\n                                validationErrors: validationErrors.slice()\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n        }\r\n        return {}\r\n    },\r\n    validateGroup: function(group) {\r\n        var groupConfig = ValidationEngine.getGroupConfig(group);\r\n        if (!groupConfig) {\r\n            throw _errors2.default.Error(\"E0110\")\r\n        }\r\n        return groupConfig.validate()\r\n    },\r\n    resetGroup: function(group) {\r\n        var groupConfig = ValidationEngine.getGroupConfig(group);\r\n        if (!groupConfig) {\r\n            throw _errors2.default.Error(\"E0110\")\r\n        }\r\n        return groupConfig.reset()\r\n    }\r\n};\r\nValidationEngine.initGroups();\r\nmodule.exports = ValidationEngine;\r\nmodule.exports.default = module.exports;\r\n"]},"metadata":{},"sourceType":"script"}