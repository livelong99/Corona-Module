{"ast":null,"code":"/**\r\n * DevExtreme (data/array_utils.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _type = require(\"../core/utils/type\");\n\nvar _config = require(\"../core/config\");\n\nvar _config2 = _interopRequireDefault(_config);\n\nvar _guid = require(\"../core/guid\");\n\nvar _guid2 = _interopRequireDefault(_guid);\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _errors = require(\"./errors\");\n\nvar _object = require(\"../core/utils/object\");\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _utils = require(\"./utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction hasKey(target, keyOrKeys) {\n  var key;\n  var keys = \"string\" === typeof keyOrKeys ? keyOrKeys.split() : keyOrKeys.slice();\n\n  while (keys.length) {\n    key = keys.shift();\n\n    if (key in target) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction findItems(keyInfo, items, key, groupCount) {\n  var childItems;\n  var result;\n\n  if (groupCount) {\n    for (var i = 0; i < items.length; i++) {\n      childItems = items[i].items || items[i].collapsedItems || [];\n      result = findItems(keyInfo, childItems || [], key, groupCount - 1);\n\n      if (result) {\n        return result;\n      }\n    }\n  } else {\n    if (indexByKey(keyInfo, items, key) >= 0) {\n      return items;\n    }\n  }\n}\n\nfunction getItems(keyInfo, items, key, groupCount) {\n  if (groupCount) {\n    return findItems(keyInfo, items, key, groupCount) || [];\n  }\n\n  return items;\n}\n\nfunction generateDataByKeyMap(keyInfo, array) {\n  if (keyInfo.key() && (!array._dataByKeyMap || array._dataByKeyMapLength !== array.length)) {\n    var dataByKeyMap = {};\n\n    for (var i = 0, arrayLength = array.length; i < arrayLength; i++) {\n      dataByKeyMap[JSON.stringify(keyInfo.keyOf(array[i]))] = array[i];\n    }\n\n    array._dataByKeyMap = dataByKeyMap;\n    array._dataByKeyMapLength = arrayLength;\n  }\n}\n\nfunction getCacheValue(array, key) {\n  if (array._dataByKeyMap) {\n    return array._dataByKeyMap[JSON.stringify(key)];\n  }\n}\n\nfunction getHasKeyCacheValue(array, key) {\n  if (array._dataByKeyMap) {\n    return array._dataByKeyMap[JSON.stringify(key)];\n  }\n\n  return true;\n}\n\nfunction setDataByKeyMapValue(array, key, data) {\n  if (array._dataByKeyMap) {\n    array._dataByKeyMap[JSON.stringify(key)] = data;\n  }\n}\n\nfunction applyBatch(keyInfo, array, batchData, groupCount, useInsertIndex) {\n  batchData.forEach(function (item) {\n    var items = \"insert\" === item.type ? array : getItems(keyInfo, array, item.key, groupCount);\n    generateDataByKeyMap(keyInfo, items);\n\n    switch (item.type) {\n      case \"update\":\n        update(keyInfo, items, item.key, item.data, true);\n        break;\n\n      case \"insert\":\n        insert(keyInfo, items, item.data, useInsertIndex && (0, _type.isDefined)(item.index) ? item.index : -1, true);\n        break;\n\n      case \"remove\":\n        remove(keyInfo, items, item.key, true);\n    }\n  });\n}\n\nfunction update(keyInfo, array, key, data, isBatch) {\n  var target;\n  var extendComplexObject = true;\n  var keyExpr = keyInfo.key();\n\n  if (keyExpr) {\n    if (hasKey(data, keyExpr) && !(0, _utils.keysEqual)(key, keyInfo.keyOf(data))) {\n      return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4017\"));\n    }\n\n    target = getCacheValue(array, key);\n\n    if (!target) {\n      var index = indexByKey(keyInfo, array, key);\n\n      if (index < 0) {\n        return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4009\"));\n      }\n\n      target = array[index];\n    }\n  } else {\n    target = key;\n  }\n\n  _object2.default.deepExtendArraySafe(target, data, extendComplexObject);\n\n  if (!isBatch) {\n    if ((0, _config2.default)().useLegacyStoreResult) {\n      return (0, _utils.trivialPromise)(key, data);\n    } else {\n      return (0, _utils.trivialPromise)(target, key);\n    }\n  }\n}\n\nfunction insert(keyInfo, array, data, index, isBatch) {\n  var keyValue;\n  var obj;\n  var keyExpr = keyInfo.key();\n  obj = (0, _type.isPlainObject)(data) ? (0, _extend.extend)({}, data) : data;\n\n  if (keyExpr) {\n    keyValue = keyInfo.keyOf(obj);\n\n    if (void 0 === keyValue || \"object\" === _typeof(keyValue) && (0, _type.isEmptyObject)(keyValue)) {\n      if (Array.isArray(keyExpr)) {\n        throw _errors.errors.Error(\"E4007\");\n      }\n\n      keyValue = obj[keyExpr] = String(new _guid2.default());\n    } else {\n      if (void 0 !== array[indexByKey(keyInfo, array, keyValue)]) {\n        return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4008\"));\n      }\n    }\n  } else {\n    keyValue = obj;\n  }\n\n  if (index >= 0) {\n    array.splice(index, 0, obj);\n  } else {\n    array.push(obj);\n  }\n\n  setDataByKeyMapValue(array, keyValue, obj);\n\n  if (!isBatch) {\n    return (0, _utils.trivialPromise)((0, _config2.default)().useLegacyStoreResult ? data : obj, keyValue);\n  }\n}\n\nfunction remove(keyInfo, array, key, isBatch) {\n  var index = indexByKey(keyInfo, array, key);\n\n  if (index > -1) {\n    array.splice(index, 1);\n  }\n\n  if (!isBatch) {\n    return (0, _utils.trivialPromise)(key);\n  }\n}\n\nfunction indexByKey(keyInfo, array, key) {\n  if (!getHasKeyCacheValue(array, key)) {\n    return -1;\n  }\n\n  for (var i = 0, arrayLength = array.length; i < arrayLength; i++) {\n    if ((0, _utils.keysEqual)(keyInfo.keyOf(array[i]), key)) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\nmodule.exports.applyBatch = applyBatch;\nmodule.exports.update = update;\nmodule.exports.insert = insert;\nmodule.exports.remove = remove;\nmodule.exports.indexByKey = indexByKey;","map":{"version":3,"sources":["C:/Users/va112/Documents/Webdev/React/Corona/node_modules/devextreme/data/array_utils.js"],"names":["_type","require","_config","_config2","_interopRequireDefault","_guid","_guid2","_extend","_errors","_object","_object2","_utils","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","hasKey","target","keyOrKeys","key","keys","split","slice","length","shift","findItems","keyInfo","items","groupCount","childItems","result","i","collapsedItems","indexByKey","getItems","generateDataByKeyMap","array","_dataByKeyMap","_dataByKeyMapLength","dataByKeyMap","arrayLength","JSON","stringify","keyOf","getCacheValue","getHasKeyCacheValue","setDataByKeyMapValue","data","applyBatch","batchData","useInsertIndex","forEach","item","type","update","insert","isDefined","index","remove","isBatch","extendComplexObject","keyExpr","keysEqual","rejectedPromise","errors","Error","default","deepExtendArraySafe","useLegacyStoreResult","trivialPromise","keyValue","isPlainObject","extend","isEmptyObject","Array","isArray","String","splice","push","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (data/array_utils.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _type = require(\"../core/utils/type\");\r\nvar _config = require(\"../core/config\");\r\nvar _config2 = _interopRequireDefault(_config);\r\nvar _guid = require(\"../core/guid\");\r\nvar _guid2 = _interopRequireDefault(_guid);\r\nvar _extend = require(\"../core/utils/extend\");\r\nvar _errors = require(\"./errors\");\r\nvar _object = require(\"../core/utils/object\");\r\nvar _object2 = _interopRequireDefault(_object);\r\nvar _utils = require(\"./utils\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _typeof(obj) {\r\n    \"@babel/helpers - typeof\";\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\n\r\nfunction hasKey(target, keyOrKeys) {\r\n    var key;\r\n    var keys = \"string\" === typeof keyOrKeys ? keyOrKeys.split() : keyOrKeys.slice();\r\n    while (keys.length) {\r\n        key = keys.shift();\r\n        if (key in target) {\r\n            return true\r\n        }\r\n    }\r\n    return false\r\n}\r\n\r\nfunction findItems(keyInfo, items, key, groupCount) {\r\n    var childItems;\r\n    var result;\r\n    if (groupCount) {\r\n        for (var i = 0; i < items.length; i++) {\r\n            childItems = items[i].items || items[i].collapsedItems || [];\r\n            result = findItems(keyInfo, childItems || [], key, groupCount - 1);\r\n            if (result) {\r\n                return result\r\n            }\r\n        }\r\n    } else {\r\n        if (indexByKey(keyInfo, items, key) >= 0) {\r\n            return items\r\n        }\r\n    }\r\n}\r\n\r\nfunction getItems(keyInfo, items, key, groupCount) {\r\n    if (groupCount) {\r\n        return findItems(keyInfo, items, key, groupCount) || []\r\n    }\r\n    return items\r\n}\r\n\r\nfunction generateDataByKeyMap(keyInfo, array) {\r\n    if (keyInfo.key() && (!array._dataByKeyMap || array._dataByKeyMapLength !== array.length)) {\r\n        var dataByKeyMap = {};\r\n        for (var i = 0, arrayLength = array.length; i < arrayLength; i++) {\r\n            dataByKeyMap[JSON.stringify(keyInfo.keyOf(array[i]))] = array[i]\r\n        }\r\n        array._dataByKeyMap = dataByKeyMap;\r\n        array._dataByKeyMapLength = arrayLength\r\n    }\r\n}\r\n\r\nfunction getCacheValue(array, key) {\r\n    if (array._dataByKeyMap) {\r\n        return array._dataByKeyMap[JSON.stringify(key)]\r\n    }\r\n}\r\n\r\nfunction getHasKeyCacheValue(array, key) {\r\n    if (array._dataByKeyMap) {\r\n        return array._dataByKeyMap[JSON.stringify(key)]\r\n    }\r\n    return true\r\n}\r\n\r\nfunction setDataByKeyMapValue(array, key, data) {\r\n    if (array._dataByKeyMap) {\r\n        array._dataByKeyMap[JSON.stringify(key)] = data\r\n    }\r\n}\r\n\r\nfunction applyBatch(keyInfo, array, batchData, groupCount, useInsertIndex) {\r\n    batchData.forEach(function(item) {\r\n        var items = \"insert\" === item.type ? array : getItems(keyInfo, array, item.key, groupCount);\r\n        generateDataByKeyMap(keyInfo, items);\r\n        switch (item.type) {\r\n            case \"update\":\r\n                update(keyInfo, items, item.key, item.data, true);\r\n                break;\r\n            case \"insert\":\r\n                insert(keyInfo, items, item.data, useInsertIndex && (0, _type.isDefined)(item.index) ? item.index : -1, true);\r\n                break;\r\n            case \"remove\":\r\n                remove(keyInfo, items, item.key, true)\r\n        }\r\n    })\r\n}\r\n\r\nfunction update(keyInfo, array, key, data, isBatch) {\r\n    var target;\r\n    var extendComplexObject = true;\r\n    var keyExpr = keyInfo.key();\r\n    if (keyExpr) {\r\n        if (hasKey(data, keyExpr) && !(0, _utils.keysEqual)(key, keyInfo.keyOf(data))) {\r\n            return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4017\"))\r\n        }\r\n        target = getCacheValue(array, key);\r\n        if (!target) {\r\n            var index = indexByKey(keyInfo, array, key);\r\n            if (index < 0) {\r\n                return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4009\"))\r\n            }\r\n            target = array[index]\r\n        }\r\n    } else {\r\n        target = key\r\n    }\r\n    _object2.default.deepExtendArraySafe(target, data, extendComplexObject);\r\n    if (!isBatch) {\r\n        if ((0, _config2.default)().useLegacyStoreResult) {\r\n            return (0, _utils.trivialPromise)(key, data)\r\n        } else {\r\n            return (0, _utils.trivialPromise)(target, key)\r\n        }\r\n    }\r\n}\r\n\r\nfunction insert(keyInfo, array, data, index, isBatch) {\r\n    var keyValue;\r\n    var obj;\r\n    var keyExpr = keyInfo.key();\r\n    obj = (0, _type.isPlainObject)(data) ? (0, _extend.extend)({}, data) : data;\r\n    if (keyExpr) {\r\n        keyValue = keyInfo.keyOf(obj);\r\n        if (void 0 === keyValue || \"object\" === _typeof(keyValue) && (0, _type.isEmptyObject)(keyValue)) {\r\n            if (Array.isArray(keyExpr)) {\r\n                throw _errors.errors.Error(\"E4007\")\r\n            }\r\n            keyValue = obj[keyExpr] = String(new _guid2.default)\r\n        } else {\r\n            if (void 0 !== array[indexByKey(keyInfo, array, keyValue)]) {\r\n                return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4008\"))\r\n            }\r\n        }\r\n    } else {\r\n        keyValue = obj\r\n    }\r\n    if (index >= 0) {\r\n        array.splice(index, 0, obj)\r\n    } else {\r\n        array.push(obj)\r\n    }\r\n    setDataByKeyMapValue(array, keyValue, obj);\r\n    if (!isBatch) {\r\n        return (0, _utils.trivialPromise)((0, _config2.default)().useLegacyStoreResult ? data : obj, keyValue)\r\n    }\r\n}\r\n\r\nfunction remove(keyInfo, array, key, isBatch) {\r\n    var index = indexByKey(keyInfo, array, key);\r\n    if (index > -1) {\r\n        array.splice(index, 1)\r\n    }\r\n    if (!isBatch) {\r\n        return (0, _utils.trivialPromise)(key)\r\n    }\r\n}\r\n\r\nfunction indexByKey(keyInfo, array, key) {\r\n    if (!getHasKeyCacheValue(array, key)) {\r\n        return -1\r\n    }\r\n    for (var i = 0, arrayLength = array.length; i < arrayLength; i++) {\r\n        if ((0, _utils.keysEqual)(keyInfo.keyOf(array[i]), key)) {\r\n            return i\r\n        }\r\n    }\r\n    return -1\r\n}\r\nmodule.exports.applyBatch = applyBatch;\r\nmodule.exports.update = update;\r\nmodule.exports.insert = insert;\r\nmodule.exports.remove = remove;\r\nmodule.exports.indexByKey = indexByKey;\r\n"]},"metadata":{},"sourceType":"script"}