{"ast":null,"code":"/**\r\n * DevExtreme (core/utils/selection_filter.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar getKeyHash = require(\"./common\").getKeyHash;\n\nvar equalByValue = require(\"./common\").equalByValue;\n\nvar typeUtils = require(\"./type\");\n\nvar SelectionFilterCreator = function SelectionFilterCreator(selectedItemKeys, isSelectAll) {\n  this.getLocalFilter = function (keyGetter, equalKeys, equalByReference, keyExpr) {\n    equalKeys = void 0 === equalKeys ? equalByValue : equalKeys;\n    return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr);\n  };\n\n  this.getExpr = function (keyExpr) {\n    if (!keyExpr) {\n      return;\n    }\n\n    var filterExpr;\n    selectedItemKeys.forEach(function (key, index) {\n      filterExpr = filterExpr || [];\n      var filterExprPart;\n\n      if (index > 0) {\n        filterExpr.push(isSelectAll ? \"and\" : \"or\");\n      }\n\n      if (typeUtils.isString(keyExpr)) {\n        filterExprPart = getFilterForPlainKey(keyExpr, key);\n      } else {\n        filterExprPart = getFilterForCompositeKey(keyExpr, key);\n      }\n\n      filterExpr.push(filterExprPart);\n    });\n\n    if (filterExpr && 1 === filterExpr.length) {\n      filterExpr = filterExpr[0];\n    }\n\n    return filterExpr;\n  };\n\n  this.getCombinedFilter = function (keyExpr, dataSourceFilter) {\n    var filterExpr = this.getExpr(keyExpr);\n    var combinedFilter = filterExpr;\n\n    if (isSelectAll && dataSourceFilter) {\n      if (filterExpr) {\n        combinedFilter = [];\n        combinedFilter.push(filterExpr);\n        combinedFilter.push(dataSourceFilter);\n      } else {\n        combinedFilter = dataSourceFilter;\n      }\n    }\n\n    return combinedFilter;\n  };\n\n  var selectedItemKeyHashesMap;\n\n  var getSelectedItemKeyHashesMap = function getSelectedItemKeyHashesMap(selectedItemKeys) {\n    if (!selectedItemKeyHashesMap) {\n      selectedItemKeyHashesMap = {};\n\n      for (var i = 0; i < selectedItemKeys.length; i++) {\n        selectedItemKeyHashesMap[getKeyHash(selectedItemKeys[i])] = true;\n      }\n    }\n\n    return selectedItemKeyHashesMap;\n  };\n\n  var normalizeKeys = function normalizeKeys(keys, keyOf, keyExpr) {\n    return Array.isArray(keyExpr) ? keys.map(function (key) {\n      return keyOf(key);\n    }) : keys;\n  };\n\n  var functionFilter = function functionFilter(equalKeys, keyOf, equalByReference, keyExpr, item) {\n    var key = keyOf(item);\n    var keyHash;\n    var i;\n\n    if (!equalByReference) {\n      keyHash = getKeyHash(key);\n\n      if (!typeUtils.isObject(keyHash)) {\n        var selectedKeyHashesMap = getSelectedItemKeyHashesMap(normalizeKeys(selectedItemKeys, keyOf, keyExpr));\n\n        if (selectedKeyHashesMap[keyHash]) {\n          return !isSelectAll;\n        }\n\n        return !!isSelectAll;\n      }\n    }\n\n    for (i = 0; i < selectedItemKeys.length; i++) {\n      if (equalKeys(selectedItemKeys[i], key)) {\n        return !isSelectAll;\n      }\n    }\n\n    return !!isSelectAll;\n  };\n\n  var getFilterForPlainKey = function getFilterForPlainKey(keyExpr, keyValue) {\n    if (void 0 === keyValue) {\n      return;\n    }\n\n    return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue];\n  };\n\n  var getFilterForCompositeKey = function getFilterForCompositeKey(keyExpr, itemKeyValue) {\n    var filterExpr = [];\n\n    for (var i = 0, length = keyExpr.length; i < length; i++) {\n      var currentKeyExpr = keyExpr[i];\n      var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\n      var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\n\n      if (!filterExprPart) {\n        break;\n      }\n\n      if (i > 0) {\n        filterExpr.push(isSelectAll ? \"or\" : \"and\");\n      }\n\n      filterExpr.push(filterExprPart);\n    }\n\n    return filterExpr;\n  };\n};\n\nexports.SelectionFilterCreator = SelectionFilterCreator;","map":{"version":3,"sources":["C:/Users/va112/Documents/Webdev/React/Corona/node_modules/devextreme/core/utils/selection_filter.js"],"names":["getKeyHash","require","equalByValue","typeUtils","SelectionFilterCreator","selectedItemKeys","isSelectAll","getLocalFilter","keyGetter","equalKeys","equalByReference","keyExpr","functionFilter","bind","getExpr","filterExpr","forEach","key","index","filterExprPart","push","isString","getFilterForPlainKey","getFilterForCompositeKey","length","getCombinedFilter","dataSourceFilter","combinedFilter","selectedItemKeyHashesMap","getSelectedItemKeyHashesMap","i","normalizeKeys","keys","keyOf","Array","isArray","map","item","keyHash","isObject","selectedKeyHashesMap","keyValue","itemKeyValue","currentKeyExpr","currentKeyValue","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (core/utils/selection_filter.js)\r\n * Version: 19.2.7\r\n * Build date: Thu Mar 26 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar getKeyHash = require(\"./common\").getKeyHash;\r\nvar equalByValue = require(\"./common\").equalByValue;\r\nvar typeUtils = require(\"./type\");\r\nvar SelectionFilterCreator = function(selectedItemKeys, isSelectAll) {\r\n    this.getLocalFilter = function(keyGetter, equalKeys, equalByReference, keyExpr) {\r\n        equalKeys = void 0 === equalKeys ? equalByValue : equalKeys;\r\n        return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr)\r\n    };\r\n    this.getExpr = function(keyExpr) {\r\n        if (!keyExpr) {\r\n            return\r\n        }\r\n        var filterExpr;\r\n        selectedItemKeys.forEach(function(key, index) {\r\n            filterExpr = filterExpr || [];\r\n            var filterExprPart;\r\n            if (index > 0) {\r\n                filterExpr.push(isSelectAll ? \"and\" : \"or\")\r\n            }\r\n            if (typeUtils.isString(keyExpr)) {\r\n                filterExprPart = getFilterForPlainKey(keyExpr, key)\r\n            } else {\r\n                filterExprPart = getFilterForCompositeKey(keyExpr, key)\r\n            }\r\n            filterExpr.push(filterExprPart)\r\n        });\r\n        if (filterExpr && 1 === filterExpr.length) {\r\n            filterExpr = filterExpr[0]\r\n        }\r\n        return filterExpr\r\n    };\r\n    this.getCombinedFilter = function(keyExpr, dataSourceFilter) {\r\n        var filterExpr = this.getExpr(keyExpr);\r\n        var combinedFilter = filterExpr;\r\n        if (isSelectAll && dataSourceFilter) {\r\n            if (filterExpr) {\r\n                combinedFilter = [];\r\n                combinedFilter.push(filterExpr);\r\n                combinedFilter.push(dataSourceFilter)\r\n            } else {\r\n                combinedFilter = dataSourceFilter\r\n            }\r\n        }\r\n        return combinedFilter\r\n    };\r\n    var selectedItemKeyHashesMap;\r\n    var getSelectedItemKeyHashesMap = function(selectedItemKeys) {\r\n        if (!selectedItemKeyHashesMap) {\r\n            selectedItemKeyHashesMap = {};\r\n            for (var i = 0; i < selectedItemKeys.length; i++) {\r\n                selectedItemKeyHashesMap[getKeyHash(selectedItemKeys[i])] = true\r\n            }\r\n        }\r\n        return selectedItemKeyHashesMap\r\n    };\r\n    var normalizeKeys = function(keys, keyOf, keyExpr) {\r\n        return Array.isArray(keyExpr) ? keys.map(function(key) {\r\n            return keyOf(key)\r\n        }) : keys\r\n    };\r\n    var functionFilter = function(equalKeys, keyOf, equalByReference, keyExpr, item) {\r\n        var key = keyOf(item);\r\n        var keyHash;\r\n        var i;\r\n        if (!equalByReference) {\r\n            keyHash = getKeyHash(key);\r\n            if (!typeUtils.isObject(keyHash)) {\r\n                var selectedKeyHashesMap = getSelectedItemKeyHashesMap(normalizeKeys(selectedItemKeys, keyOf, keyExpr));\r\n                if (selectedKeyHashesMap[keyHash]) {\r\n                    return !isSelectAll\r\n                }\r\n                return !!isSelectAll\r\n            }\r\n        }\r\n        for (i = 0; i < selectedItemKeys.length; i++) {\r\n            if (equalKeys(selectedItemKeys[i], key)) {\r\n                return !isSelectAll\r\n            }\r\n        }\r\n        return !!isSelectAll\r\n    };\r\n    var getFilterForPlainKey = function(keyExpr, keyValue) {\r\n        if (void 0 === keyValue) {\r\n            return\r\n        }\r\n        return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue]\r\n    };\r\n    var getFilterForCompositeKey = function(keyExpr, itemKeyValue) {\r\n        var filterExpr = [];\r\n        for (var i = 0, length = keyExpr.length; i < length; i++) {\r\n            var currentKeyExpr = keyExpr[i];\r\n            var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\r\n            var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\r\n            if (!filterExprPart) {\r\n                break\r\n            }\r\n            if (i > 0) {\r\n                filterExpr.push(isSelectAll ? \"or\" : \"and\")\r\n            }\r\n            filterExpr.push(filterExprPart)\r\n        }\r\n        return filterExpr\r\n    }\r\n};\r\nexports.SelectionFilterCreator = SelectionFilterCreator;\r\n"]},"metadata":{},"sourceType":"script"}